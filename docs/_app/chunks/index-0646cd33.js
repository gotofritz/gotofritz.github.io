import{S as J_,i as z_,s as K_,e as t,t as i,k as u,c as e,a as p,d as s,h as c,m as k,b as r,Z as g,g as l,I as a,E as v2}from"./index-6e518972.js";var $_="/_app/assets/scripts-f3824c42.png",X_="/_app/assets/states-0b97f1cb.png",Z_="/_app/assets/stage-2d0e4f28.png",Q_="/_app/assets/opportunity-19bbdd25.png",nI="/_app/assets/pool-e2a1bffb.png",sI="/_app/assets/blank-slate-8ce157f3.png",aI="/_app/assets/menu-c4f7bc99.png",tI="/_app/assets/sidebar-d0117bff.png",eI="/_app/assets/select-row-bfbe8722.png",pI="/_app/assets/states-row-56adbf0f.png",oI="/_app/assets/rgb-colours-cb09e018.png",lI="/_app/assets/form-0f3aa912.mp4",iI="/_app/assets/load-from-cell-af09e135.mp4",cI="/_app/assets/add-comment-fc18a449.mp4";function rI(PS){let N,en,Ip,qd,zi,sn,Ap,Ud,Gd,ea,Vd,Wd,Ki,pa,Op,Yd,Jd,$i,pn,on,Pp,zd,Xi,At,Kd,Zi,ln,cn,Cp,$d,Qi,Ot,Xd,nc,rn,un,Dp,Zd,sc,kn,Qd,Pt,nf,sf,ac,dn,af,Rp,tf,ef,tc,h,Lp,pf,of,Mp,lf,cf,Hp,rf,uf,jp,kf,df,Fp,ff,hf,Bp,mf,yf,Np,wf,ec,fn,hn,qp,gf,pc,mn,yn,Up,vf,oc,q,bf,Gp,Ef,xf,oa,Sf,Tf,lc,wn,gn,Vp,_f,ic,Ct,If,cc,vn,Af,Dt,Of,Pf,rc,Rt,Cf,uc,bn,En,Wp,Df,kc,U,Rf,Yp,Lf,Mf,Jp,Hf,jf,dc,xn,Ff,zp,Bf,Nf,fc,Sn,Tn,Kp,qf,hc,Lt,Uf,mc,_n,In,$p,Gf,yc,Mt,Vf,wc,An,On,Xp,Wf,gc,Ht,la,Yf,vc,Pn,Cn,Zp,Jf,bc,jt,zf,Ec,Dn,Rn,Qp,Kf,xc,Ft,Bt,b2,Sc,Nt,$f,Tc,y,no,Xf,v,Zf,so,Qf,nh,ao,sh,ah,to,th,eh,eo,ph,oh,qt,E2,po,lh,Ln,ih,oo,ch,rh,lo,uh,io,kh,ia,dh,co,fh,hh,ro,mh,uo,yh,ko,wh,fo,gh,_c,Mn,Hn,ho,vh,Ic,jn,Fn,mo,bh,Ac,Ut,Eh,Oc,Bn,x,xh,yo,Sh,Th,wo,_h,Ih,go,Ah,Oh,vo,Ph,Ch,Dh,bo,Rh,Pc,f,Lh,Eo,Mh,Hh,xo,jh,Fh,So,Bh,Nh,To,qh,Uh,_o,Gh,Vh,Io,Wh,Yh,Ao,Jh,zh,Cc,Gt,Kh,Dc,Vt,$h,Rc,Nn,qn,Oo,Xh,Lc,Wt,Yt,x2,Mc,Jt,Zh,Hc,Un,Gn,Po,Qh,jc,zt,Kt,S2,Fc,$t,nm,Bc,Xt,sm,Nc,G,Co,am,tm,Do,em,pm,Ro,om,qc,Vn,Wn,Lo,lm,Uc,Zt,Qt,T2,Gc,ne,im,Vc,se,cm,Wc,ae,rm,Yc,S,Mo,um,km,Ho,dm,fm,jo,hm,mm,Fo,ym,Jc,Yn,Jn,Bo,wm,zc,te,ee,_2,Kc,pe,gm,$c,oe,vm,Xc,T,No,bm,Em,qo,xm,Sm,Uo,Tm,_m,Go,Im,Zc,zn,Kn,Vo,Am,Qc,le,Om,nr,b,ca,Pm,Wo,Cm,Dm,Rm,Yo,Lm,Mm,Jo,Hm,jm,zo,Fm,Bm,Ko,Nm,sr,ie,qm,ar,_,$o,Um,Gm,Xo,Vm,Wm,Zo,Ym,Jm,Qo,zm,tr,$n,Xn,nl,Km,er,ce,$m,pr,re,ue,I2,or,Zn,Qn,sl,Xm,lr,ke,D,Zm,al,Qm,ny,tl,sy,ay,el,ty,ey,ir,ra,CS=`<code class="language-js"><span class="token comment">//const.gs</span>
<span class="token keyword">const</span> <span class="token constant">SS</span> <span class="token operator">=</span> SpreadsheetApp<span class="token punctuation">.</span><span class="token function">getActiveSpreadsheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> noop <span class="token operator">=</span> <span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span></code>`,cr,an,pl,py,oy,ol,ly,iy,rr,ua,DS=`<code class="language-js"><span class="token comment">// Code.js</span>
<span class="token keyword">function</span> <span class="token function">onOpen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  SpreadsheetApp<span class="token punctuation">.</span><span class="token function">getActiveSpreadsheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setSpreadsheetTimeZone</span><span class="token punctuation">(</span><span class="token string">"Europe/Berlin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> menuEntries <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  menuEntries<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
    <span class="token punctuation">&#123;</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"APP"</span><span class="token punctuation">,</span> <span class="token literal-property property">functionName</span><span class="token operator">:</span> <span class="token string">"noop"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"POOL"</span><span class="token punctuation">,</span> <span class="token literal-property property">functionName</span><span class="token operator">:</span> <span class="token string">"noop"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"OPPORTUNITY"</span><span class="token punctuation">,</span> <span class="token literal-property property">functionName</span><span class="token operator">:</span> <span class="token string">"noop"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"STAGE"</span><span class="token punctuation">,</span> <span class="token literal-property property">functionName</span><span class="token operator">:</span> <span class="token string">"noop"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"STATES"</span><span class="token punctuation">,</span> <span class="token literal-property property">functionName</span><span class="token operator">:</span> <span class="token string">"noop"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token keyword">null</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token constant">SS</span><span class="token punctuation">.</span><span class="token function">addMenu</span><span class="token punctuation">(</span><span class="token string">"CRM 4.0"</span><span class="token punctuation">,</span> menuEntries<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code>`,ur,de,fe,A2,kr,ns,ss,ll,cy,dr,he,ry,fr,ka,RS=`<code class="language-diff">// main.gs
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   ...
</span><span class="token prefix unchanged"> </span><span class="token line">   &#123; name: "POOL", functionName: "noop" &#125;,
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   &#123; name: "> New opportunity", functionName: "createOpportunity" &#125;,
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   null,
</span><span class="token prefix unchanged"> </span><span class="token line">   &#123; name: "OPPORTUNITY", functionName: "noop" &#125;,
</span><span class="token prefix unchanged"> </span><span class="token line">   ...</span></span></code>`,hr,me,uy,mr,ye,ky,yr,da,LS=`<code class="language-js"><span class="token comment">// main.gs</span>
<span class="token keyword">function</span> <span class="token function">createOpportunity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> pool <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Pool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  pool<span class="token punctuation">.</span><span class="token function">createOpportunity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  pool<span class="token punctuation">.</span><span class="token function">updateUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code>`,wr,we,dy,gr,fa,MS=`<code class="language-js"><span class="token comment">// pool.gs</span>
<span class="token keyword">class</span> <span class="token class-name">Pool</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span> sh <span class="token operator">=</span> <span class="token constant">SS</span><span class="token punctuation">.</span><span class="token function">getActiveSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>sh <span class="token operator">=</span> sh<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>opportunities <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadStateFromSheet_</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">loadStateFromSheet_</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>

  <span class="token function">updateUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>

  <span class="token function">createOpportunity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>opportunities<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Opportunity</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">sh</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sh <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code>`,vr,ge,fy,br,ha,HS=`<code class="language-js"><span class="token comment">// opportunity.gs</span>
<span class="token keyword">class</span> <span class="token class-name">Opportunity</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span> sh <span class="token operator">=</span> <span class="token constant">SS</span><span class="token punctuation">.</span><span class="token function">getActiveSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> row <span class="token operator">=</span> <span class="token constant">DATA_ROW_START</span> <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>sh <span class="token operator">=</span> sh<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>row <span class="token operator">=</span> row<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>stages <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadStateFromSheet_</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">sh</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sh<span class="token punctuation">,</span> <span class="token literal-property property">row</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>row <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">loadStateFromSheet_</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>

  <span class="token function">updateUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code>`,Er,V,hy,il,my,yy,cl,wy,gy,xr,ve,vy,Sr,ma,jS=`<code class="language-diff">//globals.gs
const SS = SpreadsheetApp.getActiveSpreadsheet();
const noop = Function.prototype;

<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> const DATA_ROW_START = 2;
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line"> const DATA_COL_META1 = 1;
</span><span class="token prefix inserted">+</span><span class="token line"> const DATA_COL_META2 = 2;</span></span></code>`,Tr,as,by,rl,Ey,xy,_r,ya,FS=`<code class="language-diff">// pool.js
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> updateUI() &#123;
</span><span class="token prefix unchanged"> </span><span class="token line">   // make sure the Opportunities know where they are
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   this.reindex_();
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   // make room for the new Opportunities
</span><span class="token prefix unchanged"> </span><span class="token line">   this.sh.insertRowsBefore(DATA_ROW_START, this.opportunities.length);
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   // tell the Opportunities to render themselves
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   for (let opportunity of this.opportunities) &#123;
</span><span class="token prefix inserted">+</span><span class="token line">     opportunity.updateUI();
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &#125;
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   // remove the old Opportunities from the UI
</span><span class="token prefix unchanged"> </span><span class="token line">   const startRow = DATA_ROW_START + this.opportunities.length;
</span><span class="token prefix unchanged"> </span><span class="token line">   const nRows = this.sh.getMaxRows() - DATA_ROW_START + this.opportunities.length - 1;
</span><span class="token prefix unchanged"> </span><span class="token line">   this.sh.deleteRows(startRow, nRows)
</span><span class="token prefix unchanged"> </span><span class="token line"> &#125;
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> reindex_(sh = SS.getActiveSheet()) &#123;
</span><span class="token prefix inserted">+</span><span class="token line">   for (let i = 0; i &lt; this.opportunities.length; i += 1) &#123;
</span><span class="token prefix inserted">+</span><span class="token line">     this.opportunities[i].reset(&#123; sh: sh, row: i &#125;);
</span><span class="token prefix inserted">+</span><span class="token line">   &#125;
</span><span class="token prefix inserted">+</span><span class="token line"> &#125;</span></span></code>`,Ir,ts,Sy,ul,Ty,_y,Ar,wa,BS=`<code class="language-diff">// opportunity.gs
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> updateUI() &#123;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   const startRow = this.row;
</span><span class="token prefix inserted">+</span><span class="token line">   const startCol = DATA_COL_META1;
</span><span class="token prefix inserted">+</span><span class="token line">   const nRows = 1;
</span><span class="token prefix inserted">+</span><span class="token line">   const nCols = 2;
</span><span class="token prefix inserted">+</span><span class="token line">   this.sh.getRange(startRow, startCol, nRows, nCols).setValues([
</span><span class="token prefix inserted">+</span><span class="token line">     ['NEW DATA', Math.random()]
</span><span class="token prefix inserted">+</span><span class="token line">   ]);
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &#125;
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> reset(&#123;
</span><span class="token prefix inserted">+</span><span class="token line">   sh = die('reset needs a sheet argument'),
</span><span class="token prefix inserted">+</span><span class="token line">   row = die('reset needs a row argument') &#125; = &#123;&#125;
</span><span class="token prefix inserted">+</span><span class="token line"> ) &#123;
</span><span class="token prefix inserted">+</span><span class="token line">   this.sh = sh;
</span><span class="token prefix inserted">+</span><span class="token line">   this.row = row;
</span><span class="token prefix inserted">+</span><span class="token line"> &#125;</span></span></code>`,Or,ga,Iy,va,Ay,Pr,ba,NS=`<code class="language-js"><span class="token comment">// genericGotofritzUtils.gs</span>
<span class="token keyword">function</span> <span class="token function">die</span><span class="token punctuation">(</span><span class="token parameter">prompt</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">throw</span> <span class="token function">Error</span><span class="token punctuation">(</span>prompt<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code>`,Cr,es,ps,kl,Oy,Dr,be,R,O2,Rr,os,Py,dl,Cy,Dy,Lr,Ee,xe,P2,Mr,W,Ry,Ea,Ly,My,xa,Hy,jy,Hr,Sa,qS=`<code class="language-html">// createOpportunityForm.html

<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>base</span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>_top<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span>
      function prefill() &#123;
        const now = new Date();
        const yyyy = now.getFullYear();
        const mm = String(now.getMonth() + 1).padStart(2, "0");
        const dd = String(now.getDate() + 1).padStart(2, "0");
        document.getElementById("yyyy").value = yyyy;
        document.getElementById("mm").value = mm;
        document.getElementById("dd").value = dd;
        // ------ placeholders for testing
        document.getElementById("company").value = "Beatles";
        document.getElementById("position").value = "drummer";
        document.getElementById("source").value = "Melody Maker";
        document.getElementById("contact").value = "Brian Epstein";
        document.getElementById("comments").value =
          "The old drummer was too simple minded&#92;nAlso ugly";
      &#125;

      function handleFormSubmit(formObj) &#123;
        google.script.run
          .withFailureHandler(onFailure)
          .withSuccessHandler(onSuccess)
          .handleCreateOpportunity(formObj);
        return false;
      &#125;

      function onFailure(err) &#123;
        document.getElementById("err").innerHTML = &#96;ERROR: $&#123;err&#125;&#96;;
      &#125;

      function onSuccess() &#123;
        google.script.host.close();
      &#125;
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span>
      label &#123;
        display: block;
      &#125;
      div &#123;
        margin-bottom: 1rem;
      &#125;
      input[type="text"]:not([size]),
      textarea &#123;
        width: 100%;
      &#125;
      .err &#123;
        display: block;
        background-color: red;
        color: white;
        padding: 4px;
      &#125;
      .err:empty &#123;
        display: none;
      &#125;
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">onload</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>prefill()<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>err<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>err<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">onsubmit</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleFormSubmit(this)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>date<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>date<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>OK<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>company<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Company<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>company<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>company<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>required<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>position<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Position<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>position<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>position<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>required<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>date<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Date<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
          <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span>
          <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>yyyy<span class="token punctuation">"</span></span>
          <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>yyyy<span class="token punctuation">"</span></span>
          <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>yyyy<span class="token punctuation">"</span></span>
          <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>4<span class="token punctuation">"</span></span>
          <span class="token attr-name">maxlength</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>4<span class="token punctuation">"</span></span>
        <span class="token punctuation">/></span></span>-
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
          <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span>
          <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mm<span class="token punctuation">"</span></span>
          <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mm<span class="token punctuation">"</span></span>
          <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mm<span class="token punctuation">"</span></span>
          <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span>
          <span class="token attr-name">maxlength</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span>
          <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span>
        <span class="token punctuation">/></span></span>-
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
          <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span>
          <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dd<span class="token punctuation">"</span></span>
          <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dd<span class="token punctuation">"</span></span>
          <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dd<span class="token punctuation">"</span></span>
          <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span>
          <span class="token attr-name">maxlength</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span>
        <span class="token punctuation">/></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>source<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Source (Linkedin, Email, etc)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>source<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>source<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>contact<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Main Contact<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>contact<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>contact<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>comments<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>More info (&#92;n separated, no need for '-')<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>comments<span class="token punctuation">"</span></span> <span class="token attr-name">rows</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>6<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>comments<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>OK<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code>`,jr,I,Fy,fl,By,Ny,hl,qy,Uy,ml,Gy,Vy,Fr,tn,yl,Wy,Yy,wl,Jy,zy,Br,Ta,US=`<code class="language-diff"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> function handleFormSubmit(formObj) &#123;
</span><span class="token prefix inserted">+</span><span class="token line">   document.getElementById("date").value = [
</span><span class="token prefix inserted">+</span><span class="token line">     document.getElementById("yyyy").value,
</span><span class="token prefix inserted">+</span><span class="token line">     document.getElementById("mm").value,
</span><span class="token prefix inserted">+</span><span class="token line">     document.getElementById("dd").value
</span><span class="token prefix inserted">+</span><span class="token line">   ].join('-')
</span><span class="token prefix inserted">+</span><span class="token line">   google.script.run
</span><span class="token prefix inserted">+</span><span class="token line">     .withFailureHandler(onFailure)
</span><span class="token prefix inserted">+</span><span class="token line">     .withSuccessHandler(onSuccess)
</span><span class="token prefix inserted">+</span><span class="token line">     .handleCreateOpportunity(formObj);
</span><span class="token prefix inserted">+</span><span class="token line">   return false;
</span><span class="token prefix inserted">+</span><span class="token line"> &#125;
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> function onFailure(err) &#123;
</span><span class="token prefix inserted">+</span><span class="token line">   // shows the error message at the top of the sidebar
</span><span class="token prefix inserted">+</span><span class="token line">   document.getElementById("err").innerHTML = &#96;ERROR: $&#123;err&#125;&#96;;
</span><span class="token prefix inserted">+</span><span class="token line"> &#125;
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> function onSuccess() &#123;
</span><span class="token prefix inserted">+</span><span class="token line">   // closes the sidebar
</span><span class="token prefix inserted">+</span><span class="token line">   google.script.host.close();
</span><span class="token prefix inserted">+</span><span class="token line"> &#125;</span></span></code>`,Nr,Se,Ky,qr,_a,GS=`<code class="language-diff">// main.gs
function createOpportunity() &#123;
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> const pool = new Pool();
</span><span class="token prefix deleted">-</span><span class="token line"> pool.createOpportunity();
</span><span class="token prefix deleted">-</span><span class="token line"> pool.updateUI();
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> const html = HtmlService
</span><span class="token prefix inserted">+</span><span class="token line">     .createHtmlOutputFromFile('createOpportunityForm')
</span><span class="token prefix inserted">+</span><span class="token line">     .setTitle('New Opportunity...');
</span><span class="token prefix inserted">+</span><span class="token line"> SpreadsheetApp.getUi().showSidebar(html);
</span></span>&#125;</code>`,Ur,Y,$y,gl,Xy,Zy,vl,Qy,nw,Gr,Ia,VS=`<code class="language-js"><span class="token comment">// formHandlers.gs</span>
<span class="token keyword">function</span> <span class="token function">handleCreateOpportunity</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> pool <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Pool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  pool<span class="token punctuation">.</span><span class="token function">createOpportunity</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  pool<span class="token punctuation">.</span><span class="token function">updateUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code>`,Vr,Aa,WS=`<code class="language-diff">// Pool.gs
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> createOpportunity(data) &#123;
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">   this.opportunities.unshift(new Opportunity(&#123; sh: this.sh &#125;));
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   const newOpportunity = new Opportunity(&#123; sh: this.sh, metadata: data &#125;);
</span><span class="token prefix inserted">+</span><span class="token line">   this.opportunities.unshift(
</span><span class="token prefix inserted">+</span><span class="token line">     newOpportunity
</span><span class="token prefix inserted">+</span><span class="token line">   );
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &#125;</span></span></code>`,Wr,ls,sw,bl,aw,tw,Yr,is,ew,Oa,pw,ow,Jr,Te,lw,zr,Pa,YS=`<code class="language-js"><span class="token comment">// StructToUIBridge.gs</span>

<span class="token keyword">class</span> <span class="token class-name">Field</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
    name <span class="token operator">=</span> <span class="token function">die</span><span class="token punctuation">(</span><span class="token string">"A field without a name makes no sense"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    separator <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span>
    defaultValue <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span>
    value <span class="token operator">=</span> defaultValue<span class="token punctuation">,</span>
    style <span class="token operator">=</span> normal<span class="token punctuation">,</span>
    <span class="token comment">// TODO: we could pass a validation function here</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>separator <span class="token operator">=</span> separator<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>style <span class="token operator">=</span> style<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>defaultValue <span class="token operator">=</span> defaultValue<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// globals.js</span>
<span class="token keyword">const</span> normal <span class="token operator">=</span> SpreadsheetApp<span class="token punctuation">.</span><span class="token function">newTextStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setBold</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setItalic</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setFontSize</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code>`,Kr,J,iw,El,cw,rw,xl,uw,kw,$r,Ca,JS=`<code class="language-js"><span class="token keyword">class</span> <span class="token class-name">StructToUIBridge</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span>
    fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    colBg <span class="token operator">=</span> <span class="token constant">COL_BG_DEFAULT</span><span class="token punctuation">,</span>
    colFg <span class="token operator">=</span> <span class="token constant">COL_FG_DEFAULT</span><span class="token punctuation">,</span>
    vAlign <span class="token operator">=</span> <span class="token constant">DEFAULT_VALIGN</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>fields <span class="token operator">=</span> fields<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">rawField</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">new</span> <span class="token class-name">Field</span><span class="token punctuation">(</span>rawField<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>colBg <span class="token operator">=</span> colBg<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>colFg <span class="token operator">=</span> colFg<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>vAlign <span class="token operator">=</span> vAlign<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">updateAllValues</span><span class="token punctuation">(</span><span class="token parameter">fieldsData <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> field <span class="token keyword">of</span> <span class="token keyword">this</span><span class="token punctuation">.</span>fields<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> name<span class="token punctuation">,</span> defaultValue <span class="token punctuation">&#125;</span> <span class="token operator">=</span> field<span class="token punctuation">;</span>
      field<span class="token punctuation">.</span>value <span class="token operator">=</span> name <span class="token keyword">in</span> fieldsData <span class="token operator">?</span> fieldsData<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">:</span> defaultValue<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">updateSomeValues</span><span class="token punctuation">(</span><span class="token parameter">fieldsData <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> field <span class="token keyword">of</span> <span class="token keyword">this</span><span class="token punctuation">.</span>fields<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> name <span class="token punctuation">&#125;</span> <span class="token operator">=</span> field<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token keyword">in</span> fieldsData<span class="token punctuation">)</span> field<span class="token punctuation">.</span>value <span class="token operator">=</span> fieldsData<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">asPlainText</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>fields<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span>
      <span class="token punctuation">(</span><span class="token parameter">accumulator<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> value<span class="token punctuation">,</span> separator <span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> accumulator <span class="token operator">+</span> value <span class="token operator">+</span> separator<span class="token punctuation">,</span>
      <span class="token string">""</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">updateCell</span><span class="token punctuation">(</span><span class="token parameter">cell</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code>`,Xr,cs,dw,Sl,fw,hw,Zr,Da,zS=`<code class="language-diff"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> updateCell(cell) &#123;
</span><span class="token prefix inserted">+</span><span class="token line">   // get the whole text as one long string
</span><span class="token prefix inserted">+</span><span class="token line">   let wholeText = this.asPlainText();
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   // create a RichText builder
</span><span class="token prefix inserted">+</span><span class="token line">   let richTextContent = SpreadsheetApp.newRichTextValue().setText(wholeText);
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   // add markers at start end end of each field
</span><span class="token prefix inserted">+</span><span class="token line">   let startOffset = 0;
</span><span class="token prefix inserted">+</span><span class="token line">   for (let field of this.fields) &#123;
</span><span class="token prefix inserted">+</span><span class="token line">     const &#123; value, style, separator &#125; = field;
</span><span class="token prefix inserted">+</span><span class="token line">     let endOffset = Math.min(
</span><span class="token prefix inserted">+</span><span class="token line">       wholeText.length,
</span><span class="token prefix inserted">+</span><span class="token line">       startOffset + value.length + separator.length,
</span><span class="token prefix inserted">+</span><span class="token line">     );
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     // sometimes we get weird combinations which are hard to debug
</span><span class="token prefix inserted">+</span><span class="token line">     if (startOffset !== endOffset) &#123;
</span><span class="token prefix inserted">+</span><span class="token line">       richTextContent.setTextStyle(startOffset, endOffset, style);
</span><span class="token prefix inserted">+</span><span class="token line">     &#125;
</span><span class="token prefix inserted">+</span><span class="token line">     startOffset = endOffset;
</span><span class="token prefix inserted">+</span><span class="token line">   &#125;
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   cell
</span><span class="token prefix inserted">+</span><span class="token line">     .setRichTextValue(richTextContent.build())
</span><span class="token prefix inserted">+</span><span class="token line">     .setVerticalAlignment(this.vAlign)
</span><span class="token prefix inserted">+</span><span class="token line">     .setBackground(this.colBg)
</span><span class="token prefix inserted">+</span><span class="token line">     .setFontColor(this.colFg)
</span><span class="token prefix inserted">+</span><span class="token line">     .setWrapStrategy(SpreadsheetApp.WrapStrategy.WRAP);
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   return this;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">&#125;</span></span></code>`,Qr,A,mw,Tl,yw,ww,_l,gw,vw,Il,bw,Ew,nu,Ra,KS=`<code class="language-diff">// Opportunity.gs

class Opportunity &#123;
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> constructor(&#123;
</span><span class="token prefix unchanged"> </span><span class="token line">   sh = SS.getActiveSheet(),
</span><span class="token prefix unchanged"> </span><span class="token line">   row=DATA_ROW_START,
</span><span class="token prefix unchanged"> </span><span class="token line">   metadata=&#123;&#125;
</span><span class="token prefix unchanged"> </span><span class="token line"> &#125; = &#123;&#125;) &#123;
</span><span class="token prefix unchanged"> </span><span class="token line">   this.sh = sh;
</span><span class="token prefix unchanged"> </span><span class="token line">   this.row = row;
</span><span class="token prefix unchanged"> </span><span class="token line">   this.stages = [];
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   this.metadata1 = new StructToUIBridge(&#123;
</span><span class="token prefix inserted">+</span><span class="token line">     fields: [
</span><span class="token prefix inserted">+</span><span class="token line">       &#123; name: "company", separator: " / ", defaultValue: "????", style: bold &#125;,
</span><span class="token prefix inserted">+</span><span class="token line">       &#123; name: "position", separator: "&#92;n&#92;n", defaultValue: "[TBC]", style: bold &#125;,
</span><span class="token prefix inserted">+</span><span class="token line">       &#123; name: "comments", style: smaller &#125;,
</span><span class="token prefix inserted">+</span><span class="token line">     ],
</span><span class="token prefix inserted">+</span><span class="token line">     colBg: COL_BG_META,
</span><span class="token prefix inserted">+</span><span class="token line">     colFg: COL_FG_META
</span><span class="token prefix inserted">+</span><span class="token line">   &#125;);
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   this.metadata2 = new StructToUIBridge(&#123;
</span><span class="token prefix inserted">+</span><span class="token line">     fields: [
</span><span class="token prefix inserted">+</span><span class="token line">       &#123; name: "date", separator: "&#92;n&#92;n", defaultValue: asString(new Date()), style: bold &#125;,
</span><span class="token prefix inserted">+</span><span class="token line">       &#123; name: "source", separator: "&#92;n", defaultValue: "LINKEDIN", style: bold &#125;,
</span><span class="token prefix inserted">+</span><span class="token line">       &#123; name: "contact", defaultValue: '???', style: normal &#125;,
</span><span class="token prefix inserted">+</span><span class="token line">     ],
</span><span class="token prefix inserted">+</span><span class="token line">     colBg: COL_BG_META,
</span><span class="token prefix inserted">+</span><span class="token line">     colFg: COL_FG_META
</span><span class="token prefix inserted">+</span><span class="token line">   &#125;);
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   this.loadStateFromSheet_();
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   if (metadata) &#123;
</span><span class="token prefix inserted">+</span><span class="token line">     this.updateMetadata_(metadata);
</span><span class="token prefix inserted">+</span><span class="token line">   &#125;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &#125;</span></span></code>`,su,O,xw,Al,Sw,Tw,Ol,_w,Iw,Pl,Aw,Ow,au,La,$S=`<code class="language-diff">// globals.gs
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> const bold = SpreadsheetApp.newTextStyle().setBold(true).build();
</span><span class="token prefix inserted">+</span><span class="token line"> const italic = SpreadsheetApp.newTextStyle().setItalic(true).build();
</span><span class="token prefix inserted">+</span><span class="token line"> const smaller = SpreadsheetApp.newTextStyle()
</span><span class="token prefix inserted">+</span><span class="token line">   .setBold(false)
</span><span class="token prefix inserted">+</span><span class="token line">   .setFontSize(9)
</span><span class="token prefix inserted">+</span><span class="token line">   .build();</span></span></code>`,tu,_e,Pw,eu,Ma,XS=`<code class="language-diff">// Opportunity.gs

<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> updateMetadata_(metadata) &#123;
</span><span class="token prefix inserted">+</span><span class="token line">   if (!metadata) return;
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   this.validateMetadata_(metadata);
</span><span class="token prefix inserted">+</span><span class="token line">   this.metadata1.updateAllValues(metadata);
</span><span class="token prefix inserted">+</span><span class="token line">   this.metadata2.updateAllValues(metadata);
</span><span class="token prefix inserted">+</span><span class="token line"> &#125;
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> validateMetadata_(metadata) &#123;
</span><span class="token prefix inserted">+</span><span class="token line">   validDate(metadata.date, 'Date');
</span><span class="token prefix inserted">+</span><span class="token line"> &#125;
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> updateUI() &#123;
</span><span class="token prefix unchanged"> </span><span class="token line">   const startRow = this.row;
</span><span class="token prefix unchanged"> </span><span class="token line">   const startCol = DATA_COL_META1;
</span></span>
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">   const nRows = 1;
</span><span class="token prefix deleted">-</span><span class="token line">   const nCols = 2;
</span><span class="token prefix deleted">-</span><span class="token line">   this.sh.getRange(startRow, startCol, nRows, nCols).setValues([
</span><span class="token prefix deleted">-</span><span class="token line">     ['NEW DATA', Math.random()]
</span><span class="token prefix deleted">-</span><span class="token line">   ]);
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   let metadataCell = this.sh.getRange(startRow, startCol);
</span><span class="token prefix inserted">+</span><span class="token line">   this.metadata1.updateCell(metadataCell);
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   metadataCell = this.sh.getRange(startRow, startCol + 1)
</span><span class="token prefix inserted">+</span><span class="token line">   this.metadata2.updateCell(metadataCell);
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &#125;</span></span></code>`,pu,Ha,Cl,Cw,Dw,ou,ja,ZS=`<code class="language-js"><span class="token comment">/**
 * @param &#123;string|date|number&#125; maybeDate the date we are testing
 * @param &#123;string&#125; name the name of the field, for the error meage
 * @throws if date is not valid
 * @return &#123;string|date&#125;
 */</span>
<span class="token keyword">function</span> <span class="token function">validDate</span><span class="token punctuation">(</span><span class="token parameter">maybeDate<span class="token punctuation">,</span> name</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> maybeDateUnderTest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>maybeDate<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isNaN</span><span class="token punctuation">(</span>maybeDateUnderTest<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">throw</span> <span class="token function">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>name<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string"> should be a valid date, but is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>maybeDate<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> maybeDate<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code>`,lu,rs,us,Dl,Rw,iu,ks,Lw,Rl,Mw,Hw,cu,Fa,QS=`<code class="language-js"><span class="token comment">//Opportunity.gs</span>
  <span class="token function">loadStateFromSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>metadata1<span class="token punctuation">.</span><span class="token function">loadDataFromCell</span><span class="token punctuation">(</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>sh<span class="token punctuation">.</span><span class="token function">getRange</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>row<span class="token punctuation">,</span> <span class="token constant">DATA_COL_META1</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>metadata2<span class="token punctuation">.</span><span class="token function">loadDataFromCell</span><span class="token punctuation">(</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>sh<span class="token punctuation">.</span><span class="token function">getRange</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>row<span class="token punctuation">,</span> <span class="token constant">DATA_COL_META2</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span></code>`,ru,Ie,jw,uu,Ae,Fw,ku,Ba,nT=`<code class="language-diff">// StructToUIBridge.gs
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &#125;) &#123;
</span><span class="token prefix unchanged"> </span><span class="token line">   this.fields = fields.map((rawField) => new Field(rawField));
</span><span class="token prefix unchanged"> </span><span class="token line">   // forcing a separator - except on the last field
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   this.fields.slice(0, -1).forEach(field => &#123;
</span><span class="token prefix inserted">+</span><span class="token line">     if (!field.separator) throw Error("Error: fields must have a separator")
</span><span class="token prefix inserted">+</span><span class="token line">   &#125;);
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   this.colBg = colBg;</span></span></code>`,du,P,Bw,Ll,Nw,qw,Ml,Uw,Gw,Hl,Vw,Ww,fu,Na,sT=`<code class="language-js"><span class="token comment">// StructToUIBridge.gs</span>
  <span class="token function">generateParsingRegexp_</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> parser <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>fields<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span>
        <span class="token comment">// accumulator -> the string so far</span>
        <span class="token comment">// &#123;separator&#125; -> the Field we are dealing with now,</span>
        <span class="token comment">//                but only take the separator property</span>
        <span class="token comment">// i -> the current index, to see whether it's the last</span>
        <span class="token comment">// arr -> the whole array, so that we can compare the length to i</span>
        <span class="token punctuation">(</span><span class="token parameter">accumulator<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>separator<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> arr</span><span class="token punctuation">)</span> <span class="token operator">=></span>
          i <span class="token operator">===</span> arr<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span>
            <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>accumulator<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">(.*)</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>separator<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">&#96;</span></span>
            <span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>accumulator<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">(.*?)</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>separator<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">,</span>
        <span class="token string">"^"</span>
      <span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"$"</span><span class="token punctuation">,</span>
      <span class="token string">"sm"</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> parser<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span></code>`,hu,ds,Yw,jl,Jw,zw,mu,qa,aT=`<code class="language-js">  <span class="token function">loadDataFromCell</span><span class="token punctuation">(</span>cell <span class="token operator">=</span> <span class="token function">die</span><span class="token punctuation">(</span><span class="token string">"loadDataFromCell called without a cell"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> dataToParse <span class="token operator">=</span> cell<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// GAS always tries to be helpful and convert strings to something else \u{1F644}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>dataToParse <span class="token keyword">instanceof</span> <span class="token class-name">Date</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      dataToParse <span class="token operator">=</span> <span class="token function">asString</span><span class="token punctuation">(</span>dataToParse<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">const</span> matches <span class="token operator">=</span> dataToParse<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>parser<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>matches<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>fields<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> j <span class="token operator">&lt;</span> matches<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>fields<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>value <span class="token operator">=</span> matches<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span></code>`,yu,Oe,Kw,wu,Pe,L,C2,gu,fs,hs,Fl,$w,vu,C,Xw,Bl,Zw,Qw,Nl,ng,sg,ql,ag,tg,bu,ms,ys,Ul,eg,Eu,ws,pg,Gl,og,lg,xu,gs,ig,Vl,cg,rg,Su,Ua,tT=`<code class="language-diff">// main.gs
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   ...
</span><span class="token prefix unchanged"> </span><span class="token line">   &#123; name: "POOL", functionName: "noop" &#125;,
</span><span class="token prefix unchanged"> </span><span class="token line">   &#123; name: "> New opportunity", functionName: "createOpportunity" &#125;,
</span><span class="token prefix unchanged"> </span><span class="token line">   null,
</span><span class="token prefix unchanged"> </span><span class="token line">   &#123; name: "OPPORTUNITY", functionName: "noop" &#125;,
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   &#123; name: "> Edit opportunity", functionName: "editOpportunity" &#125;,
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   ...
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> function editOpportunity() &#123;
</span><span class="token prefix inserted">+</span><span class="token line">   const html = HtmlService
</span><span class="token prefix inserted">+</span><span class="token line">       .createHtmlOutputFromFile('createOpportunityForm')
</span><span class="token prefix inserted">+</span><span class="token line">       .setTitle('New Opportunity...');
</span><span class="token prefix inserted">+</span><span class="token line">   SpreadsheetApp.getUi().showSidebar(html);
</span><span class="token prefix inserted">+</span><span class="token line"> &#125;</span></span></code>`,Tu,z,ug,Wl,kg,dg,Yl,fg,hg,_u,Ga,eT=`<code class="language-js"><span class="token comment">// genericGotofritzUtils.gs</span>
<span class="token keyword">function</span> <span class="token function">indexOfSelectedRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// hardcoding SS - because the ActiveRange can only be in the ActiveSheet</span>
  <span class="token keyword">return</span> <span class="token constant">SS</span><span class="token punctuation">.</span><span class="token function">getSelection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getActiveRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">dieUnlessSelection</span><span class="token punctuation">(</span>msg <span class="token operator">=</span> <span class="token string">"You need to select a cell"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token constant">SS</span><span class="token punctuation">.</span><span class="token function">getSelection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">msgAndDie</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">msgAndDie</span><span class="token punctuation">(</span><span class="token parameter">prompt</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  Browser<span class="token punctuation">.</span><span class="token function">msgBox</span><span class="token punctuation">(</span>prompt<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">throw</span> <span class="token function">Error</span><span class="token punctuation">(</span>prompt<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code>`,Iu,Ce,mg,Au,Va,pT=`<code class="language-diff">// globals.gs
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> const HTML_ID_EXTRA_FORM_DATA = 'fromSheet';
</span></span>
// main.gs

function editOpportunity() &#123;
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  dieUnlessSelection();
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  const opportunityRow = indexOfSelectedRow();
</span><span class="token prefix inserted">+</span><span class="token line">  const htmlFragment = &#96;
</span><span class="token prefix inserted">+</span><span class="token line">    &lt;div style="display: block; background: pink" id="$&#123;HTML_ID_EXTRA_FORM_DATA&#125;">
</span><span class="token prefix inserted">+</span><span class="token line">   &#123; "selectedRow": $&#123;opportunityRow&#125; &#125;
</span><span class="token prefix inserted">+</span><span class="token line">   &lt;/div>
</span><span class="token prefix inserted">+</span><span class="token line">   &#96;;
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const html = HtmlService
</span><span class="token prefix unchanged"> </span><span class="token line">     .createHtmlOutputFromFile('createOpportunityForm')
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">     .setTitle('New Opportunity...');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     .setTitle('Edit Opportunity...')
</span><span class="token prefix inserted">+</span><span class="token line">     .append(htmlFragment)
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> SpreadsheetApp.getUi().showSidebar(html);
</span></span>&#125;</code>`,Ou,De,yg,Pu,Re,Le,D2,Cu,Me,wg,Du,Wa,oT=`<code class="language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> function prefill() &#123;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   const htmlId = "fromSheet";
</span><span class="token prefix inserted">+</span><span class="token line">   initData = JSON.parse(document.getElementById(htmlId)?.innerHTML || "&#123;&#125;");
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    // NOTE: in the form you can debug with &#96;debugger&#96; and console.logs
</span><span class="token prefix inserted">+</span><span class="token line">   console.log('------ initData ------')
</span><span class="token prefix inserted">+</span><span class="token line">   console.table(initData)
</span></span></code>`,Ru,He,gg,Lu,Ya,lT=`<code class="language-js"><span class="token comment">// genericGotofritzUtils.gs</span>
<span class="token keyword">function</span> <span class="token function">asHTMLfragment</span><span class="token punctuation">(</span><span class="token parameter">jsonData <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> htmlId <span class="token operator">=</span> <span class="token constant">HTML_ID_EXTRA_FORM_DATA</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">
    &lt;div style="display: block; background: pink" id="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>htmlId<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">">
      </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>jsonData<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">
    &lt;/div>
  </span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code>`,Mu,vs,vg,Jl,bg,Eg,Hu,Ja,iT=`<code class="language-js"><span class="token comment">// StructToUIBridge/gs</span>
<span class="token keyword">class</span> <span class="token class-name">StructToUIBridge</span> <span class="token punctuation">&#123;</span>
  <span class="token operator">...</span>

  <span class="token function">asJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> jsonRepresentation <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">&#123;</span>name<span class="token punctuation">,</span> value<span class="token punctuation">&#125;</span> <span class="token keyword">of</span> <span class="token keyword">this</span><span class="token punctuation">.</span>fields<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      jsonRepresentation<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> jsonRepresentation<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>


<span class="token comment">// Opportunity.gs</span>
<span class="token keyword">class</span> <span class="token class-name">Opportunity</span> <span class="token punctuation">&#123;</span>
  <span class="token operator">...</span>

  <span class="token function">asJson</span><span class="token punctuation">(</span><span class="token parameter">additionalData<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>
      <span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>metadata1<span class="token punctuation">.</span><span class="token function">asJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>metadata2<span class="token punctuation">.</span><span class="token function">asJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token operator">...</span>additionalData
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token operator">...</span></code>`,ju,je,xg,Fu,za,cT=`<code class="language-js"><span class="token comment">// Pool.gs</span>
<span class="token keyword">class</span> <span class="token class-name">Pool</span> <span class="token punctuation">&#123;</span>
  <span class="token operator">...</span>

  <span class="token keyword">static</span> <span class="token function">asOpportunityIndex</span><span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token function">die</span><span class="token punctuation">(</span><span class="token string">"No row passed"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> row <span class="token operator">-</span> <span class="token constant">DATA_ROW_START</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token keyword">static</span> <span class="token function">asRowIndex</span><span class="token punctuation">(</span>opportunityIndex<span class="token operator">=</span><span class="token function">die</span><span class="token punctuation">(</span><span class="token string">"No opportunityIndex passed"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> opportunityIndex <span class="token operator">+</span> <span class="token constant">DATA_ROW_START</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span></code>`,Bu,Ka,rT=`<code class="language-diff">function editOpportunity() &#123;
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> dieUnlessSelection();
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const opportunityRow = indexOfSelectedRow();
</span><span class="token prefix unchanged"> </span><span class="token line"> if (opportunityRow &lt; DATA_ROW_START) &#123;
</span><span class="token prefix unchanged"> </span><span class="token line">   msgAndDie('You need to select one of the opportunities, not there');
</span><span class="token prefix unchanged"> </span><span class="token line"> &#125;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> const opportunityIndex = Pool.asOpportunityIndex(opportunityRow);
</span><span class="token prefix inserted">+</span><span class="token line"> const pool = new Pool();
</span><span class="token prefix inserted">+</span><span class="token line"> const opportunityToEdit = pool.opportunities[opportunityIndex];
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> const htmlFragment = &#96;
</span><span class="token prefix deleted">-</span><span class="token line">   &lt;div style="display: block; background: pink" id="$&#123;HTML_ID_EXTRA_FORM_DATA&#125;">
</span><span class="token prefix deleted">-</span><span class="token line">  &#123; "selectedRow": $&#123;opportunityRow&#125; &#125;
</span><span class="token prefix deleted">-</span><span class="token line">  &lt;/div>
</span><span class="token prefix deleted">-</span><span class="token line">  &#96;;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  const htmlFragment = asHTMLfragment(
</span><span class="token prefix inserted">+</span><span class="token line">   opportunityToEdit.asJson(&#123;
</span><span class="token prefix inserted">+</span><span class="token line">     id: opportunityIndex
</span><span class="token prefix inserted">+</span><span class="token line">   &#125;)
</span><span class="token prefix inserted">+</span><span class="token line"> );
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const html = HtmlService
</span><span class="token prefix unchanged"> </span><span class="token line">     .createHtmlOutputFromFile('createOpportunityForm')
</span><span class="token prefix unchanged"> </span><span class="token line"> ...</span></span></code>`,Nu,Fe,Sg,qu,$a,uT=`<code class="language-diff">// createOpportunityForm.html

<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> function prefill() &#123;
</span><span class="token prefix unchanged"> </span><span class="token line">   const htmlId = "fromSheet";
</span><span class="token prefix unchanged"> </span><span class="token line">  initData = JSON.parse(document.getElementById(htmlId)?.innerHTML || "&#123;&#125;");
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   const idEl = document.getElementById("id");
</span><span class="token prefix inserted">+</span><span class="token line">   if ('id' in initData) &#123;
</span><span class="token prefix inserted">+</span><span class="token line">     idEl.value = initData.row;
</span><span class="token prefix inserted">+</span><span class="token line">   &#125; else &#123;
</span><span class="token prefix inserted">+</span><span class="token line">     idEl.parentNode.removeChild(idEl)
</span><span class="token prefix inserted">+</span><span class="token line">   &#125;
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    // this could be slicker... but no much benefit
</span><span class="token prefix inserted">+</span><span class="token line">   document.getElementById("yyyy").value = initData.yyyy ?? "";
</span><span class="token prefix inserted">+</span><span class="token line">   document.getElementById("mm").value = initData.mm ?? "";
</span><span class="token prefix inserted">+</span><span class="token line">   document.getElementById("dd").value = initData.dd ?? "";
</span><span class="token prefix inserted">+</span><span class="token line">   document.getElementById("company").value = initData.company ?? "";
</span><span class="token prefix inserted">+</span><span class="token line">   document.getElementById("position").value = initData.position ?? "";
</span><span class="token prefix inserted">+</span><span class="token line">   document.getElementById("source").value = initData.source ?? "";
</span><span class="token prefix inserted">+</span><span class="token line">   document.getElementById("contact").value = initData.contact ?? "";
</span><span class="token prefix inserted">+</span><span class="token line">   document.getElementById("comments").value = initData.comments ?? "";
</span></span>...

<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;form onsubmit="handleFormSubmit(this)">
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     &lt;input type="hidden" name="id" id="id" />
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     &lt;input type="hidden" name="date" id="date" /></span></span></code>`,Uu,Be,Tg,Gu,Xa,kT=`<code class="language-diff">// formHandlers.gs
function handleCreateOpportunity(data) &#123;
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const pool = new Pool();
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> if (data.id) &#123;
</span><span class="token prefix inserted">+</span><span class="token line">   pool.updateOpportunity(data, data.id);
</span><span class="token prefix inserted">+</span><span class="token line"> &#125; else &#123;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   pool.createOpportunity(data);
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> &#125;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> pool.updateUI();
</span></span>&#125;</code>`,Vu,Ne,_g,Wu,Za,dT=`<code class="language-js">  <span class="token function">updateOpportunity</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> id<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>id <span class="token keyword">in</span> <span class="token keyword">this</span><span class="token punctuation">.</span>opportunities<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token function">msgAndDie</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">There isn't an opportunity </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>id<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>opportunities<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Opportunity</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
      <span class="token literal-property property">sh</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sh<span class="token punctuation">,</span>
      <span class="token literal-property property">metadata</span><span class="token operator">:</span> data<span class="token punctuation">,</span>
      <span class="token literal-property property">row</span><span class="token operator">:</span> Pool<span class="token punctuation">.</span><span class="token function">asRowIndex</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span></code>`,Yu,bs,Es,zl,Ig,Ju,K,Ag,Kl,Og,Pg,$l,Cg,Dg,zu,Qa,fT=`<code class="language-js"><span class="token comment">// main.gs</span>
  <span class="token operator">...</span>
  <span class="token punctuation">&#123;</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"POOL"</span><span class="token punctuation">,</span> <span class="token literal-property property">functionName</span><span class="token operator">:</span> <span class="token string">"noop"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#123;</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"> New opportunity"</span><span class="token punctuation">,</span> <span class="token literal-property property">functionName</span><span class="token operator">:</span> <span class="token string">"createOpportunity"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token keyword">null</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#123;</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"OPPORTUNITY"</span><span class="token punctuation">,</span> <span class="token literal-property property">functionName</span><span class="token operator">:</span> <span class="token string">"noop"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#123;</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"> Edit Opportunity"</span><span class="token punctuation">,</span> <span class="token literal-property property">functionName</span><span class="token operator">:</span> <span class="token string">"editOpportunity"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#123;</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"> Delete Opportunity"</span><span class="token punctuation">,</span> <span class="token literal-property property">functionName</span><span class="token operator">:</span> <span class="token string">"deleteOpportunity"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token keyword">null</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#123;</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"STAGE"</span><span class="token punctuation">,</span> <span class="token literal-property property">functionName</span><span class="token operator">:</span> <span class="token string">"noop"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>

<span class="token keyword">function</span> <span class="token function">deleteOpportunity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token function">dieUnlessSelection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> opportunityRow <span class="token operator">=</span> <span class="token function">indexOfSelectedRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>opportunityRow <span class="token operator">&lt;</span> <span class="token constant">DATA_ROW_START</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">msgAndDie</span><span class="token punctuation">(</span><span class="token string">'You need to select one of the opportunities, not there'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token keyword">const</span> ui <span class="token operator">=</span> SpreadsheetApp<span class="token punctuation">.</span><span class="token function">getUi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  response <span class="token operator">=</span> ui<span class="token punctuation">.</span><span class="token function">alert</span><span class="token punctuation">(</span>
    <span class="token string">'Are you sure you want to delete this opportunity?'</span><span class="token punctuation">,</span>
    ui<span class="token punctuation">.</span>ButtonSet<span class="token punctuation">.</span><span class="token constant">OK_CANCEL</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>response <span class="token operator">===</span> ui<span class="token punctuation">.</span>Button<span class="token punctuation">.</span><span class="token constant">OK</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> pool <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Pool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> opportunityIndex <span class="token operator">=</span> Pool<span class="token punctuation">.</span><span class="token function">asOpportunityIndex</span><span class="token punctuation">(</span>opportunityRow<span class="token punctuation">)</span><span class="token punctuation">;</span>
    pool<span class="token punctuation">.</span><span class="token function">deleteOpportunity</span><span class="token punctuation">(</span>opportunityIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
    pool<span class="token punctuation">.</span><span class="token function">updateUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code>`,Ku,nt,Xl,Rg,Lg,$u,st,hT=`<code class="language-js"><span class="token comment">// Pool.gs</span>
  <span class="token function">deleteOpportunity</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>id <span class="token keyword">in</span> <span class="token keyword">this</span><span class="token punctuation">.</span>opportunities<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token function">msgAndDie</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">There isn't an opportunity </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>id<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>opportunities<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span></code>`,Xu,xs,Ss,Zl,Mg,Zu,Ts,Hg,Ql,jg,Fg,Qu,qe,Bg,nk,_s,at,ni,Ng,qg,si,Ug,Gg,tt,ai,Ue,mT=`<code class="language-diff">class Opportunity &#123;
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> constructor(&#123;
</span><span class="token prefix unchanged"> </span><span class="token line">   sh = SS.getActiveSheet(),
</span><span class="token prefix unchanged"> </span><span class="token line">   row=DATA_ROW_START,
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   metadata
</span><span class="token prefix unchanged"> </span><span class="token line"> &#125; = &#123;&#125;) &#123;
</span><span class="token prefix unchanged"> </span><span class="token line">   this.sh = sh;
</span><span class="token prefix unchanged"> </span><span class="token line">   this.row = row;
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   this.stages = [];
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   this.metadata1 = new StructToUIBridge(&#123;
</span><span class="token prefix unchanged"> </span><span class="token line">     fields: [
</span><span class="token prefix unchanged"> </span><span class="token line">       &#123;
</span><span class="token prefix unchanged"> </span><span class="token line">         name: "company",
</span><span class="token prefix unchanged"> </span><span class="token line">         separator: " / ",
</span><span class="token prefix unchanged"> </span><span class="token line">         defaultValue: "????",
</span><span class="token prefix unchanged"> </span><span class="token line">         style: bold
</span><span class="token prefix unchanged"> </span><span class="token line">       &#125;,
</span><span class="token prefix unchanged"> </span><span class="token line">       &#123;
</span><span class="token prefix unchanged"> </span><span class="token line">         name: "position",
</span><span class="token prefix unchanged"> </span><span class="token line">         separator: "&#92;n&#92;n",
</span><span class="token prefix unchanged"> </span><span class="token line">         defaultValue: "[TBC]",
</span><span class="token prefix unchanged"> </span><span class="token line">         style: bold
</span><span class="token prefix unchanged"> </span><span class="token line">       &#125;,
</span><span class="token prefix unchanged"> </span><span class="token line">       &#123;
</span><span class="token prefix unchanged"> </span><span class="token line">         name: "comments",
</span><span class="token prefix unchanged"> </span><span class="token line">         style: smaller
</span><span class="token prefix unchanged"> </span><span class="token line">       &#125;,
</span><span class="token prefix unchanged"> </span><span class="token line">     ],
</span><span class="token prefix unchanged"> </span><span class="token line">     colBg: COL_BG_META,
</span><span class="token prefix unchanged"> </span><span class="token line">     colFg: COL_FG_META
</span><span class="token prefix unchanged"> </span><span class="token line">   &#125;);
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   this.metadata2 = new StructToUIBridge(&#123;
</span><span class="token prefix unchanged"> </span><span class="token line">     fields: [
</span><span class="token prefix unchanged"> </span><span class="token line">       &#123;
</span><span class="token prefix unchanged"> </span><span class="token line">         name: "date",
</span><span class="token prefix unchanged"> </span><span class="token line">         separator: "&#92;n&#92;n",
</span><span class="token prefix unchanged"> </span><span class="token line">         defaultValue: asString(new Date()),
</span><span class="token prefix unchanged"> </span><span class="token line">         style: bold
</span><span class="token prefix unchanged"> </span><span class="token line">       &#125;,
</span><span class="token prefix unchanged"> </span><span class="token line">       &#123;
</span><span class="token prefix unchanged"> </span><span class="token line">         name: "source",
</span><span class="token prefix unchanged"> </span><span class="token line">         separator: "&#92;n",
</span><span class="token prefix unchanged"> </span><span class="token line">         defaultValue: "LINKEDIN",
</span><span class="token prefix unchanged"> </span><span class="token line">         style: bold
</span><span class="token prefix unchanged"> </span><span class="token line">       &#125;,
</span><span class="token prefix unchanged"> </span><span class="token line">       &#123;
</span><span class="token prefix unchanged"> </span><span class="token line">         name: "contact",
</span><span class="token prefix unchanged"> </span><span class="token line">         defaultValue: '???',
</span><span class="token prefix unchanged"> </span><span class="token line">         style: normal
</span><span class="token prefix unchanged"> </span><span class="token line">       &#125;,
</span><span class="token prefix unchanged"> </span><span class="token line">     ],
</span><span class="token prefix unchanged"> </span><span class="token line">     colBg: COL_BG_META,
</span><span class="token prefix unchanged"> </span><span class="token line">     colFg: COL_FG_META
</span><span class="token prefix unchanged"> </span><span class="token line">   &#125;);
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   this.loadStateFromSheet();
</span><span class="token prefix unchanged"> </span><span class="token line">   if (metadata) &#123;
</span><span class="token prefix unchanged"> </span><span class="token line">     this.updateMetadata_(metadata);
</span><span class="token prefix unchanged"> </span><span class="token line">   &#125;
</span><span class="token prefix unchanged"> </span><span class="token line"> &#125;
</span></span>...</code>`,Vg,ti,Ge,yT=`<code class="language-diff">class Step &#123;
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> constructor(&#123;
</span><span class="token prefix unchanged"> </span><span class="token line">   sh = SS.getActiveSheet(),
</span><span class="token prefix unchanged"> </span><span class="token line">   row,
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   col = DATA_COL_LATEST,
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   metadata
</span><span class="token prefix unchanged"> </span><span class="token line"> &#125; = &#123;&#125;) &#123;
</span><span class="token prefix unchanged"> </span><span class="token line">   this.sh = sh;
</span><span class="token prefix unchanged"> </span><span class="token line">   this.row = row;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   this.col = col;
</span></span>

<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   this.data = new StructToUIBridge(&#123;
</span><span class="token prefix unchanged"> </span><span class="token line">     fields: [
</span><span class="token prefix unchanged"> </span><span class="token line">       &#123;
</span><span class="token prefix unchanged"> </span><span class="token line">         name: "date", separator: " __ ",
</span><span class="token prefix unchanged"> </span><span class="token line">         defaultValue: asString(new Date()),
</span><span class="token prefix unchanged"> </span><span class="token line">         style: bold
</span><span class="token prefix unchanged"> </span><span class="token line">       &#125;,
</span><span class="token prefix unchanged"> </span><span class="token line">       &#123;
</span><span class="token prefix unchanged"> </span><span class="token line">         name: "time",
</span><span class="token prefix unchanged"> </span><span class="token line">         separator: "&#92;n&#92;n",
</span><span class="token prefix unchanged"> </span><span class="token line">         defaultValue: '',
</span><span class="token prefix unchanged"> </span><span class="token line">         style: bold
</span><span class="token prefix unchanged"> </span><span class="token line">       &#125;,
</span><span class="token prefix unchanged"> </span><span class="token line">       &#123;
</span><span class="token prefix unchanged"> </span><span class="token line">         name: "title",
</span><span class="token prefix unchanged"> </span><span class="token line">         separator: "&#92;n",
</span><span class="token prefix unchanged"> </span><span class="token line">         defaultValue: "INTERVIEW",
</span><span class="token prefix unchanged"> </span><span class="token line">         style: bold &#125;,
</span><span class="token prefix unchanged"> </span><span class="token line">       &#123;
</span><span class="token prefix unchanged"> </span><span class="token line">         name: "contact",
</span><span class="token prefix unchanged"> </span><span class="token line">         separator: "&#92;n&#92;n",
</span><span class="token prefix unchanged"> </span><span class="token line">         defaultValue: '???',
</span><span class="token prefix unchanged"> </span><span class="token line">         style: normal
</span><span class="token prefix unchanged"> </span><span class="token line">       &#125;,
</span><span class="token prefix unchanged"> </span><span class="token line">       &#123;
</span><span class="token prefix unchanged"> </span><span class="token line">         name: "comments",
</span><span class="token prefix unchanged"> </span><span class="token line">         style: smaller
</span><span class="token prefix unchanged"> </span><span class="token line">       &#125;,
</span><span class="token prefix unchanged"> </span><span class="token line">     ],
</span><span class="token prefix unchanged"> </span><span class="token line">     colBg: '#00ffff',
</span><span class="token prefix unchanged"> </span><span class="token line">     colFg: COL_FG_META
</span><span class="token prefix unchanged"> </span><span class="token line">   &#125;);
</span></span>














<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   this.loadStateFromSheet();
</span><span class="token prefix unchanged"> </span><span class="token line">   if (metadata) &#123;
</span><span class="token prefix unchanged"> </span><span class="token line">     this.updateMetadata_(metadata);
</span><span class="token prefix unchanged"> </span><span class="token line">   &#125;
</span><span class="token prefix unchanged"> </span><span class="token line"> &#125;
</span></span>...</code>`,sk,Ve,Wg,ak,et,wT=`<code class="language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> ...
</span><span class="token prefix unchanged"> </span><span class="token line"> &#123; name: "POOL", functionName: "noop" &#125;,
</span><span class="token prefix unchanged"> </span><span class="token line"> &#123; name: "> New opportunity", functionName: "createOpportunity" &#125;,
</span><span class="token prefix unchanged"> </span><span class="token line"> null,
</span><span class="token prefix unchanged"> </span><span class="token line"> &#123; name: "OPPORTUNITY", functionName: "noop" &#125;,
</span><span class="token prefix unchanged"> </span><span class="token line"> &#123; name: "> Edit Opportunity", functionName: "editOpportunity" &#125;,
</span><span class="token prefix unchanged"> </span><span class="token line"> &#123; name: "> Delete Opportunity", functionName: "deleteOpportunity" &#125;,
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> &#123; name: "> New Step", functionName: "createStep" &#125;,
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> null,
</span><span class="token prefix unchanged"> </span><span class="token line"> &#123; name: "STAGE", functionName: "noop" &#125;,
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> &#123; name: "> Edit Step", functionName: "editStep" &#125;,
</span><span class="token prefix inserted">+</span><span class="token line"> &#123; name: "> Delete Step", functionName: "deleteStep" &#125;,
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> ...</span></span></code>`,tk,Is,As,ei,Yg,ek,We,Jg,pk,M,zg,pi,Kg,$g,oi,Xg,Zg,li,Qg,ok,pt,gT=`<code class="language-diff">// StructToUIBridge.gs
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> constructor(&#123;
</span><span class="token prefix unchanged"> </span><span class="token line">   ...
</span><span class="token prefix unchanged"> </span><span class="token line"> this.fields = fields.map((rawField) => new Field(rawField));
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> this.fieldNames = this.fields.reduce(
</span><span class="token prefix inserted">+</span><span class="token line">   (accumulator, &#123;name&#125;, i) => &#123;
</span><span class="token prefix inserted">+</span><span class="token line">     accumulator[name] = i;
</span><span class="token prefix inserted">+</span><span class="token line">     return accumulator;
</span><span class="token prefix inserted">+</span><span class="token line">   &#125;,
</span><span class="token prefix inserted">+</span><span class="token line">   &#123;&#125;
</span><span class="token prefix inserted">+</span><span class="token line"> )
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> this.fields.slice(0, -1).forEach(field => &#123;
</span><span class="token prefix unchanged"> </span><span class="token line">   ...</span></span></code>`,lk,Ye,n1,ik,ot,vT=`<code class="language-js"><span class="token comment">// StructToUIBridge.gs</span>
  <span class="token function">getFieldValue</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token keyword">in</span> <span class="token keyword">this</span><span class="token punctuation">.</span>fieldNames<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>fields<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>fieldNames<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span></code>`,ck,Je,s1,rk,lt,bT=`<code class="language-html">...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span>
  function prefill() &#123;
    const htmlId = "fromSheet";

    initData = JSON.parse(document.getElementById(htmlId)?.innerHTML || "&#123;&#125;");
    if (!("id" in initData)) &#123;
      throw Error("Missing 'id' property");
    &#125;

    const rowEl = document.getElementById("row");
    if ("row" in initData) &#123;
      rowEl.value = initData.row;
    &#125; else &#123;
      rowEl.parentNode.removeChild(rowEl);
    &#125;
    document.getElementById("id").value = initData.id;
    document.getElementById("comments").value = initData.comments ?? "";
  &#125;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">onsubmit</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleFormSubmit(this)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>b<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>OK<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>row<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>row<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>comments<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>More info (free form for comments)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>comments<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>comments<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code>`,uk,Os,a1,ii,t1,e1,kk,it,ET=`<code class="language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &#123; name: "> Delete Opportunity", functionName: "deleteOpportunity" &#125;,
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   &#123; name: "> Edit Opportunity Comments", functionName: "editCommentsOpportunity" &#125;,
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &#123; name: "> New Step", functionName: "createStep" &#125;,
</span><span class="token prefix unchanged"> </span><span class="token line">   null,
</span><span class="token prefix unchanged"> </span><span class="token line">   &#123; name: "STAGE", functionName: "noop" &#125;,
</span><span class="token prefix unchanged"> </span><span class="token line">   &#123; name: "> Edit Step", functionName: "editStep" &#125;,
</span><span class="token prefix unchanged"> </span><span class="token line">   &#123; name: "> Delete Step", functionName: "deleteStep" &#125;,
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   &#123; name: "> Edit Step Comments", functionName: "editCommentsStep" &#125;,</span></span></code>`,dk,ze,p1,fk,Ps,ct,ci,o1,l1,ri,i1,c1,rt,ui,Ke,xT=`<code class="language-diff">function editCommentsOpportunity() &#123;
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> dieUnlessSelection();
</span><span class="token prefix unchanged"> </span><span class="token line"> const opportunityRow = indexOfSelectedRow();
</span><span class="token prefix unchanged"> </span><span class="token line"> if (opportunityRow &lt; DATA_ROW_START) &#123;
</span><span class="token prefix unchanged"> </span><span class="token line">   msgAndDie('You need to select one of ' +
</span><span class="token prefix unchanged"> </span><span class="token line">     'the opportunities, not there');
</span><span class="token prefix unchanged"> </span><span class="token line"> &#125;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> const opportunityIndex = Pool
</span><span class="token prefix inserted">+</span><span class="token line">   .asOpportunityIndex(opportunityRow);
</span></span>








<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const pool = new Pool();
</span></span>

<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const opportunityToEdit = pool.opportunities[
</span><span class="token prefix unchanged"> </span><span class="token line">   opportunityIndex
</span><span class="token prefix unchanged"> </span><span class="token line"> ];
</span><span class="token prefix unchanged"> </span><span class="token line"> const htmlFragment = asHTMLfragment(&#123;
</span><span class="token prefix unchanged"> </span><span class="token line">   id: opportunityIndex,
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   comments: opportunityToEdit.getFieldValue(
</span><span class="token prefix unchanged"> </span><span class="token line">     'comments'
</span><span class="token prefix unchanged"> </span><span class="token line">   )
</span><span class="token prefix unchanged"> </span><span class="token line"> &#125;);
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const html = HtmlService
</span><span class="token prefix unchanged"> </span><span class="token line">     .createHtmlOutputFromFile(
</span><span class="token prefix unchanged"> </span><span class="token line">       'editCommentForm'
</span><span class="token prefix unchanged"> </span><span class="token line">     )
</span><span class="token prefix unchanged"> </span><span class="token line">     .append(htmlFragment)
</span><span class="token prefix unchanged"> </span><span class="token line">     .setWidth(DIALOG_WIDTH)
</span><span class="token prefix unchanged"> </span><span class="token line">     .setHeight(DIALOG_HEIGHT);
</span><span class="token prefix unchanged"> </span><span class="token line"> SpreadsheetApp
</span><span class="token prefix unchanged"> </span><span class="token line">   .getUi()
</span><span class="token prefix unchanged"> </span><span class="token line">   .showModalDialog(
</span><span class="token prefix unchanged"> </span><span class="token line">     html,
</span><span class="token prefix unchanged"> </span><span class="token line">     'Edit Comment...'
</span><span class="token prefix unchanged"> </span><span class="token line">   );
</span></span>&#125;</code>`,r1,ki,$e,ST=`<code class="language-diff">function editCommentsStep() &#123;
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> dieUnlessSelection();
</span><span class="token prefix unchanged"> </span><span class="token line"> const opportunityRow = indexOfSelectedRow();
</span><span class="token prefix unchanged"> </span><span class="token line"> if (opportunityRow &lt; DATA_ROW_START) &#123;
</span><span class="token prefix unchanged"> </span><span class="token line">   msgAndDie('You need to select one of ' +
</span><span class="token prefix unchanged"> </span><span class="token line">     'the opportunities, not there');
</span><span class="token prefix unchanged"> </span><span class="token line"> &#125;
</span></span>


<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> const stageCol = indexOfSelectedCol();
</span><span class="token prefix inserted">+</span><span class="token line"> if (cellIsEmpty(opportunityRow, stageCol)) &#123;
</span><span class="token prefix inserted">+</span><span class="token line">   msgAndDie('Nothing to edit');
</span><span class="token prefix inserted">+</span><span class="token line"> &#125;
</span><span class="token prefix inserted">+</span><span class="token line"> const stageIndex = Opportunity.asStepIndex(
</span><span class="token prefix inserted">+</span><span class="token line">   stageCol
</span><span class="token prefix inserted">+</span><span class="token line"> );
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const opportunity = new Opportunity(
</span><span class="token prefix unchanged"> </span><span class="token line">   &#123; row: opportunityRow &#125;
</span><span class="token prefix unchanged"> </span><span class="token line"> );
</span><span class="token prefix unchanged"> </span><span class="token line"> const stageToEdit = opportunity.stages[
</span><span class="token prefix unchanged"> </span><span class="token line">   stageIndex
</span><span class="token prefix unchanged"> </span><span class="token line"> ];
</span><span class="token prefix unchanged"> </span><span class="token line"> const htmlFragment = asHTMLfragment(&#123;
</span><span class="token prefix unchanged"> </span><span class="token line">   id: stageIndex,
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   row: opportunityRow,
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   comments: stageToEdit.getFieldValue(
</span><span class="token prefix unchanged"> </span><span class="token line">     'comments'
</span><span class="token prefix unchanged"> </span><span class="token line">   )
</span><span class="token prefix unchanged"> </span><span class="token line"> &#125;);
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const html = HtmlService
</span><span class="token prefix unchanged"> </span><span class="token line">     .createHtmlOutputFromFile(
</span><span class="token prefix unchanged"> </span><span class="token line">       'editCommentForm'
</span><span class="token prefix unchanged"> </span><span class="token line">     )
</span><span class="token prefix unchanged"> </span><span class="token line">     .append(htmlFragment)
</span><span class="token prefix unchanged"> </span><span class="token line">     .setWidth(DIALOG_WIDTH)
</span><span class="token prefix unchanged"> </span><span class="token line">     .setHeight(DIALOG_HEIGHT);
</span><span class="token prefix unchanged"> </span><span class="token line"> SpreadsheetApp
</span><span class="token prefix unchanged"> </span><span class="token line">   .getUi()
</span><span class="token prefix unchanged"> </span><span class="token line">   .showModalDialog(
</span><span class="token prefix unchanged"> </span><span class="token line">     html,
</span><span class="token prefix unchanged"> </span><span class="token line">     'Edit Comment...'
</span><span class="token prefix unchanged"> </span><span class="token line">   );
</span></span>&#125;
</code>`,hk,$,u1,di,k1,d1,fi,f1,h1,mk,ut,TT=`<code class="language-js"><span class="token comment">// Step.gs</span>
  <span class="token function">getFieldValue</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">getFieldValue</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span></code>`,yk,kt,m1,hi,y1,wk,dt,_T=`<code class="language-js"><span class="token keyword">const</span> html <span class="token operator">=</span> HtmlService<span class="token punctuation">.</span><span class="token function">createHtmlOutputFromFile</span><span class="token punctuation">(</span><span class="token string">"editCommentForm"</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>htmlFragment<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setWidth</span><span class="token punctuation">(</span><span class="token constant">DIALOG_WIDTH</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setHeight</span><span class="token punctuation">(</span><span class="token constant">DIALOG_HEIGHT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
SpreadsheetApp<span class="token punctuation">.</span><span class="token function">getUi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showModalDialog</span><span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token string">"Edit Comment..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code>`,gk,Xe,w1,vk,ft,IT=`<code class="language-js"><span class="token comment">// formHandlers.gs</span>
<span class="token keyword">function</span> <span class="token function">handleEditComment</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>data<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> weAreEditingAStep <span class="token operator">=</span> <span class="token string">"row"</span> <span class="token keyword">in</span> data<span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>weAreEditingAStep<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> opportunity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Opportunity</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">row</span><span class="token operator">:</span> data<span class="token punctuation">.</span>row <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    opportunity<span class="token punctuation">.</span><span class="token function">updateFieldInStep</span><span class="token punctuation">(</span>
      <span class="token punctuation">&#123;</span> <span class="token literal-property property">comments</span><span class="token operator">:</span> data<span class="token punctuation">.</span>comments <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token comment">// in this case the id represents the Step, i.e. a col</span>
      data<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    opportunity<span class="token punctuation">.</span><span class="token function">updateUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> pool <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Pool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pool<span class="token punctuation">.</span><span class="token function">updateFieldsInOpportunity</span><span class="token punctuation">(</span>
      <span class="token punctuation">&#123;</span> <span class="token literal-property property">comments</span><span class="token operator">:</span> data<span class="token punctuation">.</span>comments <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token comment">// in this case the id represents the Opp., i.e. a row</span>
      data<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    pool<span class="token punctuation">.</span><span class="token function">updateUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code>`,bk,H,mi,g1,v1,yi,b1,E1,wi,x1,S1,Ek,ht,AT=`<code class="language-js"><span class="token comment">//Pool.gs</span>
  <span class="token function">updateFieldsInOpportunity</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> id<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>id <span class="token keyword">in</span> <span class="token keyword">this</span><span class="token punctuation">.</span>opportunities<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token function">msgAndDie</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">There isn't an opportunity </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>id<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>opportunities<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">updateFields</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span></code>`,xk,Ze,T1,Sk,Qe,j,R2,Tk,Cs,Ds,gi,_1,_k,np,I1,Ik,Rs,Ls,vi,A1,Ak,sp,O1,Ok,ap,P1,Pk,Ms,C1,bi,D1,R1,Ck,Hs,js,Ei,L1,Dk,tp,ep,L2,Rk,Fs,M1,xi,H1,j1,Lk,mt,OT=`<code class="language-js"><span class="token comment">// State.gs</span>
<span class="token keyword">class</span> <span class="token class-name">State</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span> order<span class="token punctuation">,</span> bg<span class="token punctuation">,</span> fg<span class="token punctuation">,</span> name<span class="token punctuation">,</span> group <span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>order <span class="token operator">=</span> order<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>bg <span class="token operator">=</span> bg<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>fg <span class="token operator">=</span> fg<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>group <span class="token operator">=</span> group<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code>`,Mk,Bs,F1,Si,B1,N1,Hk,yt,PT=`<code class="language-js"><span class="token comment">// State.gs</span>
<span class="token keyword">class</span> <span class="token class-name">StatesMgr</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">loadStates</span><span class="token punctuation">(</span><span class="token parameter">range</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> max <span class="token operator">=</span> range<span class="token punctuation">.</span><span class="token function">getValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> order <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> order <span class="token operator">&lt;=</span> max<span class="token punctuation">;</span> order <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">const</span> cell <span class="token operator">=</span> range<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> order<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// from " a_group   /  a_name " to "a_group", "a_name"</span>
      <span class="token keyword">const</span> <span class="token punctuation">[</span>group<span class="token punctuation">,</span> name<span class="token punctuation">]</span> <span class="token operator">=</span> cell
        <span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=></span> x<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">const</span> bg <span class="token operator">=</span> cell<span class="token punctuation">.</span><span class="token function">getBackground</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">const</span> fg <span class="token operator">=</span> cell<span class="token punctuation">.</span><span class="token function">getFontColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

      <span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">State</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
        order<span class="token punctuation">,</span>
        bg<span class="token punctuation">,</span>
        fg<span class="token punctuation">,</span>
        name<span class="token punctuation">,</span>
        group<span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code>`,jk,Ns,q1,Ti,U1,G1,Fk,pp,op,M2,Bk,qs,Us,_i,V1,Nk,Gs,W1,Ii,Y1,J1,qk,wt,CT=`<code class="language-js"><span class="token comment">// genericGotofritzUtils.gs</span>
<span class="token keyword">function</span> <span class="token function">getBgColor</span><span class="token punctuation">(</span><span class="token parameter">cell</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> colorObj <span class="token operator">=</span>
    cell<span class="token punctuation">.</span><span class="token function">getBackgroundObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getColorType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> SpreadsheetApp<span class="token punctuation">.</span>ColorType<span class="token punctuation">.</span><span class="token constant">RGB</span>
      <span class="token operator">?</span> cell<span class="token punctuation">.</span><span class="token function">getBackgroundObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token operator">:</span> <span class="token constant">SS</span><span class="token punctuation">.</span><span class="token function">getSpreadsheetTheme</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getConcreteColor</span><span class="token punctuation">(</span>
          cell<span class="token punctuation">.</span><span class="token function">getBackgroundObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">asThemeColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getThemeColorType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> colorObj<span class="token punctuation">.</span><span class="token function">asRgbColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">asHexString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">getFgColor</span><span class="token punctuation">(</span><span class="token parameter">cell</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> colorObj <span class="token operator">=</span>
    cell<span class="token punctuation">.</span><span class="token function">getFontColorObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getColorType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> SpreadsheetApp<span class="token punctuation">.</span>ColorType<span class="token punctuation">.</span><span class="token constant">RGB</span>
      <span class="token operator">?</span> cell<span class="token punctuation">.</span><span class="token function">getFontColorObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token operator">:</span> <span class="token constant">SS</span><span class="token punctuation">.</span><span class="token function">getSpreadsheetTheme</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getConcreteColor</span><span class="token punctuation">(</span>
          cell<span class="token punctuation">.</span><span class="token function">getFontColorObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">asThemeColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getThemeColorType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> colorObj<span class="token punctuation">.</span><span class="token function">asRgbColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">asHexString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code>`,Uk,lp,z1,Gk,gt,DT=`<code class="language-diff">// State.gs
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   .map((x) => x.trim());
</span></span>
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> const bg = cell.getBackground()
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> const bg = getBgColor(cell)
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> const fg = cell.getFontColor(),
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> const fg = getFgColor(cell),
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const state = new State(&#123;</span></span></code>`,Vk,Vs,Ws,Ai,K1,Wk,ip,$1,Yk,d,X1,Oi,Z1,Q1,Pi,nv,sv,Ci,av,tv,Di,ev,pv,Ri,ov,lv,Li,iv,cv,Mi,rv,uv,Hi,kv,dv,Jk,vt,RT=`<code class="language-js"><span class="token comment">// globals.gs</span>
<span class="token keyword">const</span> <span class="token constant">A_CONST</span> <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> app <span class="token operator">=</span> <span class="token string">"what it was originally"</span><span class="token punctuation">;</span>

<span class="token comment">// Code.gs</span>
<span class="token keyword">function</span> <span class="token function">onOpen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  SpreadsheetApp<span class="token punctuation">.</span><span class="token function">getUi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createMenu</span><span class="token punctuation">(</span><span class="token string">"a menu"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addItem</span><span class="token punctuation">(</span><span class="token string">"What is App?"</span><span class="token punctuation">,</span> <span class="token string">"test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// App.gs</span>
<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token constant">A_CONST</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// func.gs</span>

<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  Browser<span class="token punctuation">.</span><span class="token function">msgBox</span><span class="token punctuation">(</span><span class="token constant">A_CONST</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Browser<span class="token punctuation">.</span><span class="token function">msgBox</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code>`,zk,Ys,fv,ji,hv,mv,Kk,bt,LT=`<code class="language-js"><span class="token comment">// global</span>
<span class="token keyword">let</span> app_<span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>app_<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    app_ <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> app_<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code>`,$k,X,yv,Fi,wv,gv,Bi,vv,bv,Xk,Et,MT=`<code class="language-js"><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>states_ <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token keyword">get</span> <span class="token function">states</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>states_<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>states_ <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StatesMgr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadStates_</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>states_<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">loadStates_</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> sh <span class="token operator">=</span> <span class="token constant">SS</span><span class="token punctuation">.</span><span class="token function">getActiveSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> range <span class="token operator">=</span> sh<span class="token punctuation">.</span><span class="token function">getRange</span><span class="token punctuation">(</span>
      <span class="token constant">DATA_ROW_HEADER</span><span class="token punctuation">,</span>
      <span class="token constant">DATA_COL_STATES_START</span><span class="token punctuation">,</span>
      <span class="token number">1</span><span class="token punctuation">,</span>
      sh<span class="token punctuation">.</span><span class="token function">getLastColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token constant">DATA_COL_STATES_START</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>states_<span class="token punctuation">.</span><span class="token function">loadStates</span><span class="token punctuation">(</span>range<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code>`,Zk,cp,Ev,Qk,xt,HT=`<code class="language-diff">// main.gs
function onOpen() &#123;
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> SpreadsheetApp.getActiveSpreadsheet().setSpreadsheetTimeZone("Europe/Berlin");
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> SpreadsheetApp.getUi().createMenu("CRM 4.0" )
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     .addItem('APP - test', function () &#123;
</span><span class="token prefix inserted">+</span><span class="token line">       Logger.log(getApp().states)
</span><span class="token prefix inserted">+</span><span class="token line">     &#125;)</span></span></code>`,nd,rp,xv,sd,up,Sv,ad,Js,zs,Ni,Tv,td,kp,_v,ed,dp,Iv,pd,Z,qi,Av,Ov,Ui,Pv,Cv,Gi,Dv,od,fp,Rv,ld,St,jT='<code class="language-undefined"></code>',id,Tt,FT='<code class="language-undefined"></code>';return{c(){N=t("h2"),en=t("a"),Ip=t("span"),qd=i("Need a CRM? Why not just use \u2026?"),zi=u(),sn=t("p"),Ap=t("em"),Ud=i("Why not just use a real CRM"),Gd=i("? The issues with CRMs is that the problem they are trying to solve is quite broad. Commercial CRM software needs to be general enough to appeal to all types of users. To fit all their requirements, it often ends up overcomplicated and fiddly. Learning requires quite a time investment. Which might be worth if you work in sales and a CRM is your main tool. But I am a casual user. I tried "),ea=t("a"),Vd=i("Capsule"),Wd=i(" and I found I spent most of my time trying to bend it to my needs."),Ki=u(),pa=t("p"),Op=t("em"),Yd=i("Why not just use Trello"),Jd=i("? I never understood the appeal of Trello. Yes, it gives you a Kanban-like workflow and the ability to include pretty pictures. But entering and editing data is way too laborious for my taste. You always need several clicks to get where you want. Also, I couldn\u2019t find ways to reorder or archive steps. And the horizontal scroll thing doesn\u2019t work for me. It works for physical whiteboards on walls, but not so much for electronic devices, IMHO"),$i=u(),pn=t("h2"),on=t("a"),Pp=t("span"),zd=i("Google Sheets with Apps Script is a great tool for quick tools and prototypes"),Xi=u(),At=t("p"),Kd=i("Google Sheets with some Google Apps Scripts (GAS) and maybe forms are quite underrated as prototyping tools. You can quickly put together small \u201Capps\u201D and distribute them around. No installation required. Just send a link and start gathering data and validating ideas. As long as you are aware of its strong points and limitations"),Zi=u(),ln=t("h2"),cn=t("a"),Cp=t("span"),$d=i("Tips on using Google Apps Script for prototyping"),Qi=u(),Ot=t("p"),Xd=i("In these years of using Google Apps Scripts I have collected a couple of principles that helped me well."),nc=u(),rn=t("h3"),un=t("a"),Dp=t("span"),Zd=i("1. Explicit interactions vs trying to build a SPA"),sc=u(),kn=t("p"),Qd=i("Google are super cautious when it comes to security with GAS. They limit a lot of functionality. Trying to build a fully fledged "),Pt=t("abbr"),nf=i("SPA"),sf=i(" with it is going to run into walls pretty quick. You can\u2019t detect when a user is selecting a cell or interacting with the UI. I am talking about things like automatically reordering a list when a user edits or deletes an item in it. My suggestion is to save yourself some frustration and not even try."),ac=u(),dn=t("p"),af=i("Just build your \u201Capp\u201D like in the good old days of the "),Rp=t("code"),tf=i("cgi-bin"),ef=i(". But ONLY DOING THE JOB YOU NEED TO. That is, completely stateless. The typical flow would be:"),tc=u(),h=t("ol"),Lp=t("li"),pf=i("User selects cell(s) in worksheet (optional)"),of=u(),Mp=t("li"),lf=i("User selects an entry from a custom menu which you have created"),cf=u(),Hp=t("li"),rf=i("The GAS script looks at the spreadsheet (including current selection from 1., if any) and works out the App\u2019s phase from it"),uf=u(),jp=t("li"),kf=i("the script does whatever processing it needs and updates the App state"),df=u(),Fp=t("li"),ff=i("the script updates the spreadsheet to match the new App state"),hf=u(),Bp=t("li"),mf=i("the scripts finishes and the user is free to mess with the spreadsheet manually"),yf=u(),Np=t("li"),wf=i("back to 1."),ec=u(),fn=t("h3"),hn=t("a"),qp=t("span"),gf=i("2. minimal work"),pc=u(),mn=t("h3"),yn=t("a"),Up=t("span"),vf=i("2. Resist the temptation to start coding straight away"),oc=u(),q=t("p"),bf=i("The nice thing about prototyping with Google Sheets is that you can start without needing any scripting. Just do everything completely manually. You just need to "),Gp=t("em"),Ef=i("think"),xf=i(" like a script, and repeat actions mechanically. Requires a bit of discipline, but it\u2019s doable. Then you can start adding scripting to replace the most common manual steps you take. The app will grow organically. It doesn\u2019t get more "),oa=t("a"),Sf=i("Lean"),Tf=i(" than that!"),lc=u(),wn=t("h3"),gn=t("a"),Vp=t("span"),_f=i("3. Model your problem space first"),ic=u(),Ct=t("p"),If=i("For small prototype the temptation is often to jump in and hack some code and see it at work. But that doesn\u2019t work so well with GAS. That\u2019s because your code will consist of endless variations on the same themes. Insert a cell, insert a row, copy some cell content elsewhere, remove a cell, etc. Over and over. All the code ends up looking the same with only minor variations. Then you notice some patterns, and decide to abstract them into generalised functions. But they also look exactly the same as everything else. It\u2019s like a house of mirrors. You\u2019ll get lost very quickly."),cc=u(),vn=t("p"),Af=i("Instead try and create abstractions that reflect your problem space. You are writing a recipes app? Think of Ingredients, Steps or whatever else. A journey planner? Then you may need Destination and so on. That may seem an overkill at first, but it will be very helpful as your prototype grows. Also think of "),Dt=t("abbr"),Of=i("OOP"),Pf=i(", and collect all your similar abstractions into a container / manager. So an IngredientList for Ingredients, a TripManager for a collection of Destinations, etc. Yes it smells like Java, but that\u2019s how the underlying stack works. It seems foolish to fight it."),rc=u(),Rt=t("p"),Cf=i("something something layout of cells or multiple cells something"),uc=u(),bn=t("h3"),En=t("a"),Wp=t("span"),Df=i("4. OOP is actually quite helpful (but there is a place for some FP too)"),kc=u(),U=t("p"),Rf=i("GAS is very classical-OOP based. You have a Sheet object, with contains Range objects, and so on. Whatever you think of OOP, It actually helps using the same approach for your abstraction. Once you have identified your abstractions, what can happen to them? An Ingredient in a recipes app, for example. You can recalculate amount if you change the number of servings. Then add a "),Yp=t("code"),Lf=i("recalculateAmount"),Mf=i(" method. Or you may have a \u201Cconvert to metric\u201D toggle - then add a "),Jp=t("code"),Hf=i("convertToMetric"),jf=i(" method to your Ingredient class. And so on. Under the bonnet then the abstraction will interact with one of the GAS objects, and create a Sheet, or move a Range, and so on."),dc=u(),xn=t("p"),Ff=i("FP becomes useful when you want to share utilities, especially formatting. For example, an "),zp=t("code"),Bf=i("asArchive"),Nf=i(" function would be useful to add consistent formatting to some of your abstractions. But then again you could do that with multiple inheritance or mixins."),fc=u(),Sn=t("h3"),Tn=t("a"),Kp=t("span"),qf=i("5. Testing is not a solved problem"),hc=u(),Lt=t("p"),Uf=i("\u201CWe didn\u2019t write tests because we didn\u2019t have time\u2026 we didn\u2019t have time because we didn\u2019t write tests\u201D is a well known programming meme. Sadly it\u2019s pretty much the only way with GAS. At the time of writing there isn\u2019t a testing framework for it. You will have to roll out your own. And it\u2019s not that easy (you can\u2019t simulate button clicks etc). The time investment in trying to write some sort of meaningful tests far outweigh the time it\u2019d take you to fix any bugs. I know because I tried. Unless writing GAS is your full time job and you are really investing in it for the long term, of course. If you do let me know, I\u2019d love to use your testing libraries \u{1F609}"),mc=u(),_n=t("h3"),In=t("a"),$p=t("span"),Gf=i("6. Always save your co-ordinates (rows, cells) in constants"),yc=u(),Mt=t("p"),Vf=i("It\u2019s inevitable that during the app lifetime you will want to move rows around here, add a column there, and so on. That means changing co-ordinates of all your methods. You really don\u2019t want to have go through your functions and manually update all those numbers. Putting magic numbers in function is a standard good practice in programming, but imperative with gS. It\u2019s confusing enough that half the built-in methods are 0-indexed, and the other half 1-indexed."),wc=u(),An=t("h3"),On=t("a"),Xp=t("span"),Wf=i("7. Use sidebars to enter data"),gc=u(),Ht=t("p"),la=t("a"),Yf=i("https://developers.google.com/apps-script/guides/dialogs"),vc=u(),Pn=t("h3"),Cn=t("a"),Zp=t("span"),Jf=i("8. Beware of data conversions"),bc=u(),jt=t("p"),zf=i("Spreadsheets are notorious for their irritating habit of converting cell data to something you don\u2019t want. GAS is not exempt from that. Dates, or anything date-like, are particularly tricky. Numbers are always represented with one decimal point internally, so be careful you may get a \u201C4.0\u201D when you are expecting a \u201C4\u201D. I suggest creating util functions for forcing conversion and be double sure."),Ec=u(),Dn=t("h3"),Rn=t("a"),Qp=t("span"),Kf=i("Script structure"),xc=u(),Ft=t("p"),Bt=t("img"),Sc=u(),Nt=t("p"),$f=i("I tend to organise the scripts in my projects pretty much the same way."),Tc=u(),y=t("dl"),no=t("dt"),Xf=i("main.gs"),v=t("dd"),Zf=i("When you select a "),so=t("code"),Qf=i("Extensions > Apps Script"),nh=i(" from the menu, a script called Code.gs is created. I rename it to "),ao=t("code"),sh=i("main.gs"),ah=i(". In it, I put the "),to=t("code"),th=i("function onOpen() ..."),eh=i(" that creates the main menu I use to enhance the spreadsheet. Each entry in the menu is mapped to a function, and those functions are all in this script as well. They will then call functions in other scripts. This allows me to run scripts from the editor, which is essential if you want to debug. "),eo=t("code"),ph=i("noop"),oh=i(" is just an empty function, used as a placeholder. "),qt=t("img"),po=t("dt"),lh=i("globals.gs"),Ln=t("dd"),ih=i("All constants are here, like "),oo=t("code"),ch=i("const SS = SpreadsheetApp.getActiveSpreadsheet();"),rh=i(" which is always needed. Colors. I assign rows and columns to variables, like "),lo=t("code"),uh=i("const DATA_ROW_START = 2;"),io=t("dt"),kh=i("genericGotofritzUtils.gs"),ia=t("dd"),dh=i("GAS is quite quirky, and I have a few trusty functions which I use in all projects. Things like "),co=t("code"),fh=i("getIndexOfSelectedRow"),hh=i(" or converting to/from date which is often problematic"),ro=t("dt"),mh=i("utils.gs"),uo=t("dd"),yh=i("These are generic functions specific to this project"),ko=t("dt"),wh=i("..the rest"),fo=t("dd"),gh=i("Then I tend to create a file for each class, and encapsulate functionality that way"),_c=u(),Mn=t("h2"),Hn=t("a"),ho=t("span"),vh=i("Designing a CRM app"),Ic=u(),jn=t("h3"),Fn=t("a"),mo=t("span"),bh=i("Step 1: Defining the problem"),Ac=u(),Ut=t("p"),Eh=i("As a job seeker I have quite simple needs. In short:"),Oc=u(),Bn=t("ul"),x=t("li"),xh=i("keep track of the "),yo=t("strong"),Sh=i("many"),Th=i(" active "),wo=t("strong"),_h=i("opportunities"),Ih=i(", so that I know in what "),go=t("strong"),Ah=i("phase"),Oh=i(" each opportunity is, and what "),vo=t("strong"),Ph=i("stages"),Ch=i(" in the interview process are coming up when"),Dh=u(),bo=t("li"),Rh=i("archive opportunities when they are no longer active. So that they are out of the way but I can search through them to find out if I have history with recruiter x or company y"),Pc=u(),f=t("p"),Lh=i("The words in bold look like good candidates for entities. The basic entity seems to be the "),Eo=t("strong"),Mh=i("Opportunities"),Hh=i(". There are "),xo=t("em"),jh=i("many"),Fh=i(" of them, i.e. "),So=t("em"),Bh=i("collections"),Nh=i(", or "),To=t("strong"),qh=i("Pools"),Uh=i(" of them. Each process goes through a sequence of "),_o=t("strong"),Gh=i("Steps"),Vh=i(". Both opportunities and Steps can be in one of a predefined set of "),Io=t("strong"),Wh=i("States"),Yh=i(". These are my main entities. Plus of course an "),Ao=t("strong"),Jh=i("App"),zh=i(" entity to orchestrate everything."),Cc=u(),Gt=t("p"),Kh=i("There are potentially many other entities (company, recruiter, interviewer, etc) but modelling them doesn\u2019t really help me (although they may still be useful). For now I\u2019ll just treat that information as background noise which I need to move around but not process."),Dc=u(),Vt=t("p"),$h=i("Now I need to flesh out some details of each entity"),Rc=u(),Nn=t("h4"),qn=t("a"),Oo=t("span"),Xh=i("State"),Lc=u(),Wt=t("p"),Yt=t("img"),Mc=u(),Jt=t("p"),Zh=i("An Opportunity or Step can be in one of a predefined State. States are hierarchical. The main phases are DUE and COMPLETE. The States associated with DUE are: OVERDUE, MAYBE_FAIL, MAYBE_SUCCESS, DUE, TENTATIVE_DUE. The States associated with COMPLETE are FAIL, SUCCESS, COMPLETE, BLACKLIST. Each Step has style information associated with it (a background and foreground colour). This style information is used both as a visual hint for the user, and as a way for the app to find out what phase a certain entity is. This entity has no methods, it\u2019s just a map of strings to style information. The States are actually created in Row 1 of the LIVE Sheet, which must always be present. The style information, name of the phase, and name of parent phase, is embedded in the name. So for example the DUE/OVERDUE cell will take phase OVERDUE, and so on."),Hc=u(),Un=t("h4"),Gn=t("a"),Po=t("span"),Qh=i("Step"),jc=u(),zt=t("p"),Kt=t("img"),Fc=u(),$t=t("p"),nm=i("A Step is at the lowest level of the hierarchy. It typically involves an appointment or deadline or action (like sending a CV, a tech challenge, an interview). It is represented by a Cell in a Sheet, but the Step entity itself doesn\u2019t know which sheet or which Pool it belongs to. A Step is always associated with a State. It contains other data: phase, date, time, contact involved, name of step, comments. Note that all of these are just strings. When the app needs to do something to a Step, it reads the text content of a cell, parses it, extracts all of the data information from it and instantiates a data object. Then it does whatever processing it needs to do. Finally it does the same process but in reverse: encode the data as a string, puts it in the cell, then change the visual appearance according to the phase the cell is in."),Bc=u(),Xt=t("p"),sm=i("The methods the Step entity will need are:"),Nc=u(),G=t("ul"),Co=t("li"),am=i("loadFromCell -> decodes a spreadsheet cell to instantiate a State entity"),tm=u(),Do=t("li"),em=i("writeToCell -> serialises a State entity to a spreadsheet cell"),pm=u(),Ro=t("li"),om=i("addComment -> comments are a list; this is a utility function to add to them"),qc=u(),Vn=t("h4"),Wn=t("a"),Lo=t("span"),lm=i("Opportunity"),Uc=u(),Zt=t("p"),Qt=t("img"),Gc=u(),ne=t("p"),im=i("The next level up. An Opportunity is a sequence of Steps with metadata. Every Opportunity has a State and at least a Step. The State of an Opportunity is the State of the latest Step within it. An Opportunity is associated with a spreadsheet row. When running a command, the app will read all of the cells in the row, decode the metadata, and then decode each of the Steps. From that information it can then create an Opportunity instance."),Vc=u(),se=t("p"),cm=i("An Opportunity\u2019s metadata is displayed in a cell in column 1. The initial Step is shown in a cell in column 2. Both columns are frozen, and their information doesn\u2019t change. All of the subsequent steps are shown from column 3 onwards. The ordering is a bit tricky. Column 3 is always the next DUE Step, if any. After that come all the remaining DUE Steps with the latest dates last. Then come the COMPLETE Steps, but they are ordered the other way, i.e. earliest date last. This may sound counter-intuitive, but after experimenting with a few options it works quite well. It lets me see the phase of all the Opportunities at a glance (it\u2019s always in column 3), without constantly having to scroll horizontally. There cannot be duplicate Opportunities."),Wc=u(),ae=t("p"),rm=i("An Opportunity can:"),Yc=u(),S=t("ul"),Mo=t("li"),um=i("loadFromRow -> decodes a spreadsheet row to instantiate an Opportunity entity"),km=u(),Ho=t("li"),dm=i("writeToRow -> the opposite"),fm=u(),jo=t("li"),hm=i("activateNextStep -> changes the current Step (i.e, the one in column 3) to one of the COMPLETE States, and either promotes the next DUE Step to column 3 or it asks the user for input so that it can create one"),mm=u(),Fo=t("li"),ym=i("addComment -> to the metadata in column 1"),Jc=u(),Yn=t("h4"),Jn=t("a"),Bo=t("span"),wm=i("Pools"),zc=u(),te=t("p"),ee=t("img"),Kc=u(),pe=t("p"),gm=i("A Pool (=collection) of Opportunities. Each Pool corresponds to a Sheet. Opportunities can be moved from one Pool to another, but Pools don\u2019t need to know about it. They simply deal with whatever Opportunities they find in the current sheet. Pools don\u2019t have any metadata, except for the Sheet name which gives some information on the purpose of the Pool (for example LIVE, ARCHIVE BLACKLIST, etc)"),$c=u(),oe=t("p"),vm=i("A Pool can:"),Xc=u(),T=t("ul"),No=t("li"),bm=i("loadFromSheet -> decodes a Sheet to instantiate an Pools entity"),Em=u(),qo=t("li"),xm=i("writeToSheet -> the opposite"),Sm=u(),Uo=t("li"),Tm=i("sort -> the opportunities within it (grouped by State, descending by date)"),_m=u(),Go=t("li"),Im=i("createOpportunity -> at the top of the Sheet"),Zc=u(),zn=t("h4"),Kn=t("a"),Vo=t("span"),Am=i("App"),Qc=u(),le=t("p"),Om=i("The App entity is at the top of the hierarchy. It consists of Pools. The list of Pools is arbitrary and hardcoded; the name of the sheet gives a hint of how the corresponding Pool will be managed. Not all Pools will exist, you can create them or remove them with the menu. Potential names:"),nr=u(),b=t("ul"),ca=t("li"),Pm=i("LIVE: all the Opportunities in one of the DUE States. This is the only Pool that "),Wo=t("em"),Cm=i("must"),Dm=i(" exist"),Rm=u(),Yo=t("li"),Lm=i("LIVE OVERDUE: if this Pool exists, the OVERDUE Opportunities are moved from LIVE to here. Is this is deleted, the opposite will happen"),Mm=u(),Jo=t("li"),Hm=i("ARCHIVE yyyy-qq: all of the COMPLETE Opportunities from quarter qq of year yyyy"),jm=u(),zo=t("li"),Fm=i("ARCHIVE BLACKLIST: if it exists, the BLACKLIST Opportunities are moved to here"),Bm=u(),Ko=t("li"),Nm=i("ARCHIVE PROMISING: individual COMPLETE Opportunities can be moved here"),sr=u(),ie=t("p"),qm=i("The App entity can:"),ar=u(),_=t("ul"),$o=t("li"),Um=i("createPool -> creates one of the Pools above if it doesn\u2019t exist, and move the relevant Opportunities around. It uses the LIVE Pool as a template"),Gm=u(),Xo=t("li"),Vm=i("destroyPool -> the opposite (doesn\u2019t apply to LIVE)"),Wm=u(),Zo=t("li"),Ym=i("moveProcess -> to a different Pool"),Jm=u(),Qo=t("li"),zm=i("updatePools -> ensures all the Opportunities are allocated to the correct Pool, creating ARCHIVE yyyy-qq as needed"),tr=u(),$n=t("h3"),Xn=t("a"),nl=t("span"),Km=i("Step 2: Iterating without programming to reach an initial MVP"),er=u(),ce=t("p"),$m=i("The above is the result of days of experimentation. Without any coding. I tried different layouts and abstractions and then pretended I was a script and did it all by hand. Keeping notes as I went along. Once happy I made a copy of it, removed all the sheets except for one called \u2018LIVE\u2019, and deleted all the data from it except for the top row. That\u2019s where the States are defined (useful as a legend). The first two column stay frozen."),pr=u(),re=t("p"),ue=t("img"),or=u(),Zn=t("h3"),Qn=t("a"),sl=t("span"),Xm=i("Step 3: Setup and menu"),lr=u(),ke=t("p"),D=t("del"),Zm=i("When you select "),al=t("code"),Qm=i("Extensions > Apps Script"),ny=i(" from the menu, a script called Code.gs is created. I typically use that to create a menu for the app. I use the menu for most functionality. Right now I create a divider for each of my main entities. It won\u2019t stay like that long term. But first I create a file called "),tl=t("code"),sy=i("constants.gs"),ay=i(" where I put all of the globals. To start off it will contain SS, a const for the active spreadsheet. SS is needed pretty much everywhere. "),el=t("code"),ty=i("noop"),ey=i(" is just an empty function, used as a placeholder."),ir=u(),ra=t("pre"),cr=u(),an=t("p"),pl=t("code"),py=i("onOpen"),oy=i(" is not as useful as one may think. Because of Google\u2019s paranoia it is quite limited in what it can do. But it can create menus, so that\u2019s what this file does. The SS variable is accessible here to; in fact all the top level variables are. Adding "),ol=t("code"),ly=i("null"),iy=i(" to the array of menu entries will create a divider."),rr=u(),ua=t("pre"),ur=u(),de=t("p"),fe=t("img"),kr=u(),ns=t("h3"),ss=t("a"),ll=t("span"),cy=i("Step 4: Creating opportunity"),dr=u(),he=t("p"),ry=i("Let\u2019s start doing something useful: creating a new opportunity. A new menu entry will call an actual function."),fr=u(),ka=t("pre"),hr=u(),me=t("p"),uy=i("I create a separate file for all the menu function. That helps when debugging, because I can pick one of the function and then just run it by pressing the button at the top. That is essential to be able to view any error messages."),mr=u(),ye=t("p"),ky=i("The sequence of steps within the function is quite self-explanatory. Function names which end with an underscore are \u201Cprivate\u201D in GAS."),yr=u(),da=t("pre"),wr=u(),we=t("p"),dy=i("For this I will need a Pool class \u2026"),gr=u(),fa=t("pre"),vr=u(),ge=t("p"),fy=i("\u2026and an Opportunity one"),br=u(),ha=t("pre"),Er=u(),V=t("p"),hy=i("Double check that selecting "),il=t("code"),my=i("> New opportunity"),yy=i(" doesn\u2019t throw any error. Good. Now to fill in the gaps. The minimal work would be to insert a row at the top, and push all the others down, without touching them. But I prefer the "),cl=t("em"),wy=i("stateless"),gy=i(" approach - i.e., load the complete Pool phase, process it, save the complete Pool phase. That sounds wasteful, but it means that I can combine functions any way I want. I can always be sure that at the end of each step the UI is in sync with the app state. And I can encapsulate the two steps \u201Cload App state\u201D and \u201Csave App state\u201D in functions and forget about them. As for efficiency, I can optimise later, should I need to."),xr=u(),ve=t("p"),vy=i("First, hard code some rows / cols coordinates in globals. The whole app starts at row 2 (the top row is for headers). Opportunities have two cols of metadata, col 1 and 2."),Sr=u(),ma=t("pre"),Tr=u(),as=t("p"),by=i("I will insert enough rows at the top to write the whole sequence of Opportunities in them. Then I will remove the rows below them. That\u2019s because GAS complains if you try to insert rows in a empty Sheet. Pools don\u2019t actually render Opportunities; they tell them to render themselves. To do so, the Opportunities need to know where they are on spreadsheet. The utility function "),rl=t("code"),Ey=i("reindex_"),xy=i(" does exactly that."),_r=u(),ya=t("pre"),Ir=u(),ts=t("p"),Sy=i("And now the two missing methods of Opportunities. "),ul=t("code"),Ty=i("updateUI"),_y=i(" will just show some random text for now"),Ar=u(),wa=t("pre"),Or=u(),ga=t("p"),Iy=i("\u201CDie\u201D is a function that I have been using since my Perl days\u2026 a long time ago. It\u2019s for "),va=t("a"),Ay=i("failing fast"),Pr=u(),ba=t("pre"),Cr=u(),es=t("h4"),ps=t("a"),kl=t("span"),Oy=i("5: Using an HTML form in a sidebar to create an Opportunity"),Dr=u(),be=t("p"),R=t("video"),Rr=u(),os=t("p"),Py=i("We can use an HTML form to add real data to an opportunity. Coding sidebars in vanilla js, like in 1999. Clunky but surprisingly easy. The form is a complete HTML document which you can load to the side. There two types of HTML documents you can load: pure HTML and templates. You load them in the sidebar in different ways. I don\u2019t know why they bother with that distinction. The only difference seems to be that templates can use the classic ASP looking "),dl=t("code"),Cy=i("<?= some data ?>"),Dy=i(" tags. I did say 1999, didn\u2019t I."),Lr=u(),Ee=t("p"),xe=t("img"),Mr=u(),W=t("p"),Ry=i("You can share JS (for validation, for example) and CSS across those documents by using a trick. You create an HTML document which only has JS in it, and one which only has CSS. Then you import those inside the HTML template you are working with. It only works with templates. It\u2019s ugly but it works. I don\u2019t bother, I only have a couple of forms and a few lines of CSS. I am happy to copy and paste them in all the forms I need. And as for validation, you can go a long way with "),Ea=t("a"),Ly=i("standard HTML input field parameters"),My=i(". Here\u2019s the "),xa=t("a"),Hy=i("official documentation for the separating CSS/JS/HTML trick"),jy=i("."),Hr=u(),Sa=t("pre"),jr=u(),I=t("p"),Fy=i("It\u2019s the simplest possible form, with barely any styling. "),fl=t("code"),By=i('<body onload="prefill()">'),Ny=i(" will fill up the form with data. Gosh I think it\u2019s the first time I use a "),hl=t("code"),qy=i("body onload"),Uy=i(" in 25 years. Some of it is for testing, so that I don\u2019t have to type it all the time. The only interesting part is the form submission. "),ml=t("code"),Gy=i('<form onsubmit="handleFormSubmit(this)">'),Vy=i(" handles that part."),Fr=u(),tn=t("p"),yl=t("code"),Wy=i("google.script.run.A_FUNCTION(formObj)"),Yy=i(" will call A_FUNCTION in your GAS app, and pass it a JSON object with all your form fields. Sweet. You then have this curious model where you create handlers for success and failure, and pass it to "),wl=t("code"),Jy=i("run"),zy=i(" before you call it. It\u2019s all relatively straightforward."),Br=u(),Ta=t("pre"),Nr=u(),Se=t("p"),Ky=i("Then we actually need to show this sidebar. The code called by the menu is completely different. Instead of processing data, it loads the HTML form and does nothing else"),qr=u(),_a=t("pre"),Ur=u(),Y=t("p"),$y=i("The data processing is done in the function connected to the form submission, "),gl=t("code"),Xy=i("handleCreateOpportunity"),Zy=i(". A new file, "),vl=t("code"),Qy=i("formHandlers.gs"),nw=i(", will contains all those form handlers."),Gr=u(),Ia=t("pre"),Vr=u(),Aa=t("pre"),Wr=u(),ls=t("p"),sw=i("And finally, we have to add some structured metadata, and not some random strings, to an opportunity. I have toyed with difference approaches, trying to keep it simple and yet flexible and easy to update. I came up with a generic utility class called "),bl=t("code"),aw=i("StructToUIBridge"),tw=i(", which I can reuse across projects."),Yr=u(),is=t("p"),ew=i("The basic idea is that each spreadsheet cell is a mini UI component. Made up of strings, each with their formatting, joined together by separators. To refresh the cell you form a sequence by alternating strings and separators. Then apply formatting. When you want to extract the data from the cell you strip the formatting away. Then break up the text into string + separator pairs. This is somewhat like how "),Oa=t("a"),pw=i("tagged template in JS"),ow=i(" work. The difficulty is that to format parts of a cell content you need to use RichText."),Jr=u(),Te=t("p"),lw=i("A Field is a simple ValueObject wich represents a string + separator pair. It does nothing but hold data. Although it could also have validation methods; that\u2019s what VOs often do. The \u2018style\u2019 attribute is a RichText style, which I create in the globals file. Styles are created by builders, themselves created by the top level app. Don\u2019t ask\u2026"),zr=u(),Pa=t("pre"),Kr=u(),J=t("p"),iw=i("A "),El=t("code"),cw=i("StructToUIBridge"),rw=i(" is a sequence of "),xl=t("code"),uw=i("Fields"),kw=i(". Plus a couple of styling values like background colour applied to the whole cell. It has methods to update the field contents. As well as generating the strings + separators sequence."),$r=u(),Ca=t("pre"),Xr=u(),cs=t("p"),dw=i("The interesting part is the "),Sl=t("code"),fw=i("updateCell"),hw=i(" method. It first concatenates all the strings + separators. Then for each pair it finds out their length and puts markers at the beginning and end. RichText is then used to apply styling between those markers. It\u2019s not the easiest thing to debug\u2026"),Zr=u(),Da=t("pre"),Qr=u(),A=t("p"),mw=i("The nice thing about this "),Tl=t("code"),yw=i("StructToUIBridge"),ww=i(" class is that it hides away all of the ugliness of RichText. It\u2019s very clear what the "),_l=t("code"),gw=i("metadata1"),vw=i(" and "),Il=t("code"),bw=i("metadata2"),Ew=i(" properties contain. They are simple to edit, which was the whole point."),nu=u(),Ra=t("pre"),su=u(),O=t("p"),xw=i("The "),Al=t("code"),Sw=i("bold"),Tw=i(" and "),Ol=t("code"),_w=i("smaller"),Iw=i(" style I created in "),Pl=t("code"),Aw=i("globals.gs"),Ow=i(". It\u2019s easy to create a set of styles for the whole app."),au=u(),La=t("pre"),tu=u(),_e=t("p"),Pw=i("Instantiating the Opportunity object, with some very basic validation, and then updating the spreadsheet cell, is fairly concise."),eu=u(),Ma=t("pre"),pu=u(),Ha=t("p"),Cl=t("code"),Cw=i("validDate"),Dw=i(" is one of a number of generic functions I share from project to project. Nothing super sophisticated. I use JSDoc for these functions because GAS is actually quite good with tooltips and showing you typing hings. Although they are not JSDoc, they are Closure Compiler annotations. So, not as useful."),ou=u(),ja=t("pre"),lu=u(),rs=t("h4"),us=t("a"),Dl=t("span"),Rw=i("Loading the state of the app from the spreadsheet"),iu=u(),ks=t("p"),Lw=i("Right now every time I create a new Opportunity in the app, the old ones are removed. That\u2019s because I haven\u2019t implemented "),Rl=t("code"),Mw=i("loadStateFromSheet_"),Hw=i(" yet. It\u2019s time to tackle that. First the easy part: getting the Opportunity object to delegate the job to its metadata objects."),cu=u(),Fa=t("pre"),ru=u(),Ie=t("p"),jw=i("Now for implementing those methods. I\u2019ll be using regular expressions. What could possibly go wrong, right? Actually A LOT could go wrong. If a field has no separator, then it won\u2019t work as there will be no boundary between fields. If the separator is found within any of the strings, then the whole thing will fall apart."),uu=u(),Ae=t("p"),Fw=i("The first part is easily solvable: we can simply force a separator. The next cannot be solved easily. I guess the code could reject separators which are potentially too dangerous (commas, dashes). But that\u2019s an overkill for an app which will only be used by myself. I\u2019ll live with the risk"),ku=u(),Ba=t("pre"),du=u(),P=t("p"),Bw=i("The next part is slightly trickier. The script needs to generate a RegExp based on the fields and separator it expects. The "),Ll=t("code"),Nw=i("generateParsingRegexp_"),qw=i(" does that with a simple array.reduce, no special tricks required. Tricky is deciding which of the capturing strings to make greedy "),Ml=t("code"),Uw=i("(.*)"),Gw=i(" and which not "),Hl=t("code"),Vw=i("(.*?)"),Ww=i(". There must be at least a greedy one. I opt for putting it last, but it may backfire in the future. We\u2019ll see. I hope it doesn\u2019t because debugging it is a quite painful."),fu=u(),Na=t("pre"),hu=u(),ds=t("p"),Yw=i("And finally the money shot, "),jl=t("code"),Jw=i("loadDataFromCell"),zw=i(". Most of the work is done by the RegExp. This function will simply plyg"),mu=u(),qa=t("pre"),yu=u(),Oe=t("p"),Kw=i("Now when I add a field, the previous ones stay there."),wu=u(),Pe=t("p"),L=t("video"),gu=u(),fs=t("h3"),hs=t("a"),Fl=t("span"),$w=i("Editing an Opportunity"),vu=u(),C=t("p"),Xw=i("I have done Create, Read, I might as well do the rest of the "),Bl=t("b"),Zw=i("CR"),Qw=i("UD operations. So "),Nl=t("b"),ng=i("U"),sg=i("pdate, or edit. All the pieces of the puzzle are already there. The app can read from a cell, and it can submit a form. All it needs is to connect the two, so that the data in form comes from the cell, and vice versa. Let\u2019s start fetching data from the cell and pushing it to the form. There is already a function for the fetching part, "),ql=t("code"),ag=i("loadDataFromCell"),tg=i(". But how do you inject data into the form?"),bu=u(),ms=t("h4"),ys=t("a"),Ul=t("span"),eg=i("Injecting data into an HTMLHtmlService form in a sidebar with Apps Script"),Eu=u(),ws=t("p"),pg=i("I assumed it would be relatively easy, perhaps by passing a payload as second argument to "),Gl=t("code"),og=i("createHtmlOutputFromFile"),lg=i(", but nope. There is a way to do it, but it\u2019s hacky. You turn the data into a DOM fragment - it could just be a string, or a whole DOM subtree - and then append it to the HTML form. Don\u2019t forget to CSS display to none! Then at the other end the form can extract it from the HTML and use it. As I said - hacky. There is a variation using HTML templates instead of documents, but I prefer not to use templates. They are not as useful as they seem. Even the documentation cautions against using them! So hacky DOM snippets it is."),xu=u(),gs=t("p"),ig=i("Start with adding a new menu entry, and a placeholder function. The function will be a variation of "),Vl=t("code"),cg=i("createOpportunity"),rg=i(", so let\u2019s copy that to start."),Su=u(),Ua=t("pre"),Tu=u(),z=t("p"),ug=i("First I will try and make sure I can actually pass data to the HTML form. The form will need data from an Opportunity. The user will need to have an Opportunity selected. So let\u2019s start fetching the Opportunity index, and then passing that as JSON. I use two of my standard functions for that, "),Wl=t("code"),kg=i("dieUnlessSelection"),dg=i(" and "),Yl=t("code"),fg=i("indexOfSelectedRow"),hg=i("."),_u=u(),Ga=t("pre"),Iu=u(),Ce=t("p"),mg=i("I will encode the JSON in an HTML div with a standard ID, saved in the globals file. The HTML form will not have access to it though. I will have to copy and paste it there manually. For now I make the div pink so that I can see it, but later on it will be display:none."),Au=u(),Va=t("pre"),Ou=u(),De=t("p"),yg=i("I click on the form and yeah, the HTML Div is there."),Pu=u(),Re=t("p"),Le=t("img"),Cu=u(),Me=t("p"),wg=i("Then in the form"),Du=u(),Wa=t("pre"),Ru=u(),He=t("p"),gg=i("and I can confirm I got the data. Cool, now that I have confirmed it works, let\u2019s wire it all app properly. First, a util function to format a JS obj as an HTML string, since I will be using it for different forms."),Lu=u(),Ya=t("pre"),Mu=u(),vs=t("p"),vg=i("Then I need a JSON representation of the Opportunity object. Since the data of interest is all in the StructToUIBridge, I add a generic "),Jl=t("code"),bg=i("asJson"),Eg=i(" method to that. And then a similarly named one for Opportunity"),Hu=u(),Ja=t("pre"),ju=u(),je=t("p"),xg=i("Finally, pass all that data to the form. I add an \u2018id\u2019 property so that the Pool object will know what to edit later. It is important to make the difference between the id of the Opportunity in the Pool, i.e. the index in the array, and the index of the row in the Sheet. I create static methods in the Pool class to make the conversion"),Fu=u(),za=t("pre"),Bu=u(),Ka=t("pre"),Nu=u(),Fe=t("p"),Sg=i("The form doesn\u2019t change much - I fetch the prefill data from the data embedded to the HTML, if present. I added a hidden field for the id. If the form is for creation, and there is no data embedded in the HTML in the form, I remove the id field from the HTML. That\u2019s the easiest approach, rather than mess about with the value of \u2018id\u2019. In fact the submit form doesn\u2019t change, it keeps sending all the form data as before."),qu=u(),$a=t("pre"),Uu=u(),Be=t("p"),Tg=i("The form handler only needs a little amend - a new branch to an update call if an id was found"),Gu=u(),Xa=t("pre"),Vu=u(),Ne=t("p"),_g=i("And finally the method that does the update. Because I have decoupled the data manipulation and the rendering, an update is pretty simple. It just puts an instance of a Opportunity in an array."),Wu=u(),Za=t("pre"),Yu=u(),bs=t("h3"),Es=t("a"),zl=t("span"),Ig=i("Deleting an Opportunity"),Ju=u(),K=t("p"),Ag=i("Having done all the ground work already, deleting an Opportunity is a 10 mins job. I use the same shared methods to get the user\u2019s selection. Then the built-in "),Kl=t("code"),Og=i("ui.alert"),Pg=i(" to show an \u2018are you sure\u2019 dialog. Finally I call pool\u2019s yet to be coded "),$l=t("code"),Cg=i("deleteOpportunity"),Dg=i(" method, and redraw the UI."),zu=u(),Qa=t("pre"),Ku=u(),nt=t("p"),Xl=t("code"),Rg=i("pool.deleteOpportunity"),Lg=i(" is a simple array splice"),$u=u(),st=t("pre"),Xu=u(),xs=t("h3"),Ss=t("a"),Zl=t("span"),Mg=i("Adding Steps"),Zu=u(),Ts=t("p"),Hg=i("A reminder of how the problem space is mapped into classes in this app. A Sheet represents a Pool of Opportunities. An Opportunity is a row in the sheet, and it uses the first two columns to the left to display metadata. I have already added CRUD functionality for all of that. To the "),Ql=t("em"),jg=i("right"),Fg=i(" of those two columns, there should be a sequence of Steps, each taking a cell in the row and growing horizontally, with the least recent at the far right. This is the part which I tackle now. It sounds like it\u2019s going to be a slog, but in fact it\u2019s not that bad. That\u2019s because as a Pool contains an array of Opportunity, an Opportunity contains an array of Steps. So the code is pretty similar. In fact I can pretty much copy and paste it in a new class, adapt it so that it uses columns rather than rows, and that\u2019s about it."),Qu=u(),qe=t("p"),Bg=i("The Step class is not too dissimilar from the Opportunity. Step has a col, which Opportunity doesn\u2019t need. And Opportunity has a list of Steps, which is not needed by Step. Of course the data displayed in the cell is different, but the basic idea is the same. All the basic CRUD functionality (Create, Update, Delete) from Opportunity can be ported to Step without too much trouble. I\u2019ll leave it as an exercise for the reader to adapt that. In future refactor I may look into extracting common feature to a commen parent class or mixin, but now\u2019s not the time."),nk=u(),_s=t("table"),at=t("tr"),ni=t("th"),Ng=i("Opportunity"),qg=u(),si=t("th"),Ug=i("Step"),Gg=u(),tt=t("tr"),ai=t("td"),Ue=t("pre"),Vg=u(),ti=t("td"),Ge=t("pre"),sk=u(),Ve=t("p"),Wg=i("For the record, the updated app menus will look like this"),ak=u(),et=t("pre"),tk=u(),Is=t("h4"),As=t("a"),ei=t("span"),Yg=i("Some utility functionality"),ek=u(),We=t("p"),Jg=i("At this stage I added a couple of useful menu entries which replicate existing functionality: Add Comment. These are similar to Edit Step / Opportunity but only focus on comments. Why? Because when I am talking to someone in a video call or phone, I want to have a larger than normal text box with no distractions. That spurred some refactoring - until now, whenever I edited an instance (of Opportunity, Step) I simply created a new one and replaced it. But now I want to fiddle with individual fields within the objects. I could of course access them directly, but that of course is a big no-no."),pk=u(),M=t("p"),zg=i("I change the generic "),pi=t("code"),Kg=i("StructToUIBridge"),$g=i(" container to make it easy to locate a specific field by name. After this change, if the fields were "),oi=t("code"),Xg=i("[{ name: 'mouse', ...}, { name: 'cat', ... }]"),Zg=i(" then fieldNames would contain "),li=t("code"),Qg=i("{ mouse: 0, cat: 1, ...}"),ok=u(),pt=t("pre"),lk=u(),Ye=t("p"),n1=i("And then a method to use those keys"),ik=u(),ot=t("pre"),ck=u(),Je=t("p"),s1=i("A new form for editing comments for both Opportunity and Step. A variation on the existing forms, bit with only a textarea and two hidden field. If no \u2018row\u2019 value was passed, the hidden input with id \u2018row\u2019 will be removed from the DOM"),rk=u(),lt=t("pre"),uk=u(),Os=t("p"),a1=i("The menu creates two similar entries for editing comments. I had to make sure the names were different - if you have two menu entries with the same name in GAS, the "),ii=t("code"),t1=i("onOpen"),e1=i(" handler will fail silently."),kk=u(),it=t("pre"),dk=u(),ze=t("p"),p1=i("The two functions are very similar, as it\u2019s obvious by putting them side by side. Again, room for refactoring there. But not yet."),fk=u(),Ps=t("table"),ct=t("tr"),ci=t("th"),o1=i("Opportunity"),l1=u(),ri=t("th"),i1=i("Step"),c1=u(),rt=t("tr"),ui=t("td"),Ke=t("pre"),r1=u(),ki=t("td"),$e=t("pre"),hk=u(),$=t("p"),u1=i("Both use "),di=t("code"),k1=i("getFieldValue"),d1=i(", which is a wrapper for "),fi=t("code"),f1=i("StructToUIBridge"),h1=i("\u2019s version:"),mk=u(),ut=t("pre"),yk=u(),kt=t("p"),m1=i("Both use a modal dialog box instead of a sidebar like in the other cases. That\u2019s because the size of a sidebar is fixed at 300px, whereas a dialog can be changed. Here I use values I have set in "),hi=t("code"),y1=i("globals.gs"),wk=u(),dt=t("pre"),gk=u(),Xe=t("p"),w1=i("Finally the form handler handles both cases. It switches to a Step if it has a row attribute, to Opportunity if it hasn\u2019t"),vk=u(),ft=t("pre"),bk=u(),H=t("p"),mi=t("code"),g1=i("updateFieldsInOpportunity"),v1=i(" and "),yi=t("code"),b1=i("updateFieldsInStep"),E1=i(" are wrappers for "),wi=t("code"),x1=i("StructToUIBridge"),S1=i("\u2019s method"),Ek=u(),ht=t("pre"),xk=u(),Ze=t("p"),T1=i("And here\u2019s the final result"),Sk=u(),Qe=t("p"),j=t("video"),Tk=u(),Cs=t("h3"),Ds=t("a"),gi=t("span"),_1=i("States and ordering"),_k=u(),np=t("p"),I1=i("The CRM is beginning to look good, but it\u2019s missing a very important thing. \u201CThe ability to tell the the phase of an Opportunity at a glance\u201D. The time has come to deal with States."),Ik=u(),Rs=t("h4"),Ls=t("a"),vi=t("span"),A1=i("Defining a State"),Ak=u(),sp=t("p"),O1=i("States give me a bird view of an Opportunity. Did all the steps so far look promising, what\u2019s the next step. Opportunities do not have States, it\u2019s the individual Steps that make it up who do. The State of an Opportunity is merely the State of the the \u201Ccurrent\u201D Step. More about \u201Ccurrent\u201D Steps later. For now, I will focus on managing States for Steps."),Ok=u(),ap=t("p"),P1=i("Through experimentation, I found that a two levels hierarchical structure works best. I need to know whether a Step is Complete or still Due. Or whether there are issues of some sort and the step needs Attention. Complete, Due, Attention are my top level State Groups, and will be hard coded in the app. They will be used to group Opportunities when ordering. Within each of those groups there are nuances, which I want to capture. For example, Step X is complete. But did it go well or bad? Step Y is simply Due, or Overdue? There are the States proper. The app will encode them as a background / foreground colours pairs. Encoding information with colours is not good for Accessibility. But I am not building an universal app. I am building a little proof of concept for myself."),Pk=u(),Ms=t("p"),C1=i("The last requirement is the ability to define States without code, just by editing cells in the spreadsheet. To achieve that, the app will be used to store definitions for those states. The string content will be in the form "),bi=t("code"),D1=i("GROUP / STATE"),R1=i(", and the app can read the colours from the sheet. The App instance will manage loading up the States from the Sheet."),Ck=u(),Hs=t("h4"),js=t("a"),Ei=t("span"),L1=i("Creating a StatesMgr and loading States lazily"),Dk=u(),tp=t("p"),ep=t("img"),Rk=u(),Fs=t("p"),M1=i("A State is a simple value obj. I don\u2019t think I will actually need an "),xi=t("code"),H1=i("order"),j1=i(" attribute, but let\u2019s add it anyway just in case."),Lk=u(),mt=t("pre"),Mk=u(),Bs=t("p"),F1=i("The StatesMgr does all the heavy lifting when it comes to Stages. For now I will add all the states to a "),Si=t("code"),B1=i("list"),N1=i(" property. The order in which they are found will determine the order in which they are sorted."),Hk=u(),yt=t("pre"),jk=u(),Ns=t("p"),q1=i("In the original version I would read the background colour with a simple call to "),Ti=t("code"),U1=i(".getBackground"),G1=i(". But it turns out it\u2019s not so simple. Colours in Google Sheets are either \u201Cnormal\u201D RGB colours, or they are Theme colours. They are both available in the colour picker, there is no way for a user to know which one is which."),Fk=u(),pp=t("p"),op=t("img"),Bk=u(),qs=t("h4"),Us=t("a"),_i=t("span"),V1=i("Getting the background and font colour of a Google Sheet cell with Apps Script"),Nk=u(),Gs=t("p"),W1=i("Why does it matter? A Theme colour doesn\u2019t know what it\u2019s RGB value is. If you try you\u2019ll either get an error or an empty string. Instead you\u2019ll have to fetch information from the Theme. A pointless complication IMHO. Even weirder is that if you change the background colour to a theme one, the foreground also becomes a theme colour. Even though it isn\u2019t. Be as it may, I hid that complexity away by creating to utility functions. To get the RGB value of a ThemeColor in Apps Scripts you need to get the Theme, then call its "),Ii=t("code"),Y1=i("getConcreteColor"),J1=i(" method passing it the label of the ThemeColor. Then once you have the Apps Script representation of the Color Object, it\u2019s treated as if it was a \u201Cnormal\u201D color, i.e. convert to RGB and then Hex. All very unnecessary if you ask me, but it is what it is."),qk=u(),wt=t("pre"),Uk=u(),lp=t("p"),z1=i("I can now amend the loadStates function to use those util functions"),Gk=u(),gt=t("pre"),Vk=u(),Vs=t("h4"),Ws=t("a"),Ai=t("span"),K1=i("Creating a global App object in Apps Scripts"),Wk=u(),ip=t("p"),$1=i("\u2026is not possible as far as I can see. Google Sheets is best thought of as a bunch of serverless functions. Your scripts contain the definitions, and your triggers and menus can cause some of them to call each other. But once all the calls are finished\u2026 poof! It\u2019s gone. There is no runtime global environment. Although though there is a global scope in which your variables and deinfitions live. Let\u2019s look at an example"),Yk=u(),d=t("p"),X1=i("When you open the Spreadsheet, "),Oi=t("code"),Z1=i("A_CONST"),Q1=i(", "),Pi=t("code"),nv=i("app"),sv=i(", "),Ci=t("code"),av=i("App"),tv=i(", "),Di=t("code"),ev=i("test"),pv=i(" and "),Ri=t("code"),ov=i("onOpen"),lv=i(" all exist within the global scope. Then "),Li=t("code"),iv=i("onOpen"),cv=i(" runs (it\u2019s one of the few triggers that does). It creates a menu and an instance of "),Mi=t("code"),rv=i("App"),uv=i(". Then it completes. After that the menu stays there, but "),Hi=t("code"),kv=i("app"),dv=i(" goes back to \u2018what it was originally\u2019. If you run \u2018What is App?\u2019 from the menu, it will give you \u201Cwhat it was originally\u201D"),Jk=u(),vt=t("pre"),zk=u(),Ys=t("p"),fv=i("So how does one create a global singleton? One way is to create a getter function that lazily instantiates the class, when needed. Throughout the code, you will use "),ji=t("code"),hv=i("getApp()"),mv=i(" to access the global App instance"),Kk=u(),bt=t("pre"),$k=u(),X=t("p"),yv=i("With that out of the way, I can now concentrate on the States. I will actually use the same pattern to lazily instantiate the StatesMgr. I don\u2019t often use getters in JS, but when I do is usually for lazy evaluation. "),Fi=t("code"),wv=i("get states"),gv=i(" will return "),Bi=t("code"),vv=i("states_"),bv=i(", and will create it if it doesn\u2019t exist."),Xk=u(),Et=t("pre"),Zk=u(),cp=t("p"),Ev=i("To test it all works I create a quick menu entry"),Qk=u(),xt=t("pre"),nd=u(),rp=t("p"),xv=i("I run it, check in the \u201Cexecutions\u201D tab in the Script editor\u2026 and the states are logged there. So far so good."),sd=u(),up=t("p"),Sv=i("Now it is just a matter of adding a new state property to each Step, and reading it when loading the data from the sheet"),ad=u(),Js=t("h3"),zs=t("a"),Ni=t("span"),Tv=i("Conclusion and potential next steps"),td=u(),kp=t("p"),_v=i("I have used this app for a while and does the job quite well, with a minimum of fuss. And what is more, it was usable from day 1 - with a lot of manual data entry at the beginning, which became less and less as I automated more and more steps. Obviously it\u2019s not as slick as a SPA put together by a team of UX and FE devs, but then it costed rather less in term of efforts. I find Google Apps Script great for knocking together quick prototypes like this."),ed=u(),dp=t("p"),Iv=i("I am not going to take this any further as my basic needs are met. But should I want to, it would be possible, for example to"),pd=u(),Z=t("ul"),qi=t("li"),Av=i("integrate with email to automatically generate steps from incoming messages, or generate emails from steps"),Ov=u(),Ui=t("li"),Pv=i("integrate with calendar to generate appointments and set reminders"),Cv=u(),Gi=t("li"),Dv=i("all of the above, to automatically generate emails with a list of available slots from my calendar."),od=u(),fp=t("p"),Rv=i("This would actually be quite useful, and who knows, I may well tackle it one of these days."),ld=u(),St=t("pre"),id=u(),Tt=t("pre"),this.h()},l(n){N=e(n,"H2",{id:!0});var o=p(N);en=e(o,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var H2=p(en);Ip=e(H2,"SPAN",{class:!0}),p(Ip).forEach(s),H2.forEach(s),qd=c(o,"Need a CRM? Why not just use \u2026?"),o.forEach(s),zi=k(n),sn=e(n,"P",{});var Vi=p(sn);Ap=e(Vi,"EM",{});var j2=p(Ap);Ud=c(j2,"Why not just use a real CRM"),j2.forEach(s),Gd=c(Vi,"? The issues with CRMs is that the problem they are trying to solve is quite broad. Commercial CRM software needs to be general enough to appeal to all types of users. To fit all their requirements, it often ends up overcomplicated and fiddly. Learning requires quite a time investment. Which might be worth if you work in sales and a CRM is your main tool. But I am a casual user. I tried "),ea=e(Vi,"A",{href:!0,rel:!0});var F2=p(ea);Vd=c(F2,"Capsule"),F2.forEach(s),Wd=c(Vi," and I found I spent most of my time trying to bend it to my needs."),Vi.forEach(s),Ki=k(n),pa=e(n,"P",{});var Lv=p(pa);Op=e(Lv,"EM",{});var B2=p(Op);Yd=c(B2,"Why not just use Trello"),B2.forEach(s),Jd=c(Lv,"? I never understood the appeal of Trello. Yes, it gives you a Kanban-like workflow and the ability to include pretty pictures. But entering and editing data is way too laborious for my taste. You always need several clicks to get where you want. Also, I couldn\u2019t find ways to reorder or archive steps. And the horizontal scroll thing doesn\u2019t work for me. It works for physical whiteboards on walls, but not so much for electronic devices, IMHO"),Lv.forEach(s),$i=k(n),pn=e(n,"H2",{id:!0});var Mv=p(pn);on=e(Mv,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var N2=p(on);Pp=e(N2,"SPAN",{class:!0}),p(Pp).forEach(s),N2.forEach(s),zd=c(Mv,"Google Sheets with Apps Script is a great tool for quick tools and prototypes"),Mv.forEach(s),Xi=k(n),At=e(n,"P",{});var q2=p(At);Kd=c(q2,"Google Sheets with some Google Apps Scripts (GAS) and maybe forms are quite underrated as prototyping tools. You can quickly put together small \u201Capps\u201D and distribute them around. No installation required. Just send a link and start gathering data and validating ideas. As long as you are aware of its strong points and limitations"),q2.forEach(s),Zi=k(n),ln=e(n,"H2",{id:!0});var Hv=p(ln);cn=e(Hv,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var U2=p(cn);Cp=e(U2,"SPAN",{class:!0}),p(Cp).forEach(s),U2.forEach(s),$d=c(Hv,"Tips on using Google Apps Script for prototyping"),Hv.forEach(s),Qi=k(n),Ot=e(n,"P",{});var G2=p(Ot);Xd=c(G2,"In these years of using Google Apps Scripts I have collected a couple of principles that helped me well."),G2.forEach(s),nc=k(n),rn=e(n,"H3",{id:!0});var jv=p(rn);un=e(jv,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var V2=p(un);Dp=e(V2,"SPAN",{class:!0}),p(Dp).forEach(s),V2.forEach(s),Zd=c(jv,"1. Explicit interactions vs trying to build a SPA"),jv.forEach(s),sc=k(n),kn=e(n,"P",{});var cd=p(kn);Qd=c(cd,"Google are super cautious when it comes to security with GAS. They limit a lot of functionality. Trying to build a fully fledged "),Pt=e(cd,"ABBR",{title:!0});var W2=p(Pt);nf=c(W2,"SPA"),W2.forEach(s),sf=c(cd," with it is going to run into walls pretty quick. You can\u2019t detect when a user is selecting a cell or interacting with the UI. I am talking about things like automatically reordering a list when a user edits or deletes an item in it. My suggestion is to save yourself some frustration and not even try."),cd.forEach(s),ac=k(n),dn=e(n,"P",{});var rd=p(dn);af=c(rd,"Just build your \u201Capp\u201D like in the good old days of the "),Rp=e(rd,"CODE",{});var Y2=p(Rp);tf=c(Y2,"cgi-bin"),Y2.forEach(s),ef=c(rd,". But ONLY DOING THE JOB YOU NEED TO. That is, completely stateless. The typical flow would be:"),rd.forEach(s),tc=k(n),h=e(n,"OL",{});var E=p(h);Lp=e(E,"LI",{});var J2=p(Lp);pf=c(J2,"User selects cell(s) in worksheet (optional)"),J2.forEach(s),of=k(E),Mp=e(E,"LI",{});var z2=p(Mp);lf=c(z2,"User selects an entry from a custom menu which you have created"),z2.forEach(s),cf=k(E),Hp=e(E,"LI",{});var K2=p(Hp);rf=c(K2,"The GAS script looks at the spreadsheet (including current selection from 1., if any) and works out the App\u2019s phase from it"),K2.forEach(s),uf=k(E),jp=e(E,"LI",{});var $2=p(jp);kf=c($2,"the script does whatever processing it needs and updates the App state"),$2.forEach(s),df=k(E),Fp=e(E,"LI",{});var X2=p(Fp);ff=c(X2,"the script updates the spreadsheet to match the new App state"),X2.forEach(s),hf=k(E),Bp=e(E,"LI",{});var Z2=p(Bp);mf=c(Z2,"the scripts finishes and the user is free to mess with the spreadsheet manually"),Z2.forEach(s),yf=k(E),Np=e(E,"LI",{});var Q2=p(Np);wf=c(Q2,"back to 1."),Q2.forEach(s),E.forEach(s),ec=k(n),fn=e(n,"H3",{id:!0});var Fv=p(fn);hn=e(Fv,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var nb=p(hn);qp=e(nb,"SPAN",{class:!0}),p(qp).forEach(s),nb.forEach(s),gf=c(Fv,"2. minimal work"),Fv.forEach(s),pc=k(n),mn=e(n,"H3",{id:!0});var Bv=p(mn);yn=e(Bv,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var sb=p(yn);Up=e(sb,"SPAN",{class:!0}),p(Up).forEach(s),sb.forEach(s),vf=c(Bv,"2. Resist the temptation to start coding straight away"),Bv.forEach(s),oc=k(n),q=e(n,"P",{});var hp=p(q);bf=c(hp,"The nice thing about prototyping with Google Sheets is that you can start without needing any scripting. Just do everything completely manually. You just need to "),Gp=e(hp,"EM",{});var ab=p(Gp);Ef=c(ab,"think"),ab.forEach(s),xf=c(hp," like a script, and repeat actions mechanically. Requires a bit of discipline, but it\u2019s doable. Then you can start adding scripting to replace the most common manual steps you take. The app will grow organically. It doesn\u2019t get more "),oa=e(hp,"A",{href:!0,rel:!0});var tb=p(oa);Sf=c(tb,"Lean"),tb.forEach(s),Tf=c(hp," than that!"),hp.forEach(s),lc=k(n),wn=e(n,"H3",{id:!0});var Nv=p(wn);gn=e(Nv,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var eb=p(gn);Vp=e(eb,"SPAN",{class:!0}),p(Vp).forEach(s),eb.forEach(s),_f=c(Nv,"3. Model your problem space first"),Nv.forEach(s),ic=k(n),Ct=e(n,"P",{});var pb=p(Ct);If=c(pb,"For small prototype the temptation is often to jump in and hack some code and see it at work. But that doesn\u2019t work so well with GAS. That\u2019s because your code will consist of endless variations on the same themes. Insert a cell, insert a row, copy some cell content elsewhere, remove a cell, etc. Over and over. All the code ends up looking the same with only minor variations. Then you notice some patterns, and decide to abstract them into generalised functions. But they also look exactly the same as everything else. It\u2019s like a house of mirrors. You\u2019ll get lost very quickly."),pb.forEach(s),cc=k(n),vn=e(n,"P",{});var ud=p(vn);Af=c(ud,"Instead try and create abstractions that reflect your problem space. You are writing a recipes app? Think of Ingredients, Steps or whatever else. A journey planner? Then you may need Destination and so on. That may seem an overkill at first, but it will be very helpful as your prototype grows. Also think of "),Dt=e(ud,"ABBR",{title:!0});var ob=p(Dt);Of=c(ob,"OOP"),ob.forEach(s),Pf=c(ud,", and collect all your similar abstractions into a container / manager. So an IngredientList for Ingredients, a TripManager for a collection of Destinations, etc. Yes it smells like Java, but that\u2019s how the underlying stack works. It seems foolish to fight it."),ud.forEach(s),rc=k(n),Rt=e(n,"P",{});var lb=p(Rt);Cf=c(lb,"something something layout of cells or multiple cells something"),lb.forEach(s),uc=k(n),bn=e(n,"H3",{id:!0});var qv=p(bn);En=e(qv,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var ib=p(En);Wp=e(ib,"SPAN",{class:!0}),p(Wp).forEach(s),ib.forEach(s),Df=c(qv,"4. OOP is actually quite helpful (but there is a place for some FP too)"),qv.forEach(s),kc=k(n),U=e(n,"P",{});var mp=p(U);Rf=c(mp,"GAS is very classical-OOP based. You have a Sheet object, with contains Range objects, and so on. Whatever you think of OOP, It actually helps using the same approach for your abstraction. Once you have identified your abstractions, what can happen to them? An Ingredient in a recipes app, for example. You can recalculate amount if you change the number of servings. Then add a "),Yp=e(mp,"CODE",{});var cb=p(Yp);Lf=c(cb,"recalculateAmount"),cb.forEach(s),Mf=c(mp," method. Or you may have a \u201Cconvert to metric\u201D toggle - then add a "),Jp=e(mp,"CODE",{});var rb=p(Jp);Hf=c(rb,"convertToMetric"),rb.forEach(s),jf=c(mp," method to your Ingredient class. And so on. Under the bonnet then the abstraction will interact with one of the GAS objects, and create a Sheet, or move a Range, and so on."),mp.forEach(s),dc=k(n),xn=e(n,"P",{});var kd=p(xn);Ff=c(kd,"FP becomes useful when you want to share utilities, especially formatting. For example, an "),zp=e(kd,"CODE",{});var ub=p(zp);Bf=c(ub,"asArchive"),ub.forEach(s),Nf=c(kd," function would be useful to add consistent formatting to some of your abstractions. But then again you could do that with multiple inheritance or mixins."),kd.forEach(s),fc=k(n),Sn=e(n,"H3",{id:!0});var Uv=p(Sn);Tn=e(Uv,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var kb=p(Tn);Kp=e(kb,"SPAN",{class:!0}),p(Kp).forEach(s),kb.forEach(s),qf=c(Uv,"5. Testing is not a solved problem"),Uv.forEach(s),hc=k(n),Lt=e(n,"P",{});var db=p(Lt);Uf=c(db,"\u201CWe didn\u2019t write tests because we didn\u2019t have time\u2026 we didn\u2019t have time because we didn\u2019t write tests\u201D is a well known programming meme. Sadly it\u2019s pretty much the only way with GAS. At the time of writing there isn\u2019t a testing framework for it. You will have to roll out your own. And it\u2019s not that easy (you can\u2019t simulate button clicks etc). The time investment in trying to write some sort of meaningful tests far outweigh the time it\u2019d take you to fix any bugs. I know because I tried. Unless writing GAS is your full time job and you are really investing in it for the long term, of course. If you do let me know, I\u2019d love to use your testing libraries \u{1F609}"),db.forEach(s),mc=k(n),_n=e(n,"H3",{id:!0});var Gv=p(_n);In=e(Gv,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var fb=p(In);$p=e(fb,"SPAN",{class:!0}),p($p).forEach(s),fb.forEach(s),Gf=c(Gv,"6. Always save your co-ordinates (rows, cells) in constants"),Gv.forEach(s),yc=k(n),Mt=e(n,"P",{});var hb=p(Mt);Vf=c(hb,"It\u2019s inevitable that during the app lifetime you will want to move rows around here, add a column there, and so on. That means changing co-ordinates of all your methods. You really don\u2019t want to have go through your functions and manually update all those numbers. Putting magic numbers in function is a standard good practice in programming, but imperative with gS. It\u2019s confusing enough that half the built-in methods are 0-indexed, and the other half 1-indexed."),hb.forEach(s),wc=k(n),An=e(n,"H3",{id:!0});var Vv=p(An);On=e(Vv,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var mb=p(On);Xp=e(mb,"SPAN",{class:!0}),p(Xp).forEach(s),mb.forEach(s),Wf=c(Vv,"7. Use sidebars to enter data"),Vv.forEach(s),gc=k(n),Ht=e(n,"P",{});var yb=p(Ht);la=e(yb,"A",{href:!0,rel:!0});var wb=p(la);Yf=c(wb,"https://developers.google.com/apps-script/guides/dialogs"),wb.forEach(s),yb.forEach(s),vc=k(n),Pn=e(n,"H3",{id:!0});var Wv=p(Pn);Cn=e(Wv,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var gb=p(Cn);Zp=e(gb,"SPAN",{class:!0}),p(Zp).forEach(s),gb.forEach(s),Jf=c(Wv,"8. Beware of data conversions"),Wv.forEach(s),bc=k(n),jt=e(n,"P",{});var vb=p(jt);zf=c(vb,"Spreadsheets are notorious for their irritating habit of converting cell data to something you don\u2019t want. GAS is not exempt from that. Dates, or anything date-like, are particularly tricky. Numbers are always represented with one decimal point internally, so be careful you may get a \u201C4.0\u201D when you are expecting a \u201C4\u201D. I suggest creating util functions for forcing conversion and be double sure."),vb.forEach(s),Ec=k(n),Dn=e(n,"H3",{id:!0});var Yv=p(Dn);Rn=e(Yv,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var bb=p(Rn);Qp=e(bb,"SPAN",{class:!0}),p(Qp).forEach(s),bb.forEach(s),Kf=c(Yv,"Script structure"),Yv.forEach(s),xc=k(n),Ft=e(n,"P",{});var Eb=p(Ft);Bt=e(Eb,"IMG",{src:!0,alt:!0}),Eb.forEach(s),Sc=k(n),Nt=e(n,"P",{});var xb=p(Nt);$f=c(xb,"I tend to organise the scripts in my projects pretty much the same way."),xb.forEach(s),Tc=k(n),y=e(n,"DL",{class:!0});var F=p(y);no=e(F,"DT",{});var Sb=p(no);Xf=c(Sb,"main.gs"),Sb.forEach(s),v=e(F,"DD",{});var B=p(v);Zf=c(B,"When you select a "),so=e(B,"CODE",{});var Tb=p(so);Qf=c(Tb,"Extensions > Apps Script"),Tb.forEach(s),nh=c(B," from the menu, a script called Code.gs is created. I rename it to "),ao=e(B,"CODE",{});var _b=p(ao);sh=c(_b,"main.gs"),_b.forEach(s),ah=c(B,". In it, I put the "),to=e(B,"CODE",{});var Ib=p(to);th=c(Ib,"function onOpen() ..."),Ib.forEach(s),eh=c(B," that creates the main menu I use to enhance the spreadsheet. Each entry in the menu is mapped to a function, and those functions are all in this script as well. They will then call functions in other scripts. This allows me to run scripts from the editor, which is essential if you want to debug. "),eo=e(B,"CODE",{});var Ab=p(eo);ph=c(Ab,"noop"),Ab.forEach(s),oh=c(B," is just an empty function, used as a placeholder. "),qt=e(B,"IMG",{src:!0,alt:!0}),B.forEach(s),po=e(F,"DT",{});var Ob=p(po);lh=c(Ob,"globals.gs"),Ob.forEach(s),Ln=e(F,"DD",{});var Wi=p(Ln);ih=c(Wi,"All constants are here, like "),oo=e(Wi,"CODE",{});var Pb=p(oo);ch=c(Pb,"const SS = SpreadsheetApp.getActiveSpreadsheet();"),Pb.forEach(s),rh=c(Wi," which is always needed. Colors. I assign rows and columns to variables, like "),lo=e(Wi,"CODE",{});var Cb=p(lo);uh=c(Cb,"const DATA_ROW_START = 2;"),Cb.forEach(s),Wi.forEach(s),io=e(F,"DT",{});var Db=p(io);kh=c(Db,"genericGotofritzUtils.gs"),Db.forEach(s),ia=e(F,"DD",{});var dd=p(ia);dh=c(dd,"GAS is quite quirky, and I have a few trusty functions which I use in all projects. Things like "),co=e(dd,"CODE",{});var Rb=p(co);fh=c(Rb,"getIndexOfSelectedRow"),Rb.forEach(s),hh=c(dd," or converting to/from date which is often problematic"),dd.forEach(s),ro=e(F,"DT",{});var Lb=p(ro);mh=c(Lb,"utils.gs"),Lb.forEach(s),uo=e(F,"DD",{});var Mb=p(uo);yh=c(Mb,"These are generic functions specific to this project"),Mb.forEach(s),ko=e(F,"DT",{});var Hb=p(ko);wh=c(Hb,"..the rest"),Hb.forEach(s),fo=e(F,"DD",{});var jb=p(fo);gh=c(jb,"Then I tend to create a file for each class, and encapsulate functionality that way"),jb.forEach(s),F.forEach(s),_c=k(n),Mn=e(n,"H2",{id:!0});var Jv=p(Mn);Hn=e(Jv,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var Fb=p(Hn);ho=e(Fb,"SPAN",{class:!0}),p(ho).forEach(s),Fb.forEach(s),vh=c(Jv,"Designing a CRM app"),Jv.forEach(s),Ic=k(n),jn=e(n,"H3",{id:!0});var zv=p(jn);Fn=e(zv,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var Bb=p(Fn);mo=e(Bb,"SPAN",{class:!0}),p(mo).forEach(s),Bb.forEach(s),bh=c(zv,"Step 1: Defining the problem"),zv.forEach(s),Ac=k(n),Ut=e(n,"P",{});var Nb=p(Ut);Eh=c(Nb,"As a job seeker I have quite simple needs. In short:"),Nb.forEach(s),Oc=k(n),Bn=e(n,"UL",{});var fd=p(Bn);x=e(fd,"LI",{});var Q=p(x);xh=c(Q,"keep track of the "),yo=e(Q,"STRONG",{});var qb=p(yo);Sh=c(qb,"many"),qb.forEach(s),Th=c(Q," active "),wo=e(Q,"STRONG",{});var Ub=p(wo);_h=c(Ub,"opportunities"),Ub.forEach(s),Ih=c(Q,", so that I know in what "),go=e(Q,"STRONG",{});var Gb=p(go);Ah=c(Gb,"phase"),Gb.forEach(s),Oh=c(Q," each opportunity is, and what "),vo=e(Q,"STRONG",{});var Vb=p(vo);Ph=c(Vb,"stages"),Vb.forEach(s),Ch=c(Q," in the interview process are coming up when"),Q.forEach(s),Dh=k(fd),bo=e(fd,"LI",{});var Wb=p(bo);Rh=c(Wb,"archive opportunities when they are no longer active. So that they are out of the way but I can search through them to find out if I have history with recruiter x or company y"),Wb.forEach(s),fd.forEach(s),Pc=k(n),f=e(n,"P",{});var w=p(f);Lh=c(w,"The words in bold look like good candidates for entities. The basic entity seems to be the "),Eo=e(w,"STRONG",{});var Yb=p(Eo);Mh=c(Yb,"Opportunities"),Yb.forEach(s),Hh=c(w,". There are "),xo=e(w,"EM",{});var Jb=p(xo);jh=c(Jb,"many"),Jb.forEach(s),Fh=c(w," of them, i.e. "),So=e(w,"EM",{});var zb=p(So);Bh=c(zb,"collections"),zb.forEach(s),Nh=c(w,", or "),To=e(w,"STRONG",{});var Kb=p(To);qh=c(Kb,"Pools"),Kb.forEach(s),Uh=c(w," of them. Each process goes through a sequence of "),_o=e(w,"STRONG",{});var $b=p(_o);Gh=c($b,"Steps"),$b.forEach(s),Vh=c(w,". Both opportunities and Steps can be in one of a predefined set of "),Io=e(w,"STRONG",{});var Xb=p(Io);Wh=c(Xb,"States"),Xb.forEach(s),Yh=c(w,". These are my main entities. Plus of course an "),Ao=e(w,"STRONG",{});var Zb=p(Ao);Jh=c(Zb,"App"),Zb.forEach(s),zh=c(w," entity to orchestrate everything."),w.forEach(s),Cc=k(n),Gt=e(n,"P",{});var Qb=p(Gt);Kh=c(Qb,"There are potentially many other entities (company, recruiter, interviewer, etc) but modelling them doesn\u2019t really help me (although they may still be useful). For now I\u2019ll just treat that information as background noise which I need to move around but not process."),Qb.forEach(s),Dc=k(n),Vt=e(n,"P",{});var nE=p(Vt);$h=c(nE,"Now I need to flesh out some details of each entity"),nE.forEach(s),Rc=k(n),Nn=e(n,"H4",{id:!0});var Kv=p(Nn);qn=e(Kv,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var sE=p(qn);Oo=e(sE,"SPAN",{class:!0}),p(Oo).forEach(s),sE.forEach(s),Xh=c(Kv,"State"),Kv.forEach(s),Lc=k(n),Wt=e(n,"P",{});var aE=p(Wt);Yt=e(aE,"IMG",{src:!0,alt:!0}),aE.forEach(s),Mc=k(n),Jt=e(n,"P",{});var tE=p(Jt);Zh=c(tE,"An Opportunity or Step can be in one of a predefined State. States are hierarchical. The main phases are DUE and COMPLETE. The States associated with DUE are: OVERDUE, MAYBE_FAIL, MAYBE_SUCCESS, DUE, TENTATIVE_DUE. The States associated with COMPLETE are FAIL, SUCCESS, COMPLETE, BLACKLIST. Each Step has style information associated with it (a background and foreground colour). This style information is used both as a visual hint for the user, and as a way for the app to find out what phase a certain entity is. This entity has no methods, it\u2019s just a map of strings to style information. The States are actually created in Row 1 of the LIVE Sheet, which must always be present. The style information, name of the phase, and name of parent phase, is embedded in the name. So for example the DUE/OVERDUE cell will take phase OVERDUE, and so on."),tE.forEach(s),Hc=k(n),Un=e(n,"H4",{id:!0});var $v=p(Un);Gn=e($v,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var eE=p(Gn);Po=e(eE,"SPAN",{class:!0}),p(Po).forEach(s),eE.forEach(s),Qh=c($v,"Step"),$v.forEach(s),jc=k(n),zt=e(n,"P",{});var pE=p(zt);Kt=e(pE,"IMG",{src:!0,alt:!0}),pE.forEach(s),Fc=k(n),$t=e(n,"P",{});var oE=p($t);nm=c(oE,"A Step is at the lowest level of the hierarchy. It typically involves an appointment or deadline or action (like sending a CV, a tech challenge, an interview). It is represented by a Cell in a Sheet, but the Step entity itself doesn\u2019t know which sheet or which Pool it belongs to. A Step is always associated with a State. It contains other data: phase, date, time, contact involved, name of step, comments. Note that all of these are just strings. When the app needs to do something to a Step, it reads the text content of a cell, parses it, extracts all of the data information from it and instantiates a data object. Then it does whatever processing it needs to do. Finally it does the same process but in reverse: encode the data as a string, puts it in the cell, then change the visual appearance according to the phase the cell is in."),oE.forEach(s),Bc=k(n),Xt=e(n,"P",{});var lE=p(Xt);sm=c(lE,"The methods the Step entity will need are:"),lE.forEach(s),Nc=k(n),G=e(n,"UL",{});var yp=p(G);Co=e(yp,"LI",{});var iE=p(Co);am=c(iE,"loadFromCell -> decodes a spreadsheet cell to instantiate a State entity"),iE.forEach(s),tm=k(yp),Do=e(yp,"LI",{});var cE=p(Do);em=c(cE,"writeToCell -> serialises a State entity to a spreadsheet cell"),cE.forEach(s),pm=k(yp),Ro=e(yp,"LI",{});var rE=p(Ro);om=c(rE,"addComment -> comments are a list; this is a utility function to add to them"),rE.forEach(s),yp.forEach(s),qc=k(n),Vn=e(n,"H4",{id:!0});var Xv=p(Vn);Wn=e(Xv,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var uE=p(Wn);Lo=e(uE,"SPAN",{class:!0}),p(Lo).forEach(s),uE.forEach(s),lm=c(Xv,"Opportunity"),Xv.forEach(s),Uc=k(n),Zt=e(n,"P",{});var kE=p(Zt);Qt=e(kE,"IMG",{src:!0,alt:!0}),kE.forEach(s),Gc=k(n),ne=e(n,"P",{});var dE=p(ne);im=c(dE,"The next level up. An Opportunity is a sequence of Steps with metadata. Every Opportunity has a State and at least a Step. The State of an Opportunity is the State of the latest Step within it. An Opportunity is associated with a spreadsheet row. When running a command, the app will read all of the cells in the row, decode the metadata, and then decode each of the Steps. From that information it can then create an Opportunity instance."),dE.forEach(s),Vc=k(n),se=e(n,"P",{});var fE=p(se);cm=c(fE,"An Opportunity\u2019s metadata is displayed in a cell in column 1. The initial Step is shown in a cell in column 2. Both columns are frozen, and their information doesn\u2019t change. All of the subsequent steps are shown from column 3 onwards. The ordering is a bit tricky. Column 3 is always the next DUE Step, if any. After that come all the remaining DUE Steps with the latest dates last. Then come the COMPLETE Steps, but they are ordered the other way, i.e. earliest date last. This may sound counter-intuitive, but after experimenting with a few options it works quite well. It lets me see the phase of all the Opportunities at a glance (it\u2019s always in column 3), without constantly having to scroll horizontally. There cannot be duplicate Opportunities."),fE.forEach(s),Wc=k(n),ae=e(n,"P",{});var hE=p(ae);rm=c(hE,"An Opportunity can:"),hE.forEach(s),Yc=k(n),S=e(n,"UL",{});var Ks=p(S);Mo=e(Ks,"LI",{});var mE=p(Mo);um=c(mE,"loadFromRow -> decodes a spreadsheet row to instantiate an Opportunity entity"),mE.forEach(s),km=k(Ks),Ho=e(Ks,"LI",{});var yE=p(Ho);dm=c(yE,"writeToRow -> the opposite"),yE.forEach(s),fm=k(Ks),jo=e(Ks,"LI",{});var wE=p(jo);hm=c(wE,"activateNextStep -> changes the current Step (i.e, the one in column 3) to one of the COMPLETE States, and either promotes the next DUE Step to column 3 or it asks the user for input so that it can create one"),wE.forEach(s),mm=k(Ks),Fo=e(Ks,"LI",{});var gE=p(Fo);ym=c(gE,"addComment -> to the metadata in column 1"),gE.forEach(s),Ks.forEach(s),Jc=k(n),Yn=e(n,"H4",{id:!0});var Zv=p(Yn);Jn=e(Zv,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var vE=p(Jn);Bo=e(vE,"SPAN",{class:!0}),p(Bo).forEach(s),vE.forEach(s),wm=c(Zv,"Pools"),Zv.forEach(s),zc=k(n),te=e(n,"P",{});var bE=p(te);ee=e(bE,"IMG",{src:!0,alt:!0}),bE.forEach(s),Kc=k(n),pe=e(n,"P",{});var EE=p(pe);gm=c(EE,"A Pool (=collection) of Opportunities. Each Pool corresponds to a Sheet. Opportunities can be moved from one Pool to another, but Pools don\u2019t need to know about it. They simply deal with whatever Opportunities they find in the current sheet. Pools don\u2019t have any metadata, except for the Sheet name which gives some information on the purpose of the Pool (for example LIVE, ARCHIVE BLACKLIST, etc)"),EE.forEach(s),$c=k(n),oe=e(n,"P",{});var xE=p(oe);vm=c(xE,"A Pool can:"),xE.forEach(s),Xc=k(n),T=e(n,"UL",{});var $s=p(T);No=e($s,"LI",{});var SE=p(No);bm=c(SE,"loadFromSheet -> decodes a Sheet to instantiate an Pools entity"),SE.forEach(s),Em=k($s),qo=e($s,"LI",{});var TE=p(qo);xm=c(TE,"writeToSheet -> the opposite"),TE.forEach(s),Sm=k($s),Uo=e($s,"LI",{});var _E=p(Uo);Tm=c(_E,"sort -> the opportunities within it (grouped by State, descending by date)"),_E.forEach(s),_m=k($s),Go=e($s,"LI",{});var IE=p(Go);Im=c(IE,"createOpportunity -> at the top of the Sheet"),IE.forEach(s),$s.forEach(s),Zc=k(n),zn=e(n,"H4",{id:!0});var Qv=p(zn);Kn=e(Qv,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var AE=p(Kn);Vo=e(AE,"SPAN",{class:!0}),p(Vo).forEach(s),AE.forEach(s),Am=c(Qv,"App"),Qv.forEach(s),Qc=k(n),le=e(n,"P",{});var OE=p(le);Om=c(OE,"The App entity is at the top of the hierarchy. It consists of Pools. The list of Pools is arbitrary and hardcoded; the name of the sheet gives a hint of how the corresponding Pool will be managed. Not all Pools will exist, you can create them or remove them with the menu. Potential names:"),OE.forEach(s),nr=k(n),b=e(n,"UL",{});var nn=p(b);ca=e(nn,"LI",{});var hd=p(ca);Pm=c(hd,"LIVE: all the Opportunities in one of the DUE States. This is the only Pool that "),Wo=e(hd,"EM",{});var PE=p(Wo);Cm=c(PE,"must"),PE.forEach(s),Dm=c(hd," exist"),hd.forEach(s),Rm=k(nn),Yo=e(nn,"LI",{});var CE=p(Yo);Lm=c(CE,"LIVE OVERDUE: if this Pool exists, the OVERDUE Opportunities are moved from LIVE to here. Is this is deleted, the opposite will happen"),CE.forEach(s),Mm=k(nn),Jo=e(nn,"LI",{});var DE=p(Jo);Hm=c(DE,"ARCHIVE yyyy-qq: all of the COMPLETE Opportunities from quarter qq of year yyyy"),DE.forEach(s),jm=k(nn),zo=e(nn,"LI",{});var RE=p(zo);Fm=c(RE,"ARCHIVE BLACKLIST: if it exists, the BLACKLIST Opportunities are moved to here"),RE.forEach(s),Bm=k(nn),Ko=e(nn,"LI",{});var LE=p(Ko);Nm=c(LE,"ARCHIVE PROMISING: individual COMPLETE Opportunities can be moved here"),LE.forEach(s),nn.forEach(s),sr=k(n),ie=e(n,"P",{});var ME=p(ie);qm=c(ME,"The App entity can:"),ME.forEach(s),ar=k(n),_=e(n,"UL",{});var Xs=p(_);$o=e(Xs,"LI",{});var HE=p($o);Um=c(HE,"createPool -> creates one of the Pools above if it doesn\u2019t exist, and move the relevant Opportunities around. It uses the LIVE Pool as a template"),HE.forEach(s),Gm=k(Xs),Xo=e(Xs,"LI",{});var jE=p(Xo);Vm=c(jE,"destroyPool -> the opposite (doesn\u2019t apply to LIVE)"),jE.forEach(s),Wm=k(Xs),Zo=e(Xs,"LI",{});var FE=p(Zo);Ym=c(FE,"moveProcess -> to a different Pool"),FE.forEach(s),Jm=k(Xs),Qo=e(Xs,"LI",{});var BE=p(Qo);zm=c(BE,"updatePools -> ensures all the Opportunities are allocated to the correct Pool, creating ARCHIVE yyyy-qq as needed"),BE.forEach(s),Xs.forEach(s),tr=k(n),$n=e(n,"H3",{id:!0});var n2=p($n);Xn=e(n2,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var NE=p(Xn);nl=e(NE,"SPAN",{class:!0}),p(nl).forEach(s),NE.forEach(s),Km=c(n2,"Step 2: Iterating without programming to reach an initial MVP"),n2.forEach(s),er=k(n),ce=e(n,"P",{});var qE=p(ce);$m=c(qE,"The above is the result of days of experimentation. Without any coding. I tried different layouts and abstractions and then pretended I was a script and did it all by hand. Keeping notes as I went along. Once happy I made a copy of it, removed all the sheets except for one called \u2018LIVE\u2019, and deleted all the data from it except for the top row. That\u2019s where the States are defined (useful as a legend). The first two column stay frozen."),qE.forEach(s),pr=k(n),re=e(n,"P",{});var UE=p(re);ue=e(UE,"IMG",{src:!0,alt:!0}),UE.forEach(s),or=k(n),Zn=e(n,"H3",{id:!0});var s2=p(Zn);Qn=e(s2,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var GE=p(Qn);sl=e(GE,"SPAN",{class:!0}),p(sl).forEach(s),GE.forEach(s),Xm=c(s2,"Step 3: Setup and menu"),s2.forEach(s),lr=k(n),ke=e(n,"P",{});var VE=p(ke);D=e(VE,"DEL",{});var Zs=p(D);Zm=c(Zs,"When you select "),al=e(Zs,"CODE",{});var WE=p(al);Qm=c(WE,"Extensions > Apps Script"),WE.forEach(s),ny=c(Zs," from the menu, a script called Code.gs is created. I typically use that to create a menu for the app. I use the menu for most functionality. Right now I create a divider for each of my main entities. It won\u2019t stay like that long term. But first I create a file called "),tl=e(Zs,"CODE",{});var YE=p(tl);sy=c(YE,"constants.gs"),YE.forEach(s),ay=c(Zs," where I put all of the globals. To start off it will contain SS, a const for the active spreadsheet. SS is needed pretty much everywhere. "),el=e(Zs,"CODE",{});var JE=p(el);ty=c(JE,"noop"),JE.forEach(s),ey=c(Zs," is just an empty function, used as a placeholder."),Zs.forEach(s),VE.forEach(s),ir=k(n),ra=e(n,"PRE",{class:!0});var BT=p(ra);BT.forEach(s),cr=k(n),an=e(n,"P",{});var Yi=p(an);pl=e(Yi,"CODE",{});var zE=p(pl);py=c(zE,"onOpen"),zE.forEach(s),oy=c(Yi," is not as useful as one may think. Because of Google\u2019s paranoia it is quite limited in what it can do. But it can create menus, so that\u2019s what this file does. The SS variable is accessible here to; in fact all the top level variables are. Adding "),ol=e(Yi,"CODE",{});var KE=p(ol);ly=c(KE,"null"),KE.forEach(s),iy=c(Yi," to the array of menu entries will create a divider."),Yi.forEach(s),rr=k(n),ua=e(n,"PRE",{class:!0});var NT=p(ua);NT.forEach(s),ur=k(n),de=e(n,"P",{});var $E=p(de);fe=e($E,"IMG",{src:!0,alt:!0}),$E.forEach(s),kr=k(n),ns=e(n,"H3",{id:!0});var a2=p(ns);ss=e(a2,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var XE=p(ss);ll=e(XE,"SPAN",{class:!0}),p(ll).forEach(s),XE.forEach(s),cy=c(a2,"Step 4: Creating opportunity"),a2.forEach(s),dr=k(n),he=e(n,"P",{});var ZE=p(he);ry=c(ZE,"Let\u2019s start doing something useful: creating a new opportunity. A new menu entry will call an actual function."),ZE.forEach(s),fr=k(n),ka=e(n,"PRE",{class:!0});var qT=p(ka);qT.forEach(s),hr=k(n),me=e(n,"P",{});var QE=p(me);uy=c(QE,"I create a separate file for all the menu function. That helps when debugging, because I can pick one of the function and then just run it by pressing the button at the top. That is essential to be able to view any error messages."),QE.forEach(s),mr=k(n),ye=e(n,"P",{});var n3=p(ye);ky=c(n3,"The sequence of steps within the function is quite self-explanatory. Function names which end with an underscore are \u201Cprivate\u201D in GAS."),n3.forEach(s),yr=k(n),da=e(n,"PRE",{class:!0});var UT=p(da);UT.forEach(s),wr=k(n),we=e(n,"P",{});var s3=p(we);dy=c(s3,"For this I will need a Pool class \u2026"),s3.forEach(s),gr=k(n),fa=e(n,"PRE",{class:!0});var GT=p(fa);GT.forEach(s),vr=k(n),ge=e(n,"P",{});var a3=p(ge);fy=c(a3,"\u2026and an Opportunity one"),a3.forEach(s),br=k(n),ha=e(n,"PRE",{class:!0});var VT=p(ha);VT.forEach(s),Er=k(n),V=e(n,"P",{});var wp=p(V);hy=c(wp,"Double check that selecting "),il=e(wp,"CODE",{});var t3=p(il);my=c(t3,"> New opportunity"),t3.forEach(s),yy=c(wp," doesn\u2019t throw any error. Good. Now to fill in the gaps. The minimal work would be to insert a row at the top, and push all the others down, without touching them. But I prefer the "),cl=e(wp,"EM",{});var e3=p(cl);wy=c(e3,"stateless"),e3.forEach(s),gy=c(wp," approach - i.e., load the complete Pool phase, process it, save the complete Pool phase. That sounds wasteful, but it means that I can combine functions any way I want. I can always be sure that at the end of each step the UI is in sync with the app state. And I can encapsulate the two steps \u201Cload App state\u201D and \u201Csave App state\u201D in functions and forget about them. As for efficiency, I can optimise later, should I need to."),wp.forEach(s),xr=k(n),ve=e(n,"P",{});var p3=p(ve);vy=c(p3,"First, hard code some rows / cols coordinates in globals. The whole app starts at row 2 (the top row is for headers). Opportunities have two cols of metadata, col 1 and 2."),p3.forEach(s),Sr=k(n),ma=e(n,"PRE",{class:!0});var WT=p(ma);WT.forEach(s),Tr=k(n),as=e(n,"P",{});var md=p(as);by=c(md,"I will insert enough rows at the top to write the whole sequence of Opportunities in them. Then I will remove the rows below them. That\u2019s because GAS complains if you try to insert rows in a empty Sheet. Pools don\u2019t actually render Opportunities; they tell them to render themselves. To do so, the Opportunities need to know where they are on spreadsheet. The utility function "),rl=e(md,"CODE",{});var o3=p(rl);Ey=c(o3,"reindex_"),o3.forEach(s),xy=c(md," does exactly that."),md.forEach(s),_r=k(n),ya=e(n,"PRE",{class:!0});var YT=p(ya);YT.forEach(s),Ir=k(n),ts=e(n,"P",{});var yd=p(ts);Sy=c(yd,"And now the two missing methods of Opportunities. "),ul=e(yd,"CODE",{});var l3=p(ul);Ty=c(l3,"updateUI"),l3.forEach(s),_y=c(yd," will just show some random text for now"),yd.forEach(s),Ar=k(n),wa=e(n,"PRE",{class:!0});var JT=p(wa);JT.forEach(s),Or=k(n),ga=e(n,"P",{});var t2=p(ga);Iy=c(t2,"\u201CDie\u201D is a function that I have been using since my Perl days\u2026 a long time ago. It\u2019s for "),va=e(t2,"A",{href:!0,rel:!0});var i3=p(va);Ay=c(i3,"failing fast"),i3.forEach(s),t2.forEach(s),Pr=k(n),ba=e(n,"PRE",{class:!0});var zT=p(ba);zT.forEach(s),Cr=k(n),es=e(n,"H4",{id:!0});var e2=p(es);ps=e(e2,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var c3=p(ps);kl=e(c3,"SPAN",{class:!0}),p(kl).forEach(s),c3.forEach(s),Oy=c(e2,"5: Using an HTML form in a sidebar to create an Opportunity"),e2.forEach(s),Dr=k(n),be=e(n,"P",{});var r3=p(be);R=e(r3,"VIDEO",{src:!0,title:!0}),p(R).forEach(s),r3.forEach(s),Rr=k(n),os=e(n,"P",{});var wd=p(os);Py=c(wd,"We can use an HTML form to add real data to an opportunity. Coding sidebars in vanilla js, like in 1999. Clunky but surprisingly easy. The form is a complete HTML document which you can load to the side. There two types of HTML documents you can load: pure HTML and templates. You load them in the sidebar in different ways. I don\u2019t know why they bother with that distinction. The only difference seems to be that templates can use the classic ASP looking "),dl=e(wd,"CODE",{});var u3=p(dl);Cy=c(u3,"<?= some data ?>"),u3.forEach(s),Dy=c(wd," tags. I did say 1999, didn\u2019t I."),wd.forEach(s),Lr=k(n),Ee=e(n,"P",{});var k3=p(Ee);xe=e(k3,"IMG",{src:!0,alt:!0}),k3.forEach(s),Mr=k(n),W=e(n,"P",{});var gp=p(W);Ry=c(gp,"You can share JS (for validation, for example) and CSS across those documents by using a trick. You create an HTML document which only has JS in it, and one which only has CSS. Then you import those inside the HTML template you are working with. It only works with templates. It\u2019s ugly but it works. I don\u2019t bother, I only have a couple of forms and a few lines of CSS. I am happy to copy and paste them in all the forms I need. And as for validation, you can go a long way with "),Ea=e(gp,"A",{href:!0,rel:!0});var d3=p(Ea);Ly=c(d3,"standard HTML input field parameters"),d3.forEach(s),My=c(gp,". Here\u2019s the "),xa=e(gp,"A",{href:!0,rel:!0});var f3=p(xa);Hy=c(f3,"official documentation for the separating CSS/JS/HTML trick"),f3.forEach(s),jy=c(gp,"."),gp.forEach(s),Hr=k(n),Sa=e(n,"PRE",{class:!0});var KT=p(Sa);KT.forEach(s),jr=k(n),I=e(n,"P",{});var Qs=p(I);Fy=c(Qs,"It\u2019s the simplest possible form, with barely any styling. "),fl=e(Qs,"CODE",{});var h3=p(fl);By=c(h3,'<body onload="prefill()">'),h3.forEach(s),Ny=c(Qs," will fill up the form with data. Gosh I think it\u2019s the first time I use a "),hl=e(Qs,"CODE",{});var m3=p(hl);qy=c(m3,"body onload"),m3.forEach(s),Uy=c(Qs," in 25 years. Some of it is for testing, so that I don\u2019t have to type it all the time. The only interesting part is the form submission. "),ml=e(Qs,"CODE",{});var y3=p(ml);Gy=c(y3,'<form onsubmit="handleFormSubmit(this)">'),y3.forEach(s),Vy=c(Qs," handles that part."),Qs.forEach(s),Fr=k(n),tn=e(n,"P",{});var Ji=p(tn);yl=e(Ji,"CODE",{});var w3=p(yl);Wy=c(w3,"google.script.run.A_FUNCTION(formObj)"),w3.forEach(s),Yy=c(Ji," will call A_FUNCTION in your GAS app, and pass it a JSON object with all your form fields. Sweet. You then have this curious model where you create handlers for success and failure, and pass it to "),wl=e(Ji,"CODE",{});var g3=p(wl);Jy=c(g3,"run"),g3.forEach(s),zy=c(Ji," before you call it. It\u2019s all relatively straightforward."),Ji.forEach(s),Br=k(n),Ta=e(n,"PRE",{class:!0});var $T=p(Ta);$T.forEach(s),Nr=k(n),Se=e(n,"P",{});var v3=p(Se);Ky=c(v3,"Then we actually need to show this sidebar. The code called by the menu is completely different. Instead of processing data, it loads the HTML form and does nothing else"),v3.forEach(s),qr=k(n),_a=e(n,"PRE",{class:!0});var XT=p(_a);XT.forEach(s),Ur=k(n),Y=e(n,"P",{});var vp=p(Y);$y=c(vp,"The data processing is done in the function connected to the form submission, "),gl=e(vp,"CODE",{});var b3=p(gl);Xy=c(b3,"handleCreateOpportunity"),b3.forEach(s),Zy=c(vp,". A new file, "),vl=e(vp,"CODE",{});var E3=p(vl);Qy=c(E3,"formHandlers.gs"),E3.forEach(s),nw=c(vp,", will contains all those form handlers."),vp.forEach(s),Gr=k(n),Ia=e(n,"PRE",{class:!0});var ZT=p(Ia);ZT.forEach(s),Vr=k(n),Aa=e(n,"PRE",{class:!0});var QT=p(Aa);QT.forEach(s),Wr=k(n),ls=e(n,"P",{});var gd=p(ls);sw=c(gd,"And finally, we have to add some structured metadata, and not some random strings, to an opportunity. I have toyed with difference approaches, trying to keep it simple and yet flexible and easy to update. I came up with a generic utility class called "),bl=e(gd,"CODE",{});var x3=p(bl);aw=c(x3,"StructToUIBridge"),x3.forEach(s),tw=c(gd,", which I can reuse across projects."),gd.forEach(s),Yr=k(n),is=e(n,"P",{});var vd=p(is);ew=c(vd,"The basic idea is that each spreadsheet cell is a mini UI component. Made up of strings, each with their formatting, joined together by separators. To refresh the cell you form a sequence by alternating strings and separators. Then apply formatting. When you want to extract the data from the cell you strip the formatting away. Then break up the text into string + separator pairs. This is somewhat like how "),Oa=e(vd,"A",{href:!0,rel:!0});var S3=p(Oa);pw=c(S3,"tagged template in JS"),S3.forEach(s),ow=c(vd," work. The difficulty is that to format parts of a cell content you need to use RichText."),vd.forEach(s),Jr=k(n),Te=e(n,"P",{});var T3=p(Te);lw=c(T3,"A Field is a simple ValueObject wich represents a string + separator pair. It does nothing but hold data. Although it could also have validation methods; that\u2019s what VOs often do. The \u2018style\u2019 attribute is a RichText style, which I create in the globals file. Styles are created by builders, themselves created by the top level app. Don\u2019t ask\u2026"),T3.forEach(s),zr=k(n),Pa=e(n,"PRE",{class:!0});var n_=p(Pa);n_.forEach(s),Kr=k(n),J=e(n,"P",{});var bp=p(J);iw=c(bp,"A "),El=e(bp,"CODE",{});var _3=p(El);cw=c(_3,"StructToUIBridge"),_3.forEach(s),rw=c(bp," is a sequence of "),xl=e(bp,"CODE",{});var I3=p(xl);uw=c(I3,"Fields"),I3.forEach(s),kw=c(bp,". Plus a couple of styling values like background colour applied to the whole cell. It has methods to update the field contents. As well as generating the strings + separators sequence."),bp.forEach(s),$r=k(n),Ca=e(n,"PRE",{class:!0});var s_=p(Ca);s_.forEach(s),Xr=k(n),cs=e(n,"P",{});var bd=p(cs);dw=c(bd,"The interesting part is the "),Sl=e(bd,"CODE",{});var A3=p(Sl);fw=c(A3,"updateCell"),A3.forEach(s),hw=c(bd," method. It first concatenates all the strings + separators. Then for each pair it finds out their length and puts markers at the beginning and end. RichText is then used to apply styling between those markers. It\u2019s not the easiest thing to debug\u2026"),bd.forEach(s),Zr=k(n),Da=e(n,"PRE",{class:!0});var a_=p(Da);a_.forEach(s),Qr=k(n),A=e(n,"P",{});var na=p(A);mw=c(na,"The nice thing about this "),Tl=e(na,"CODE",{});var O3=p(Tl);yw=c(O3,"StructToUIBridge"),O3.forEach(s),ww=c(na," class is that it hides away all of the ugliness of RichText. It\u2019s very clear what the "),_l=e(na,"CODE",{});var P3=p(_l);gw=c(P3,"metadata1"),P3.forEach(s),vw=c(na," and "),Il=e(na,"CODE",{});var C3=p(Il);bw=c(C3,"metadata2"),C3.forEach(s),Ew=c(na," properties contain. They are simple to edit, which was the whole point."),na.forEach(s),nu=k(n),Ra=e(n,"PRE",{class:!0});var t_=p(Ra);t_.forEach(s),su=k(n),O=e(n,"P",{});var sa=p(O);xw=c(sa,"The "),Al=e(sa,"CODE",{});var D3=p(Al);Sw=c(D3,"bold"),D3.forEach(s),Tw=c(sa," and "),Ol=e(sa,"CODE",{});var R3=p(Ol);_w=c(R3,"smaller"),R3.forEach(s),Iw=c(sa," style I created in "),Pl=e(sa,"CODE",{});var L3=p(Pl);Aw=c(L3,"globals.gs"),L3.forEach(s),Ow=c(sa,". It\u2019s easy to create a set of styles for the whole app."),sa.forEach(s),au=k(n),La=e(n,"PRE",{class:!0});var e_=p(La);e_.forEach(s),tu=k(n),_e=e(n,"P",{});var M3=p(_e);Pw=c(M3,"Instantiating the Opportunity object, with some very basic validation, and then updating the spreadsheet cell, is fairly concise."),M3.forEach(s),eu=k(n),Ma=e(n,"PRE",{class:!0});var p_=p(Ma);p_.forEach(s),pu=k(n),Ha=e(n,"P",{});var p2=p(Ha);Cl=e(p2,"CODE",{});var H3=p(Cl);Cw=c(H3,"validDate"),H3.forEach(s),Dw=c(p2," is one of a number of generic functions I share from project to project. Nothing super sophisticated. I use JSDoc for these functions because GAS is actually quite good with tooltips and showing you typing hings. Although they are not JSDoc, they are Closure Compiler annotations. So, not as useful."),p2.forEach(s),ou=k(n),ja=e(n,"PRE",{class:!0});var o_=p(ja);o_.forEach(s),lu=k(n),rs=e(n,"H4",{id:!0});var o2=p(rs);us=e(o2,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var j3=p(us);Dl=e(j3,"SPAN",{class:!0}),p(Dl).forEach(s),j3.forEach(s),Rw=c(o2,"Loading the state of the app from the spreadsheet"),o2.forEach(s),iu=k(n),ks=e(n,"P",{});var Ed=p(ks);Lw=c(Ed,"Right now every time I create a new Opportunity in the app, the old ones are removed. That\u2019s because I haven\u2019t implemented "),Rl=e(Ed,"CODE",{});var F3=p(Rl);Mw=c(F3,"loadStateFromSheet_"),F3.forEach(s),Hw=c(Ed," yet. It\u2019s time to tackle that. First the easy part: getting the Opportunity object to delegate the job to its metadata objects."),Ed.forEach(s),cu=k(n),Fa=e(n,"PRE",{class:!0});var l_=p(Fa);l_.forEach(s),ru=k(n),Ie=e(n,"P",{});var B3=p(Ie);jw=c(B3,"Now for implementing those methods. I\u2019ll be using regular expressions. What could possibly go wrong, right? Actually A LOT could go wrong. If a field has no separator, then it won\u2019t work as there will be no boundary between fields. If the separator is found within any of the strings, then the whole thing will fall apart."),B3.forEach(s),uu=k(n),Ae=e(n,"P",{});var N3=p(Ae);Fw=c(N3,"The first part is easily solvable: we can simply force a separator. The next cannot be solved easily. I guess the code could reject separators which are potentially too dangerous (commas, dashes). But that\u2019s an overkill for an app which will only be used by myself. I\u2019ll live with the risk"),N3.forEach(s),ku=k(n),Ba=e(n,"PRE",{class:!0});var i_=p(Ba);i_.forEach(s),du=k(n),P=e(n,"P",{});var aa=p(P);Bw=c(aa,"The next part is slightly trickier. The script needs to generate a RegExp based on the fields and separator it expects. The "),Ll=e(aa,"CODE",{});var q3=p(Ll);Nw=c(q3,"generateParsingRegexp_"),q3.forEach(s),qw=c(aa," does that with a simple array.reduce, no special tricks required. Tricky is deciding which of the capturing strings to make greedy "),Ml=e(aa,"CODE",{});var U3=p(Ml);Uw=c(U3,"(.*)"),U3.forEach(s),Gw=c(aa," and which not "),Hl=e(aa,"CODE",{});var G3=p(Hl);Vw=c(G3,"(.*?)"),G3.forEach(s),Ww=c(aa,". There must be at least a greedy one. I opt for putting it last, but it may backfire in the future. We\u2019ll see. I hope it doesn\u2019t because debugging it is a quite painful."),aa.forEach(s),fu=k(n),Na=e(n,"PRE",{class:!0});var c_=p(Na);c_.forEach(s),hu=k(n),ds=e(n,"P",{});var xd=p(ds);Yw=c(xd,"And finally the money shot, "),jl=e(xd,"CODE",{});var V3=p(jl);Jw=c(V3,"loadDataFromCell"),V3.forEach(s),zw=c(xd,". Most of the work is done by the RegExp. This function will simply plyg"),xd.forEach(s),mu=k(n),qa=e(n,"PRE",{class:!0});var r_=p(qa);r_.forEach(s),yu=k(n),Oe=e(n,"P",{});var W3=p(Oe);Kw=c(W3,"Now when I add a field, the previous ones stay there."),W3.forEach(s),wu=k(n),Pe=e(n,"P",{});var Y3=p(Pe);L=e(Y3,"VIDEO",{src:!0,title:!0}),p(L).forEach(s),Y3.forEach(s),gu=k(n),fs=e(n,"H3",{id:!0});var l2=p(fs);hs=e(l2,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var J3=p(hs);Fl=e(J3,"SPAN",{class:!0}),p(Fl).forEach(s),J3.forEach(s),$w=c(l2,"Editing an Opportunity"),l2.forEach(s),vu=k(n),C=e(n,"P",{});var ta=p(C);Xw=c(ta,"I have done Create, Read, I might as well do the rest of the "),Bl=e(ta,"B",{});var z3=p(Bl);Zw=c(z3,"CR"),z3.forEach(s),Qw=c(ta,"UD operations. So "),Nl=e(ta,"B",{});var K3=p(Nl);ng=c(K3,"U"),K3.forEach(s),sg=c(ta,"pdate, or edit. All the pieces of the puzzle are already there. The app can read from a cell, and it can submit a form. All it needs is to connect the two, so that the data in form comes from the cell, and vice versa. Let\u2019s start fetching data from the cell and pushing it to the form. There is already a function for the fetching part, "),ql=e(ta,"CODE",{});var $3=p(ql);ag=c($3,"loadDataFromCell"),$3.forEach(s),tg=c(ta,". But how do you inject data into the form?"),ta.forEach(s),bu=k(n),ms=e(n,"H4",{id:!0});var i2=p(ms);ys=e(i2,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var X3=p(ys);Ul=e(X3,"SPAN",{class:!0}),p(Ul).forEach(s),X3.forEach(s),eg=c(i2,"Injecting data into an HTMLHtmlService form in a sidebar with Apps Script"),i2.forEach(s),Eu=k(n),ws=e(n,"P",{});var Sd=p(ws);pg=c(Sd,"I assumed it would be relatively easy, perhaps by passing a payload as second argument to "),Gl=e(Sd,"CODE",{});var Z3=p(Gl);og=c(Z3,"createHtmlOutputFromFile"),Z3.forEach(s),lg=c(Sd,", but nope. There is a way to do it, but it\u2019s hacky. You turn the data into a DOM fragment - it could just be a string, or a whole DOM subtree - and then append it to the HTML form. Don\u2019t forget to CSS display to none! Then at the other end the form can extract it from the HTML and use it. As I said - hacky. There is a variation using HTML templates instead of documents, but I prefer not to use templates. They are not as useful as they seem. Even the documentation cautions against using them! So hacky DOM snippets it is."),Sd.forEach(s),xu=k(n),gs=e(n,"P",{});var Td=p(gs);ig=c(Td,"Start with adding a new menu entry, and a placeholder function. The function will be a variation of "),Vl=e(Td,"CODE",{});var Q3=p(Vl);cg=c(Q3,"createOpportunity"),Q3.forEach(s),rg=c(Td,", so let\u2019s copy that to start."),Td.forEach(s),Su=k(n),Ua=e(n,"PRE",{class:!0});var u_=p(Ua);u_.forEach(s),Tu=k(n),z=e(n,"P",{});var Ep=p(z);ug=c(Ep,"First I will try and make sure I can actually pass data to the HTML form. The form will need data from an Opportunity. The user will need to have an Opportunity selected. So let\u2019s start fetching the Opportunity index, and then passing that as JSON. I use two of my standard functions for that, "),Wl=e(Ep,"CODE",{});var nx=p(Wl);kg=c(nx,"dieUnlessSelection"),nx.forEach(s),dg=c(Ep," and "),Yl=e(Ep,"CODE",{});var sx=p(Yl);fg=c(sx,"indexOfSelectedRow"),sx.forEach(s),hg=c(Ep,"."),Ep.forEach(s),_u=k(n),Ga=e(n,"PRE",{class:!0});var k_=p(Ga);k_.forEach(s),Iu=k(n),Ce=e(n,"P",{});var ax=p(Ce);mg=c(ax,"I will encode the JSON in an HTML div with a standard ID, saved in the globals file. The HTML form will not have access to it though. I will have to copy and paste it there manually. For now I make the div pink so that I can see it, but later on it will be display:none."),ax.forEach(s),Au=k(n),Va=e(n,"PRE",{class:!0});var d_=p(Va);d_.forEach(s),Ou=k(n),De=e(n,"P",{});var tx=p(De);yg=c(tx,"I click on the form and yeah, the HTML Div is there."),tx.forEach(s),Pu=k(n),Re=e(n,"P",{});var ex=p(Re);Le=e(ex,"IMG",{src:!0,alt:!0}),ex.forEach(s),Cu=k(n),Me=e(n,"P",{});var px=p(Me);wg=c(px,"Then in the form"),px.forEach(s),Du=k(n),Wa=e(n,"PRE",{class:!0});var f_=p(Wa);f_.forEach(s),Ru=k(n),He=e(n,"P",{});var ox=p(He);gg=c(ox,"and I can confirm I got the data. Cool, now that I have confirmed it works, let\u2019s wire it all app properly. First, a util function to format a JS obj as an HTML string, since I will be using it for different forms."),ox.forEach(s),Lu=k(n),Ya=e(n,"PRE",{class:!0});var h_=p(Ya);h_.forEach(s),Mu=k(n),vs=e(n,"P",{});var _d=p(vs);vg=c(_d,"Then I need a JSON representation of the Opportunity object. Since the data of interest is all in the StructToUIBridge, I add a generic "),Jl=e(_d,"CODE",{});var lx=p(Jl);bg=c(lx,"asJson"),lx.forEach(s),Eg=c(_d," method to that. And then a similarly named one for Opportunity"),_d.forEach(s),Hu=k(n),Ja=e(n,"PRE",{class:!0});var m_=p(Ja);m_.forEach(s),ju=k(n),je=e(n,"P",{});var ix=p(je);xg=c(ix,"Finally, pass all that data to the form. I add an \u2018id\u2019 property so that the Pool object will know what to edit later. It is important to make the difference between the id of the Opportunity in the Pool, i.e. the index in the array, and the index of the row in the Sheet. I create static methods in the Pool class to make the conversion"),ix.forEach(s),Fu=k(n),za=e(n,"PRE",{class:!0});var y_=p(za);y_.forEach(s),Bu=k(n),Ka=e(n,"PRE",{class:!0});var w_=p(Ka);w_.forEach(s),Nu=k(n),Fe=e(n,"P",{});var cx=p(Fe);Sg=c(cx,"The form doesn\u2019t change much - I fetch the prefill data from the data embedded to the HTML, if present. I added a hidden field for the id. If the form is for creation, and there is no data embedded in the HTML in the form, I remove the id field from the HTML. That\u2019s the easiest approach, rather than mess about with the value of \u2018id\u2019. In fact the submit form doesn\u2019t change, it keeps sending all the form data as before."),cx.forEach(s),qu=k(n),$a=e(n,"PRE",{class:!0});var g_=p($a);g_.forEach(s),Uu=k(n),Be=e(n,"P",{});var rx=p(Be);Tg=c(rx,"The form handler only needs a little amend - a new branch to an update call if an id was found"),rx.forEach(s),Gu=k(n),Xa=e(n,"PRE",{class:!0});var v_=p(Xa);v_.forEach(s),Vu=k(n),Ne=e(n,"P",{});var ux=p(Ne);_g=c(ux,"And finally the method that does the update. Because I have decoupled the data manipulation and the rendering, an update is pretty simple. It just puts an instance of a Opportunity in an array."),ux.forEach(s),Wu=k(n),Za=e(n,"PRE",{class:!0});var b_=p(Za);b_.forEach(s),Yu=k(n),bs=e(n,"H3",{id:!0});var c2=p(bs);Es=e(c2,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var kx=p(Es);zl=e(kx,"SPAN",{class:!0}),p(zl).forEach(s),kx.forEach(s),Ig=c(c2,"Deleting an Opportunity"),c2.forEach(s),Ju=k(n),K=e(n,"P",{});var xp=p(K);Ag=c(xp,"Having done all the ground work already, deleting an Opportunity is a 10 mins job. I use the same shared methods to get the user\u2019s selection. Then the built-in "),Kl=e(xp,"CODE",{});var dx=p(Kl);Og=c(dx,"ui.alert"),dx.forEach(s),Pg=c(xp," to show an \u2018are you sure\u2019 dialog. Finally I call pool\u2019s yet to be coded "),$l=e(xp,"CODE",{});var fx=p($l);Cg=c(fx,"deleteOpportunity"),fx.forEach(s),Dg=c(xp," method, and redraw the UI."),xp.forEach(s),zu=k(n),Qa=e(n,"PRE",{class:!0});var E_=p(Qa);E_.forEach(s),Ku=k(n),nt=e(n,"P",{});var r2=p(nt);Xl=e(r2,"CODE",{});var hx=p(Xl);Rg=c(hx,"pool.deleteOpportunity"),hx.forEach(s),Lg=c(r2," is a simple array splice"),r2.forEach(s),$u=k(n),st=e(n,"PRE",{class:!0});var x_=p(st);x_.forEach(s),Xu=k(n),xs=e(n,"H3",{id:!0});var u2=p(xs);Ss=e(u2,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var mx=p(Ss);Zl=e(mx,"SPAN",{class:!0}),p(Zl).forEach(s),mx.forEach(s),Mg=c(u2,"Adding Steps"),u2.forEach(s),Zu=k(n),Ts=e(n,"P",{});var Id=p(Ts);Hg=c(Id,"A reminder of how the problem space is mapped into classes in this app. A Sheet represents a Pool of Opportunities. An Opportunity is a row in the sheet, and it uses the first two columns to the left to display metadata. I have already added CRUD functionality for all of that. To the "),Ql=e(Id,"EM",{});var yx=p(Ql);jg=c(yx,"right"),yx.forEach(s),Fg=c(Id," of those two columns, there should be a sequence of Steps, each taking a cell in the row and growing horizontally, with the least recent at the far right. This is the part which I tackle now. It sounds like it\u2019s going to be a slog, but in fact it\u2019s not that bad. That\u2019s because as a Pool contains an array of Opportunity, an Opportunity contains an array of Steps. So the code is pretty similar. In fact I can pretty much copy and paste it in a new class, adapt it so that it uses columns rather than rows, and that\u2019s about it."),Id.forEach(s),Qu=k(n),qe=e(n,"P",{});var wx=p(qe);Bg=c(wx,"The Step class is not too dissimilar from the Opportunity. Step has a col, which Opportunity doesn\u2019t need. And Opportunity has a list of Steps, which is not needed by Step. Of course the data displayed in the cell is different, but the basic idea is the same. All the basic CRUD functionality (Create, Update, Delete) from Opportunity can be ported to Step without too much trouble. I\u2019ll leave it as an exercise for the reader to adapt that. In future refactor I may look into extracting common feature to a commen parent class or mixin, but now\u2019s not the time."),wx.forEach(s),nk=k(n),_s=e(n,"TABLE",{});var Ad=p(_s);at=e(Ad,"TR",{});var Od=p(at);ni=e(Od,"TH",{});var gx=p(ni);Ng=c(gx,"Opportunity"),gx.forEach(s),qg=k(Od),si=e(Od,"TH",{});var vx=p(si);Ug=c(vx,"Step"),vx.forEach(s),Od.forEach(s),Gg=k(Ad),tt=e(Ad,"TR",{});var Pd=p(tt);ai=e(Pd,"TD",{});var bx=p(ai);Ue=e(bx,"PRE",{class:!0});var S_=p(Ue);S_.forEach(s),bx.forEach(s),Vg=k(Pd),ti=e(Pd,"TD",{});var Ex=p(ti);Ge=e(Ex,"PRE",{class:!0});var T_=p(Ge);T_.forEach(s),Ex.forEach(s),Pd.forEach(s),Ad.forEach(s),sk=k(n),Ve=e(n,"P",{});var xx=p(Ve);Wg=c(xx,"For the record, the updated app menus will look like this"),xx.forEach(s),ak=k(n),et=e(n,"PRE",{class:!0});var __=p(et);__.forEach(s),tk=k(n),Is=e(n,"H4",{id:!0});var k2=p(Is);As=e(k2,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var Sx=p(As);ei=e(Sx,"SPAN",{class:!0}),p(ei).forEach(s),Sx.forEach(s),Yg=c(k2,"Some utility functionality"),k2.forEach(s),ek=k(n),We=e(n,"P",{});var Tx=p(We);Jg=c(Tx,"At this stage I added a couple of useful menu entries which replicate existing functionality: Add Comment. These are similar to Edit Step / Opportunity but only focus on comments. Why? Because when I am talking to someone in a video call or phone, I want to have a larger than normal text box with no distractions. That spurred some refactoring - until now, whenever I edited an instance (of Opportunity, Step) I simply created a new one and replaced it. But now I want to fiddle with individual fields within the objects. I could of course access them directly, but that of course is a big no-no."),Tx.forEach(s),pk=k(n),M=e(n,"P",{});var _t=p(M);zg=c(_t,"I change the generic "),pi=e(_t,"CODE",{});var _x=p(pi);Kg=c(_x,"StructToUIBridge"),_x.forEach(s),$g=c(_t," container to make it easy to locate a specific field by name. After this change, if the fields were "),oi=e(_t,"CODE",{});var Ix=p(oi);Xg=c(Ix,"[{ name: 'mouse', ...}, { name: 'cat', ... }]"),Ix.forEach(s),Zg=c(_t," then fieldNames would contain "),li=e(_t,"CODE",{});var Ax=p(li);Qg=c(Ax,"{ mouse: 0, cat: 1, ...}"),Ax.forEach(s),_t.forEach(s),ok=k(n),pt=e(n,"PRE",{class:!0});var I_=p(pt);I_.forEach(s),lk=k(n),Ye=e(n,"P",{});var Ox=p(Ye);n1=c(Ox,"And then a method to use those keys"),Ox.forEach(s),ik=k(n),ot=e(n,"PRE",{class:!0});var A_=p(ot);A_.forEach(s),ck=k(n),Je=e(n,"P",{});var Px=p(Je);s1=c(Px,"A new form for editing comments for both Opportunity and Step. A variation on the existing forms, bit with only a textarea and two hidden field. If no \u2018row\u2019 value was passed, the hidden input with id \u2018row\u2019 will be removed from the DOM"),Px.forEach(s),rk=k(n),lt=e(n,"PRE",{class:!0});var O_=p(lt);O_.forEach(s),uk=k(n),Os=e(n,"P",{});var Cd=p(Os);a1=c(Cd,"The menu creates two similar entries for editing comments. I had to make sure the names were different - if you have two menu entries with the same name in GAS, the "),ii=e(Cd,"CODE",{});var Cx=p(ii);t1=c(Cx,"onOpen"),Cx.forEach(s),e1=c(Cd," handler will fail silently."),Cd.forEach(s),kk=k(n),it=e(n,"PRE",{class:!0});var P_=p(it);P_.forEach(s),dk=k(n),ze=e(n,"P",{});var Dx=p(ze);p1=c(Dx,"The two functions are very similar, as it\u2019s obvious by putting them side by side. Again, room for refactoring there. But not yet."),Dx.forEach(s),fk=k(n),Ps=e(n,"TABLE",{});var Dd=p(Ps);ct=e(Dd,"TR",{});var Rd=p(ct);ci=e(Rd,"TH",{});var Rx=p(ci);o1=c(Rx,"Opportunity"),Rx.forEach(s),l1=k(Rd),ri=e(Rd,"TH",{});var Lx=p(ri);i1=c(Lx,"Step"),Lx.forEach(s),Rd.forEach(s),c1=k(Dd),rt=e(Dd,"TR",{});var Ld=p(rt);ui=e(Ld,"TD",{});var Mx=p(ui);Ke=e(Mx,"PRE",{class:!0});var C_=p(Ke);C_.forEach(s),Mx.forEach(s),r1=k(Ld),ki=e(Ld,"TD",{});var Hx=p(ki);$e=e(Hx,"PRE",{class:!0});var D_=p($e);D_.forEach(s),Hx.forEach(s),Ld.forEach(s),Dd.forEach(s),hk=k(n),$=e(n,"P",{});var Sp=p($);u1=c(Sp,"Both use "),di=e(Sp,"CODE",{});var jx=p(di);k1=c(jx,"getFieldValue"),jx.forEach(s),d1=c(Sp,", which is a wrapper for "),fi=e(Sp,"CODE",{});var Fx=p(fi);f1=c(Fx,"StructToUIBridge"),Fx.forEach(s),h1=c(Sp,"\u2019s version:"),Sp.forEach(s),mk=k(n),ut=e(n,"PRE",{class:!0});var R_=p(ut);R_.forEach(s),yk=k(n),kt=e(n,"P",{});var d2=p(kt);m1=c(d2,"Both use a modal dialog box instead of a sidebar like in the other cases. That\u2019s because the size of a sidebar is fixed at 300px, whereas a dialog can be changed. Here I use values I have set in "),hi=e(d2,"CODE",{});var Bx=p(hi);y1=c(Bx,"globals.gs"),Bx.forEach(s),d2.forEach(s),wk=k(n),dt=e(n,"PRE",{class:!0});var L_=p(dt);L_.forEach(s),gk=k(n),Xe=e(n,"P",{});var Nx=p(Xe);w1=c(Nx,"Finally the form handler handles both cases. It switches to a Step if it has a row attribute, to Opportunity if it hasn\u2019t"),Nx.forEach(s),vk=k(n),ft=e(n,"PRE",{class:!0});var M_=p(ft);M_.forEach(s),bk=k(n),H=e(n,"P",{});var It=p(H);mi=e(It,"CODE",{});var qx=p(mi);g1=c(qx,"updateFieldsInOpportunity"),qx.forEach(s),v1=c(It," and "),yi=e(It,"CODE",{});var Ux=p(yi);b1=c(Ux,"updateFieldsInStep"),Ux.forEach(s),E1=c(It," are wrappers for "),wi=e(It,"CODE",{});var Gx=p(wi);x1=c(Gx,"StructToUIBridge"),Gx.forEach(s),S1=c(It,"\u2019s method"),It.forEach(s),Ek=k(n),ht=e(n,"PRE",{class:!0});var H_=p(ht);H_.forEach(s),xk=k(n),Ze=e(n,"P",{});var Vx=p(Ze);T1=c(Vx,"And here\u2019s the final result"),Vx.forEach(s),Sk=k(n),Qe=e(n,"P",{});var Wx=p(Qe);j=e(Wx,"VIDEO",{src:!0,title:!0}),p(j).forEach(s),Wx.forEach(s),Tk=k(n),Cs=e(n,"H3",{id:!0});var f2=p(Cs);Ds=e(f2,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var Yx=p(Ds);gi=e(Yx,"SPAN",{class:!0}),p(gi).forEach(s),Yx.forEach(s),_1=c(f2,"States and ordering"),f2.forEach(s),_k=k(n),np=e(n,"P",{});var Jx=p(np);I1=c(Jx,"The CRM is beginning to look good, but it\u2019s missing a very important thing. \u201CThe ability to tell the the phase of an Opportunity at a glance\u201D. The time has come to deal with States."),Jx.forEach(s),Ik=k(n),Rs=e(n,"H4",{id:!0});var h2=p(Rs);Ls=e(h2,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var zx=p(Ls);vi=e(zx,"SPAN",{class:!0}),p(vi).forEach(s),zx.forEach(s),A1=c(h2,"Defining a State"),h2.forEach(s),Ak=k(n),sp=e(n,"P",{});var Kx=p(sp);O1=c(Kx,"States give me a bird view of an Opportunity. Did all the steps so far look promising, what\u2019s the next step. Opportunities do not have States, it\u2019s the individual Steps that make it up who do. The State of an Opportunity is merely the State of the the \u201Ccurrent\u201D Step. More about \u201Ccurrent\u201D Steps later. For now, I will focus on managing States for Steps."),Kx.forEach(s),Ok=k(n),ap=e(n,"P",{});var $x=p(ap);P1=c($x,"Through experimentation, I found that a two levels hierarchical structure works best. I need to know whether a Step is Complete or still Due. Or whether there are issues of some sort and the step needs Attention. Complete, Due, Attention are my top level State Groups, and will be hard coded in the app. They will be used to group Opportunities when ordering. Within each of those groups there are nuances, which I want to capture. For example, Step X is complete. But did it go well or bad? Step Y is simply Due, or Overdue? There are the States proper. The app will encode them as a background / foreground colours pairs. Encoding information with colours is not good for Accessibility. But I am not building an universal app. I am building a little proof of concept for myself."),$x.forEach(s),Pk=k(n),Ms=e(n,"P",{});var Md=p(Ms);C1=c(Md,"The last requirement is the ability to define States without code, just by editing cells in the spreadsheet. To achieve that, the app will be used to store definitions for those states. The string content will be in the form "),bi=e(Md,"CODE",{});var Xx=p(bi);D1=c(Xx,"GROUP / STATE"),Xx.forEach(s),R1=c(Md,", and the app can read the colours from the sheet. The App instance will manage loading up the States from the Sheet."),Md.forEach(s),Ck=k(n),Hs=e(n,"H4",{id:!0});var m2=p(Hs);js=e(m2,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var Zx=p(js);Ei=e(Zx,"SPAN",{class:!0}),p(Ei).forEach(s),Zx.forEach(s),L1=c(m2,"Creating a StatesMgr and loading States lazily"),m2.forEach(s),Dk=k(n),tp=e(n,"P",{});var Qx=p(tp);ep=e(Qx,"IMG",{src:!0,alt:!0}),Qx.forEach(s),Rk=k(n),Fs=e(n,"P",{});var Hd=p(Fs);M1=c(Hd,"A State is a simple value obj. I don\u2019t think I will actually need an "),xi=e(Hd,"CODE",{});var nS=p(xi);H1=c(nS,"order"),nS.forEach(s),j1=c(Hd," attribute, but let\u2019s add it anyway just in case."),Hd.forEach(s),Lk=k(n),mt=e(n,"PRE",{class:!0});var j_=p(mt);j_.forEach(s),Mk=k(n),Bs=e(n,"P",{});var jd=p(Bs);F1=c(jd,"The StatesMgr does all the heavy lifting when it comes to Stages. For now I will add all the states to a "),Si=e(jd,"CODE",{});var sS=p(Si);B1=c(sS,"list"),sS.forEach(s),N1=c(jd," property. The order in which they are found will determine the order in which they are sorted."),jd.forEach(s),Hk=k(n),yt=e(n,"PRE",{class:!0});var F_=p(yt);F_.forEach(s),jk=k(n),Ns=e(n,"P",{});var Fd=p(Ns);q1=c(Fd,"In the original version I would read the background colour with a simple call to "),Ti=e(Fd,"CODE",{});var aS=p(Ti);U1=c(aS,".getBackground"),aS.forEach(s),G1=c(Fd,". But it turns out it\u2019s not so simple. Colours in Google Sheets are either \u201Cnormal\u201D RGB colours, or they are Theme colours. They are both available in the colour picker, there is no way for a user to know which one is which."),Fd.forEach(s),Fk=k(n),pp=e(n,"P",{});var tS=p(pp);op=e(tS,"IMG",{src:!0,alt:!0}),tS.forEach(s),Bk=k(n),qs=e(n,"H4",{id:!0});var y2=p(qs);Us=e(y2,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var eS=p(Us);_i=e(eS,"SPAN",{class:!0}),p(_i).forEach(s),eS.forEach(s),V1=c(y2,"Getting the background and font colour of a Google Sheet cell with Apps Script"),y2.forEach(s),Nk=k(n),Gs=e(n,"P",{});var Bd=p(Gs);W1=c(Bd,"Why does it matter? A Theme colour doesn\u2019t know what it\u2019s RGB value is. If you try you\u2019ll either get an error or an empty string. Instead you\u2019ll have to fetch information from the Theme. A pointless complication IMHO. Even weirder is that if you change the background colour to a theme one, the foreground also becomes a theme colour. Even though it isn\u2019t. Be as it may, I hid that complexity away by creating to utility functions. To get the RGB value of a ThemeColor in Apps Scripts you need to get the Theme, then call its "),Ii=e(Bd,"CODE",{});var pS=p(Ii);Y1=c(pS,"getConcreteColor"),pS.forEach(s),J1=c(Bd," method passing it the label of the ThemeColor. Then once you have the Apps Script representation of the Color Object, it\u2019s treated as if it was a \u201Cnormal\u201D color, i.e. convert to RGB and then Hex. All very unnecessary if you ask me, but it is what it is."),Bd.forEach(s),qk=k(n),wt=e(n,"PRE",{class:!0});var B_=p(wt);B_.forEach(s),Uk=k(n),lp=e(n,"P",{});var oS=p(lp);z1=c(oS,"I can now amend the loadStates function to use those util functions"),oS.forEach(s),Gk=k(n),gt=e(n,"PRE",{class:!0});var N_=p(gt);N_.forEach(s),Vk=k(n),Vs=e(n,"H4",{id:!0});var w2=p(Vs);Ws=e(w2,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var lS=p(Ws);Ai=e(lS,"SPAN",{class:!0}),p(Ai).forEach(s),lS.forEach(s),K1=c(w2,"Creating a global App object in Apps Scripts"),w2.forEach(s),Wk=k(n),ip=e(n,"P",{});var iS=p(ip);$1=c(iS,"\u2026is not possible as far as I can see. Google Sheets is best thought of as a bunch of serverless functions. Your scripts contain the definitions, and your triggers and menus can cause some of them to call each other. But once all the calls are finished\u2026 poof! It\u2019s gone. There is no runtime global environment. Although though there is a global scope in which your variables and deinfitions live. Let\u2019s look at an example"),iS.forEach(s),Yk=k(n),d=e(n,"P",{});var m=p(d);X1=c(m,"When you open the Spreadsheet, "),Oi=e(m,"CODE",{});var cS=p(Oi);Z1=c(cS,"A_CONST"),cS.forEach(s),Q1=c(m,", "),Pi=e(m,"CODE",{});var rS=p(Pi);nv=c(rS,"app"),rS.forEach(s),sv=c(m,", "),Ci=e(m,"CODE",{});var uS=p(Ci);av=c(uS,"App"),uS.forEach(s),tv=c(m,", "),Di=e(m,"CODE",{});var kS=p(Di);ev=c(kS,"test"),kS.forEach(s),pv=c(m," and "),Ri=e(m,"CODE",{});var dS=p(Ri);ov=c(dS,"onOpen"),dS.forEach(s),lv=c(m," all exist within the global scope. Then "),Li=e(m,"CODE",{});var fS=p(Li);iv=c(fS,"onOpen"),fS.forEach(s),cv=c(m," runs (it\u2019s one of the few triggers that does). It creates a menu and an instance of "),Mi=e(m,"CODE",{});var hS=p(Mi);rv=c(hS,"App"),hS.forEach(s),uv=c(m,". Then it completes. After that the menu stays there, but "),Hi=e(m,"CODE",{});var mS=p(Hi);kv=c(mS,"app"),mS.forEach(s),dv=c(m," goes back to \u2018what it was originally\u2019. If you run \u2018What is App?\u2019 from the menu, it will give you \u201Cwhat it was originally\u201D"),m.forEach(s),Jk=k(n),vt=e(n,"PRE",{class:!0});var q_=p(vt);q_.forEach(s),zk=k(n),Ys=e(n,"P",{});var Nd=p(Ys);fv=c(Nd,"So how does one create a global singleton? One way is to create a getter function that lazily instantiates the class, when needed. Throughout the code, you will use "),ji=e(Nd,"CODE",{});var yS=p(ji);hv=c(yS,"getApp()"),yS.forEach(s),mv=c(Nd," to access the global App instance"),Nd.forEach(s),Kk=k(n),bt=e(n,"PRE",{class:!0});var U_=p(bt);U_.forEach(s),$k=k(n),X=e(n,"P",{});var Tp=p(X);yv=c(Tp,"With that out of the way, I can now concentrate on the States. I will actually use the same pattern to lazily instantiate the StatesMgr. I don\u2019t often use getters in JS, but when I do is usually for lazy evaluation. "),Fi=e(Tp,"CODE",{});var wS=p(Fi);wv=c(wS,"get states"),wS.forEach(s),gv=c(Tp," will return "),Bi=e(Tp,"CODE",{});var gS=p(Bi);vv=c(gS,"states_"),gS.forEach(s),bv=c(Tp,", and will create it if it doesn\u2019t exist."),Tp.forEach(s),Xk=k(n),Et=e(n,"PRE",{class:!0});var G_=p(Et);G_.forEach(s),Zk=k(n),cp=e(n,"P",{});var vS=p(cp);Ev=c(vS,"To test it all works I create a quick menu entry"),vS.forEach(s),Qk=k(n),xt=e(n,"PRE",{class:!0});var V_=p(xt);V_.forEach(s),nd=k(n),rp=e(n,"P",{});var bS=p(rp);xv=c(bS,"I run it, check in the \u201Cexecutions\u201D tab in the Script editor\u2026 and the states are logged there. So far so good."),bS.forEach(s),sd=k(n),up=e(n,"P",{});var ES=p(up);Sv=c(ES,"Now it is just a matter of adding a new state property to each Step, and reading it when loading the data from the sheet"),ES.forEach(s),ad=k(n),Js=e(n,"H3",{id:!0});var g2=p(Js);zs=e(g2,"A",{"aria-hidden":!0,tabindex:!0,href:!0});var xS=p(zs);Ni=e(xS,"SPAN",{class:!0}),p(Ni).forEach(s),xS.forEach(s),Tv=c(g2,"Conclusion and potential next steps"),g2.forEach(s),td=k(n),kp=e(n,"P",{});var SS=p(kp);_v=c(SS,"I have used this app for a while and does the job quite well, with a minimum of fuss. And what is more, it was usable from day 1 - with a lot of manual data entry at the beginning, which became less and less as I automated more and more steps. Obviously it\u2019s not as slick as a SPA put together by a team of UX and FE devs, but then it costed rather less in term of efforts. I find Google Apps Script great for knocking together quick prototypes like this."),SS.forEach(s),ed=k(n),dp=e(n,"P",{});var TS=p(dp);Iv=c(TS,"I am not going to take this any further as my basic needs are met. But should I want to, it would be possible, for example to"),TS.forEach(s),pd=k(n),Z=e(n,"UL",{});var _p=p(Z);qi=e(_p,"LI",{});var _S=p(qi);Av=c(_S,"integrate with email to automatically generate steps from incoming messages, or generate emails from steps"),_S.forEach(s),Ov=k(_p),Ui=e(_p,"LI",{});var IS=p(Ui);Pv=c(IS,"integrate with calendar to generate appointments and set reminders"),IS.forEach(s),Cv=k(_p),Gi=e(_p,"LI",{});var AS=p(Gi);Dv=c(AS,"all of the above, to automatically generate emails with a list of available slots from my calendar."),AS.forEach(s),_p.forEach(s),od=k(n),fp=e(n,"P",{});var OS=p(fp);Rv=c(OS,"This would actually be quite useful, and who knows, I may well tackle it one of these days."),OS.forEach(s),ld=k(n),St=e(n,"PRE",{class:!0});var W_=p(St);W_.forEach(s),id=k(n),Tt=e(n,"PRE",{class:!0});var Y_=p(Tt);Y_.forEach(s),this.h()},h(){r(Ip,"class","icon icon-link"),r(en,"aria-hidden","true"),r(en,"tabindex","-1"),r(en,"href","#need-a-crm-why-not-just-use-"),r(N,"id","need-a-crm-why-not-just-use-"),r(ea,"href","https://capsulecrm.com/"),r(ea,"rel","nofollow"),r(Pp,"class","icon icon-link"),r(on,"aria-hidden","true"),r(on,"tabindex","-1"),r(on,"href","#google-sheets-with-apps-script-is-a-great-tool-for-quick-tools-and-prototypes"),r(pn,"id","google-sheets-with-apps-script-is-a-great-tool-for-quick-tools-and-prototypes"),r(Cp,"class","icon icon-link"),r(cn,"aria-hidden","true"),r(cn,"tabindex","-1"),r(cn,"href","#tips-on-using-google-apps-script-for-prototyping"),r(ln,"id","tips-on-using-google-apps-script-for-prototyping"),r(Dp,"class","icon icon-link"),r(un,"aria-hidden","true"),r(un,"tabindex","-1"),r(un,"href","#1-explicit-interactions-vs-trying-to-build-a-spa"),r(rn,"id","1-explicit-interactions-vs-trying-to-build-a-spa"),r(Pt,"title","Single Page Application"),r(qp,"class","icon icon-link"),r(hn,"aria-hidden","true"),r(hn,"tabindex","-1"),r(hn,"href","#2-minimal-work"),r(fn,"id","2-minimal-work"),r(Up,"class","icon icon-link"),r(yn,"aria-hidden","true"),r(yn,"tabindex","-1"),r(yn,"href","#2-resist-the-temptation-to-start-coding-straight-away"),r(mn,"id","2-resist-the-temptation-to-start-coding-straight-away"),r(oa,"href","https://www.natechplastics.com/four-stages-of-lean-product-development/"),r(oa,"rel","nofollow"),r(Vp,"class","icon icon-link"),r(gn,"aria-hidden","true"),r(gn,"tabindex","-1"),r(gn,"href","#3-model-your-problem-space-first"),r(wn,"id","3-model-your-problem-space-first"),r(Dt,"title","Object Oriented Programming"),r(Wp,"class","icon icon-link"),r(En,"aria-hidden","true"),r(En,"tabindex","-1"),r(En,"href","#4-oop-is-actually-quite-helpful-but-there-is-a-place-for-some-fp-too"),r(bn,"id","4-oop-is-actually-quite-helpful-but-there-is-a-place-for-some-fp-too"),r(Kp,"class","icon icon-link"),r(Tn,"aria-hidden","true"),r(Tn,"tabindex","-1"),r(Tn,"href","#5-testing-is-not-a-solved-problem"),r(Sn,"id","5-testing-is-not-a-solved-problem"),r($p,"class","icon icon-link"),r(In,"aria-hidden","true"),r(In,"tabindex","-1"),r(In,"href","#6-always-save-your-co-ordinates-rows-cells-in-constants"),r(_n,"id","6-always-save-your-co-ordinates-rows-cells-in-constants"),r(Xp,"class","icon icon-link"),r(On,"aria-hidden","true"),r(On,"tabindex","-1"),r(On,"href","#7-use-sidebars-to-enter-data"),r(An,"id","7-use-sidebars-to-enter-data"),r(la,"href","https://developers.google.com/apps-script/guides/dialogs"),r(la,"rel","nofollow"),r(Zp,"class","icon icon-link"),r(Cn,"aria-hidden","true"),r(Cn,"tabindex","-1"),r(Cn,"href","#8-beware-of-data-conversions"),r(Pn,"id","8-beware-of-data-conversions"),r(Qp,"class","icon icon-link"),r(Rn,"aria-hidden","true"),r(Rn,"tabindex","-1"),r(Rn,"href","#script-structure"),r(Dn,"id","script-structure"),g(Bt.src,b2=$_)||r(Bt,"src",b2),r(Bt,"alt","My standard Google Apps Script file structure"),g(qt.src,E2="/posts/blog/trello-like-crm-tool-with-google-apps-script/debug.png")||r(qt,"src",E2),r(qt,"alt","Running functions with debugger"),r(y,"class","code-breakdown"),r(ho,"class","icon icon-link"),r(Hn,"aria-hidden","true"),r(Hn,"tabindex","-1"),r(Hn,"href","#designing-a-crm-app"),r(Mn,"id","designing-a-crm-app"),r(mo,"class","icon icon-link"),r(Fn,"aria-hidden","true"),r(Fn,"tabindex","-1"),r(Fn,"href","#step-1-defining-the-problem"),r(jn,"id","step-1-defining-the-problem"),r(Oo,"class","icon icon-link"),r(qn,"aria-hidden","true"),r(qn,"tabindex","-1"),r(qn,"href","#state"),r(Nn,"id","state"),g(Yt.src,x2=X_)||r(Yt,"src",x2),r(Yt,"alt","A list of States"),r(Po,"class","icon icon-link"),r(Gn,"aria-hidden","true"),r(Gn,"tabindex","-1"),r(Gn,"href","#step"),r(Un,"id","step"),g(Kt.src,S2=Z_)||r(Kt,"src",S2),r(Kt,"alt","A Step"),r(Lo,"class","icon icon-link"),r(Wn,"aria-hidden","true"),r(Wn,"tabindex","-1"),r(Wn,"href","#opportunity"),r(Vn,"id","opportunity"),g(Qt.src,T2=Q_)||r(Qt,"src",T2),r(Qt,"alt","An Opportunity"),r(Bo,"class","icon icon-link"),r(Jn,"aria-hidden","true"),r(Jn,"tabindex","-1"),r(Jn,"href","#pools"),r(Yn,"id","pools"),g(ee.src,_2=nI)||r(ee,"src",_2),r(ee,"alt","A pool"),r(Vo,"class","icon icon-link"),r(Kn,"aria-hidden","true"),r(Kn,"tabindex","-1"),r(Kn,"href","#app"),r(zn,"id","app"),r(nl,"class","icon icon-link"),r(Xn,"aria-hidden","true"),r(Xn,"tabindex","-1"),r(Xn,"href","#step-2-iterating-without-programming-to-reach-an-initial-mvp"),r($n,"id","step-2-iterating-without-programming-to-reach-an-initial-mvp"),g(ue.src,I2=sI)||r(ue,"src",I2),r(ue,"alt","Initial sheet"),r(sl,"class","icon icon-link"),r(Qn,"aria-hidden","true"),r(Qn,"tabindex","-1"),r(Qn,"href","#step-3-setup-and-menu"),r(Zn,"id","step-3-setup-and-menu"),r(ra,"class","language-js"),r(ua,"class","language-js"),g(fe.src,A2=aI)||r(fe,"src",A2),r(fe,"alt","The initial menu, with placeholders"),r(ll,"class","icon icon-link"),r(ss,"aria-hidden","true"),r(ss,"tabindex","-1"),r(ss,"href","#step-4-creating-opportunity"),r(ns,"id","step-4-creating-opportunity"),r(ka,"class","language-diff"),r(da,"class","language-js"),r(fa,"class","language-js"),r(ha,"class","language-js"),r(ma,"class","language-diff"),r(ya,"class","language-diff"),r(wa,"class","language-diff"),r(va,"href","https://en.wikipedia.org/wiki/Fail-fast"),r(va,"rel","nofollow"),r(ba,"class","language-js"),r(kl,"class","icon icon-link"),r(ps,"aria-hidden","true"),r(ps,"tabindex","-1"),r(ps,"href","#5-using-an-html-form-in-a-sidebar-to-create-an-opportunity"),r(es,"id","5-using-an-html-form-in-a-sidebar-to-create-an-opportunity"),g(R.src,O2=lI)||r(R,"src",O2),R.autoplay=!0,R.muted=!0,R.playsInline=!0,R.loop=!0,r(R,"title","Adding an Opportunity with a form"),g(xe.src,P2=tI)||r(xe,"src",P2),r(xe,"alt","An HTML sidebar in a Google Sheet"),r(Ea,"href","https://www.the-art-of-web.com/html/html5-form-validation/"),r(Ea,"rel","nofollow"),r(xa,"href","https://developers.google.com/apps-script/guides/html/best-practices#separate_html_css_and_javascript"),r(xa,"rel","nofollow"),r(Sa,"class","language-html"),r(Ta,"class","language-diff"),r(_a,"class","language-diff"),r(Ia,"class","language-js"),r(Aa,"class","language-diff"),r(Oa,"href","https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals#tagged_templates"),r(Oa,"rel","nofollow"),r(Pa,"class","language-js"),r(Ca,"class","language-js"),r(Da,"class","language-diff"),r(Ra,"class","language-diff"),r(La,"class","language-diff"),r(Ma,"class","language-diff"),r(ja,"class","language-js"),r(Dl,"class","icon icon-link"),r(us,"aria-hidden","true"),r(us,"tabindex","-1"),r(us,"href","#loading-the-state-of-the-app-from-the-spreadsheet"),r(rs,"id","loading-the-state-of-the-app-from-the-spreadsheet"),r(Fa,"class","language-js"),r(Ba,"class","language-diff"),r(Na,"class","language-js"),r(qa,"class","language-js"),g(L.src,C2=iI)||r(L,"src",C2),L.autoplay=!0,L.muted=!0,L.playsInline=!0,L.loop=!0,r(L,"title","Demonstrating that now when I add a field, the previous ones stay there"),r(Fl,"class","icon icon-link"),r(hs,"aria-hidden","true"),r(hs,"tabindex","-1"),r(hs,"href","#editing-an-opportunity"),r(fs,"id","editing-an-opportunity"),r(Ul,"class","icon icon-link"),r(ys,"aria-hidden","true"),r(ys,"tabindex","-1"),r(ys,"href","#injecting-data-into-an-htmlhtmlservice-form-in-a-sidebar-with-apps-script"),r(ms,"id","injecting-data-into-an-htmlhtmlservice-form-in-a-sidebar-with-apps-script"),r(Ua,"class","language-diff"),r(Ga,"class","language-js"),r(Va,"class","language-diff"),g(Le.src,D2=eI)||r(Le,"src",D2),r(Le,"alt","Select a row to edit an Opportunity"),r(Wa,"class","language-diff"),r(Ya,"class","language-js"),r(Ja,"class","language-js"),r(za,"class","language-js"),r(Ka,"class","language-diff"),r($a,"class","language-diff"),r(Xa,"class","language-diff"),r(Za,"class","language-js"),r(zl,"class","icon icon-link"),r(Es,"aria-hidden","true"),r(Es,"tabindex","-1"),r(Es,"href","#deleting-an-opportunity"),r(bs,"id","deleting-an-opportunity"),r(Qa,"class","language-js"),r(st,"class","language-js"),r(Zl,"class","icon icon-link"),r(Ss,"aria-hidden","true"),r(Ss,"tabindex","-1"),r(Ss,"href","#adding-steps"),r(xs,"id","adding-steps"),r(Ue,"class","language-diff"),r(Ge,"class","language-diff"),r(et,"class","language-diff"),r(ei,"class","icon icon-link"),r(As,"aria-hidden","true"),r(As,"tabindex","-1"),r(As,"href","#some-utility-functionality"),r(Is,"id","some-utility-functionality"),r(pt,"class","language-diff"),r(ot,"class","language-js"),r(lt,"class","language-html"),r(it,"class","language-diff"),r(Ke,"class","language-diff"),r($e,"class","language-diff"),r(ut,"class","language-js"),r(dt,"class","language-js"),r(ft,"class","language-js"),r(ht,"class","language-js"),g(j.src,R2=cI)||r(j,"src",R2),j.autoplay=!0,j.muted=!0,j.playsInline=!0,j.loop=!0,r(j,"title","Editing comments for both Opportunity and Step"),r(gi,"class","icon icon-link"),r(Ds,"aria-hidden","true"),r(Ds,"tabindex","-1"),r(Ds,"href","#states-and-ordering"),r(Cs,"id","states-and-ordering"),r(vi,"class","icon icon-link"),r(Ls,"aria-hidden","true"),r(Ls,"tabindex","-1"),r(Ls,"href","#defining-a-state"),r(Rs,"id","defining-a-state"),r(Ei,"class","icon icon-link"),r(js,"aria-hidden","true"),r(js,"tabindex","-1"),r(js,"href","#creating-a-statesmgr-and-loading-states-lazily"),r(Hs,"id","creating-a-statesmgr-and-loading-states-lazily"),g(ep.src,L2=pI)||r(ep,"src",L2),r(ep,"alt","An example of States definitions in the top row"),r(mt,"class","language-js"),r(yt,"class","language-js"),g(op.src,M2=oI)||r(op,"src",M2),r(op,"alt","The Google Sheets colour picker"),r(_i,"class","icon icon-link"),r(Us,"aria-hidden","true"),r(Us,"tabindex","-1"),r(Us,"href","#getting-the-background-and-font-colour-of-a-google-sheet-cell-with-apps-script"),r(qs,"id","getting-the-background-and-font-colour-of-a-google-sheet-cell-with-apps-script"),r(wt,"class","language-js"),r(gt,"class","language-diff"),r(Ai,"class","icon icon-link"),r(Ws,"aria-hidden","true"),r(Ws,"tabindex","-1"),r(Ws,"href","#creating-a-global-app-object-in-apps-scripts"),r(Vs,"id","creating-a-global-app-object-in-apps-scripts"),r(vt,"class","language-js"),r(bt,"class","language-js"),r(Et,"class","language-js"),r(xt,"class","language-diff"),r(Ni,"class","icon icon-link"),r(zs,"aria-hidden","true"),r(zs,"tabindex","-1"),r(zs,"href","#conclusion-and-potential-next-steps"),r(Js,"id","conclusion-and-potential-next-steps"),r(St,"class","language-undefined"),r(Tt,"class","language-undefined")},m(n,o){l(n,N,o),a(N,en),a(en,Ip),a(N,qd),l(n,zi,o),l(n,sn,o),a(sn,Ap),a(Ap,Ud),a(sn,Gd),a(sn,ea),a(ea,Vd),a(sn,Wd),l(n,Ki,o),l(n,pa,o),a(pa,Op),a(Op,Yd),a(pa,Jd),l(n,$i,o),l(n,pn,o),a(pn,on),a(on,Pp),a(pn,zd),l(n,Xi,o),l(n,At,o),a(At,Kd),l(n,Zi,o),l(n,ln,o),a(ln,cn),a(cn,Cp),a(ln,$d),l(n,Qi,o),l(n,Ot,o),a(Ot,Xd),l(n,nc,o),l(n,rn,o),a(rn,un),a(un,Dp),a(rn,Zd),l(n,sc,o),l(n,kn,o),a(kn,Qd),a(kn,Pt),a(Pt,nf),a(kn,sf),l(n,ac,o),l(n,dn,o),a(dn,af),a(dn,Rp),a(Rp,tf),a(dn,ef),l(n,tc,o),l(n,h,o),a(h,Lp),a(Lp,pf),a(h,of),a(h,Mp),a(Mp,lf),a(h,cf),a(h,Hp),a(Hp,rf),a(h,uf),a(h,jp),a(jp,kf),a(h,df),a(h,Fp),a(Fp,ff),a(h,hf),a(h,Bp),a(Bp,mf),a(h,yf),a(h,Np),a(Np,wf),l(n,ec,o),l(n,fn,o),a(fn,hn),a(hn,qp),a(fn,gf),l(n,pc,o),l(n,mn,o),a(mn,yn),a(yn,Up),a(mn,vf),l(n,oc,o),l(n,q,o),a(q,bf),a(q,Gp),a(Gp,Ef),a(q,xf),a(q,oa),a(oa,Sf),a(q,Tf),l(n,lc,o),l(n,wn,o),a(wn,gn),a(gn,Vp),a(wn,_f),l(n,ic,o),l(n,Ct,o),a(Ct,If),l(n,cc,o),l(n,vn,o),a(vn,Af),a(vn,Dt),a(Dt,Of),a(vn,Pf),l(n,rc,o),l(n,Rt,o),a(Rt,Cf),l(n,uc,o),l(n,bn,o),a(bn,En),a(En,Wp),a(bn,Df),l(n,kc,o),l(n,U,o),a(U,Rf),a(U,Yp),a(Yp,Lf),a(U,Mf),a(U,Jp),a(Jp,Hf),a(U,jf),l(n,dc,o),l(n,xn,o),a(xn,Ff),a(xn,zp),a(zp,Bf),a(xn,Nf),l(n,fc,o),l(n,Sn,o),a(Sn,Tn),a(Tn,Kp),a(Sn,qf),l(n,hc,o),l(n,Lt,o),a(Lt,Uf),l(n,mc,o),l(n,_n,o),a(_n,In),a(In,$p),a(_n,Gf),l(n,yc,o),l(n,Mt,o),a(Mt,Vf),l(n,wc,o),l(n,An,o),a(An,On),a(On,Xp),a(An,Wf),l(n,gc,o),l(n,Ht,o),a(Ht,la),a(la,Yf),l(n,vc,o),l(n,Pn,o),a(Pn,Cn),a(Cn,Zp),a(Pn,Jf),l(n,bc,o),l(n,jt,o),a(jt,zf),l(n,Ec,o),l(n,Dn,o),a(Dn,Rn),a(Rn,Qp),a(Dn,Kf),l(n,xc,o),l(n,Ft,o),a(Ft,Bt),l(n,Sc,o),l(n,Nt,o),a(Nt,$f),l(n,Tc,o),l(n,y,o),a(y,no),a(no,Xf),a(y,v),a(v,Zf),a(v,so),a(so,Qf),a(v,nh),a(v,ao),a(ao,sh),a(v,ah),a(v,to),a(to,th),a(v,eh),a(v,eo),a(eo,ph),a(v,oh),a(v,qt),a(y,po),a(po,lh),a(y,Ln),a(Ln,ih),a(Ln,oo),a(oo,ch),a(Ln,rh),a(Ln,lo),a(lo,uh),a(y,io),a(io,kh),a(y,ia),a(ia,dh),a(ia,co),a(co,fh),a(ia,hh),a(y,ro),a(ro,mh),a(y,uo),a(uo,yh),a(y,ko),a(ko,wh),a(y,fo),a(fo,gh),l(n,_c,o),l(n,Mn,o),a(Mn,Hn),a(Hn,ho),a(Mn,vh),l(n,Ic,o),l(n,jn,o),a(jn,Fn),a(Fn,mo),a(jn,bh),l(n,Ac,o),l(n,Ut,o),a(Ut,Eh),l(n,Oc,o),l(n,Bn,o),a(Bn,x),a(x,xh),a(x,yo),a(yo,Sh),a(x,Th),a(x,wo),a(wo,_h),a(x,Ih),a(x,go),a(go,Ah),a(x,Oh),a(x,vo),a(vo,Ph),a(x,Ch),a(Bn,Dh),a(Bn,bo),a(bo,Rh),l(n,Pc,o),l(n,f,o),a(f,Lh),a(f,Eo),a(Eo,Mh),a(f,Hh),a(f,xo),a(xo,jh),a(f,Fh),a(f,So),a(So,Bh),a(f,Nh),a(f,To),a(To,qh),a(f,Uh),a(f,_o),a(_o,Gh),a(f,Vh),a(f,Io),a(Io,Wh),a(f,Yh),a(f,Ao),a(Ao,Jh),a(f,zh),l(n,Cc,o),l(n,Gt,o),a(Gt,Kh),l(n,Dc,o),l(n,Vt,o),a(Vt,$h),l(n,Rc,o),l(n,Nn,o),a(Nn,qn),a(qn,Oo),a(Nn,Xh),l(n,Lc,o),l(n,Wt,o),a(Wt,Yt),l(n,Mc,o),l(n,Jt,o),a(Jt,Zh),l(n,Hc,o),l(n,Un,o),a(Un,Gn),a(Gn,Po),a(Un,Qh),l(n,jc,o),l(n,zt,o),a(zt,Kt),l(n,Fc,o),l(n,$t,o),a($t,nm),l(n,Bc,o),l(n,Xt,o),a(Xt,sm),l(n,Nc,o),l(n,G,o),a(G,Co),a(Co,am),a(G,tm),a(G,Do),a(Do,em),a(G,pm),a(G,Ro),a(Ro,om),l(n,qc,o),l(n,Vn,o),a(Vn,Wn),a(Wn,Lo),a(Vn,lm),l(n,Uc,o),l(n,Zt,o),a(Zt,Qt),l(n,Gc,o),l(n,ne,o),a(ne,im),l(n,Vc,o),l(n,se,o),a(se,cm),l(n,Wc,o),l(n,ae,o),a(ae,rm),l(n,Yc,o),l(n,S,o),a(S,Mo),a(Mo,um),a(S,km),a(S,Ho),a(Ho,dm),a(S,fm),a(S,jo),a(jo,hm),a(S,mm),a(S,Fo),a(Fo,ym),l(n,Jc,o),l(n,Yn,o),a(Yn,Jn),a(Jn,Bo),a(Yn,wm),l(n,zc,o),l(n,te,o),a(te,ee),l(n,Kc,o),l(n,pe,o),a(pe,gm),l(n,$c,o),l(n,oe,o),a(oe,vm),l(n,Xc,o),l(n,T,o),a(T,No),a(No,bm),a(T,Em),a(T,qo),a(qo,xm),a(T,Sm),a(T,Uo),a(Uo,Tm),a(T,_m),a(T,Go),a(Go,Im),l(n,Zc,o),l(n,zn,o),a(zn,Kn),a(Kn,Vo),a(zn,Am),l(n,Qc,o),l(n,le,o),a(le,Om),l(n,nr,o),l(n,b,o),a(b,ca),a(ca,Pm),a(ca,Wo),a(Wo,Cm),a(ca,Dm),a(b,Rm),a(b,Yo),a(Yo,Lm),a(b,Mm),a(b,Jo),a(Jo,Hm),a(b,jm),a(b,zo),a(zo,Fm),a(b,Bm),a(b,Ko),a(Ko,Nm),l(n,sr,o),l(n,ie,o),a(ie,qm),l(n,ar,o),l(n,_,o),a(_,$o),a($o,Um),a(_,Gm),a(_,Xo),a(Xo,Vm),a(_,Wm),a(_,Zo),a(Zo,Ym),a(_,Jm),a(_,Qo),a(Qo,zm),l(n,tr,o),l(n,$n,o),a($n,Xn),a(Xn,nl),a($n,Km),l(n,er,o),l(n,ce,o),a(ce,$m),l(n,pr,o),l(n,re,o),a(re,ue),l(n,or,o),l(n,Zn,o),a(Zn,Qn),a(Qn,sl),a(Zn,Xm),l(n,lr,o),l(n,ke,o),a(ke,D),a(D,Zm),a(D,al),a(al,Qm),a(D,ny),a(D,tl),a(tl,sy),a(D,ay),a(D,el),a(el,ty),a(D,ey),l(n,ir,o),l(n,ra,o),ra.innerHTML=CS,l(n,cr,o),l(n,an,o),a(an,pl),a(pl,py),a(an,oy),a(an,ol),a(ol,ly),a(an,iy),l(n,rr,o),l(n,ua,o),ua.innerHTML=DS,l(n,ur,o),l(n,de,o),a(de,fe),l(n,kr,o),l(n,ns,o),a(ns,ss),a(ss,ll),a(ns,cy),l(n,dr,o),l(n,he,o),a(he,ry),l(n,fr,o),l(n,ka,o),ka.innerHTML=RS,l(n,hr,o),l(n,me,o),a(me,uy),l(n,mr,o),l(n,ye,o),a(ye,ky),l(n,yr,o),l(n,da,o),da.innerHTML=LS,l(n,wr,o),l(n,we,o),a(we,dy),l(n,gr,o),l(n,fa,o),fa.innerHTML=MS,l(n,vr,o),l(n,ge,o),a(ge,fy),l(n,br,o),l(n,ha,o),ha.innerHTML=HS,l(n,Er,o),l(n,V,o),a(V,hy),a(V,il),a(il,my),a(V,yy),a(V,cl),a(cl,wy),a(V,gy),l(n,xr,o),l(n,ve,o),a(ve,vy),l(n,Sr,o),l(n,ma,o),ma.innerHTML=jS,l(n,Tr,o),l(n,as,o),a(as,by),a(as,rl),a(rl,Ey),a(as,xy),l(n,_r,o),l(n,ya,o),ya.innerHTML=FS,l(n,Ir,o),l(n,ts,o),a(ts,Sy),a(ts,ul),a(ul,Ty),a(ts,_y),l(n,Ar,o),l(n,wa,o),wa.innerHTML=BS,l(n,Or,o),l(n,ga,o),a(ga,Iy),a(ga,va),a(va,Ay),l(n,Pr,o),l(n,ba,o),ba.innerHTML=NS,l(n,Cr,o),l(n,es,o),a(es,ps),a(ps,kl),a(es,Oy),l(n,Dr,o),l(n,be,o),a(be,R),l(n,Rr,o),l(n,os,o),a(os,Py),a(os,dl),a(dl,Cy),a(os,Dy),l(n,Lr,o),l(n,Ee,o),a(Ee,xe),l(n,Mr,o),l(n,W,o),a(W,Ry),a(W,Ea),a(Ea,Ly),a(W,My),a(W,xa),a(xa,Hy),a(W,jy),l(n,Hr,o),l(n,Sa,o),Sa.innerHTML=qS,l(n,jr,o),l(n,I,o),a(I,Fy),a(I,fl),a(fl,By),a(I,Ny),a(I,hl),a(hl,qy),a(I,Uy),a(I,ml),a(ml,Gy),a(I,Vy),l(n,Fr,o),l(n,tn,o),a(tn,yl),a(yl,Wy),a(tn,Yy),a(tn,wl),a(wl,Jy),a(tn,zy),l(n,Br,o),l(n,Ta,o),Ta.innerHTML=US,l(n,Nr,o),l(n,Se,o),a(Se,Ky),l(n,qr,o),l(n,_a,o),_a.innerHTML=GS,l(n,Ur,o),l(n,Y,o),a(Y,$y),a(Y,gl),a(gl,Xy),a(Y,Zy),a(Y,vl),a(vl,Qy),a(Y,nw),l(n,Gr,o),l(n,Ia,o),Ia.innerHTML=VS,l(n,Vr,o),l(n,Aa,o),Aa.innerHTML=WS,l(n,Wr,o),l(n,ls,o),a(ls,sw),a(ls,bl),a(bl,aw),a(ls,tw),l(n,Yr,o),l(n,is,o),a(is,ew),a(is,Oa),a(Oa,pw),a(is,ow),l(n,Jr,o),l(n,Te,o),a(Te,lw),l(n,zr,o),l(n,Pa,o),Pa.innerHTML=YS,l(n,Kr,o),l(n,J,o),a(J,iw),a(J,El),a(El,cw),a(J,rw),a(J,xl),a(xl,uw),a(J,kw),l(n,$r,o),l(n,Ca,o),Ca.innerHTML=JS,l(n,Xr,o),l(n,cs,o),a(cs,dw),a(cs,Sl),a(Sl,fw),a(cs,hw),l(n,Zr,o),l(n,Da,o),Da.innerHTML=zS,l(n,Qr,o),l(n,A,o),a(A,mw),a(A,Tl),a(Tl,yw),a(A,ww),a(A,_l),a(_l,gw),a(A,vw),a(A,Il),a(Il,bw),a(A,Ew),l(n,nu,o),l(n,Ra,o),Ra.innerHTML=KS,l(n,su,o),l(n,O,o),a(O,xw),a(O,Al),a(Al,Sw),a(O,Tw),a(O,Ol),a(Ol,_w),a(O,Iw),a(O,Pl),a(Pl,Aw),a(O,Ow),l(n,au,o),l(n,La,o),La.innerHTML=$S,l(n,tu,o),l(n,_e,o),a(_e,Pw),l(n,eu,o),l(n,Ma,o),Ma.innerHTML=XS,l(n,pu,o),l(n,Ha,o),a(Ha,Cl),a(Cl,Cw),a(Ha,Dw),l(n,ou,o),l(n,ja,o),ja.innerHTML=ZS,l(n,lu,o),l(n,rs,o),a(rs,us),a(us,Dl),a(rs,Rw),l(n,iu,o),l(n,ks,o),a(ks,Lw),a(ks,Rl),a(Rl,Mw),a(ks,Hw),l(n,cu,o),l(n,Fa,o),Fa.innerHTML=QS,l(n,ru,o),l(n,Ie,o),a(Ie,jw),l(n,uu,o),l(n,Ae,o),a(Ae,Fw),l(n,ku,o),l(n,Ba,o),Ba.innerHTML=nT,l(n,du,o),l(n,P,o),a(P,Bw),a(P,Ll),a(Ll,Nw),a(P,qw),a(P,Ml),a(Ml,Uw),a(P,Gw),a(P,Hl),a(Hl,Vw),a(P,Ww),l(n,fu,o),l(n,Na,o),Na.innerHTML=sT,l(n,hu,o),l(n,ds,o),a(ds,Yw),a(ds,jl),a(jl,Jw),a(ds,zw),l(n,mu,o),l(n,qa,o),qa.innerHTML=aT,l(n,yu,o),l(n,Oe,o),a(Oe,Kw),l(n,wu,o),l(n,Pe,o),a(Pe,L),l(n,gu,o),l(n,fs,o),a(fs,hs),a(hs,Fl),a(fs,$w),l(n,vu,o),l(n,C,o),a(C,Xw),a(C,Bl),a(Bl,Zw),a(C,Qw),a(C,Nl),a(Nl,ng),a(C,sg),a(C,ql),a(ql,ag),a(C,tg),l(n,bu,o),l(n,ms,o),a(ms,ys),a(ys,Ul),a(ms,eg),l(n,Eu,o),l(n,ws,o),a(ws,pg),a(ws,Gl),a(Gl,og),a(ws,lg),l(n,xu,o),l(n,gs,o),a(gs,ig),a(gs,Vl),a(Vl,cg),a(gs,rg),l(n,Su,o),l(n,Ua,o),Ua.innerHTML=tT,l(n,Tu,o),l(n,z,o),a(z,ug),a(z,Wl),a(Wl,kg),a(z,dg),a(z,Yl),a(Yl,fg),a(z,hg),l(n,_u,o),l(n,Ga,o),Ga.innerHTML=eT,l(n,Iu,o),l(n,Ce,o),a(Ce,mg),l(n,Au,o),l(n,Va,o),Va.innerHTML=pT,l(n,Ou,o),l(n,De,o),a(De,yg),l(n,Pu,o),l(n,Re,o),a(Re,Le),l(n,Cu,o),l(n,Me,o),a(Me,wg),l(n,Du,o),l(n,Wa,o),Wa.innerHTML=oT,l(n,Ru,o),l(n,He,o),a(He,gg),l(n,Lu,o),l(n,Ya,o),Ya.innerHTML=lT,l(n,Mu,o),l(n,vs,o),a(vs,vg),a(vs,Jl),a(Jl,bg),a(vs,Eg),l(n,Hu,o),l(n,Ja,o),Ja.innerHTML=iT,l(n,ju,o),l(n,je,o),a(je,xg),l(n,Fu,o),l(n,za,o),za.innerHTML=cT,l(n,Bu,o),l(n,Ka,o),Ka.innerHTML=rT,l(n,Nu,o),l(n,Fe,o),a(Fe,Sg),l(n,qu,o),l(n,$a,o),$a.innerHTML=uT,l(n,Uu,o),l(n,Be,o),a(Be,Tg),l(n,Gu,o),l(n,Xa,o),Xa.innerHTML=kT,l(n,Vu,o),l(n,Ne,o),a(Ne,_g),l(n,Wu,o),l(n,Za,o),Za.innerHTML=dT,l(n,Yu,o),l(n,bs,o),a(bs,Es),a(Es,zl),a(bs,Ig),l(n,Ju,o),l(n,K,o),a(K,Ag),a(K,Kl),a(Kl,Og),a(K,Pg),a(K,$l),a($l,Cg),a(K,Dg),l(n,zu,o),l(n,Qa,o),Qa.innerHTML=fT,l(n,Ku,o),l(n,nt,o),a(nt,Xl),a(Xl,Rg),a(nt,Lg),l(n,$u,o),l(n,st,o),st.innerHTML=hT,l(n,Xu,o),l(n,xs,o),a(xs,Ss),a(Ss,Zl),a(xs,Mg),l(n,Zu,o),l(n,Ts,o),a(Ts,Hg),a(Ts,Ql),a(Ql,jg),a(Ts,Fg),l(n,Qu,o),l(n,qe,o),a(qe,Bg),l(n,nk,o),l(n,_s,o),a(_s,at),a(at,ni),a(ni,Ng),a(at,qg),a(at,si),a(si,Ug),a(_s,Gg),a(_s,tt),a(tt,ai),a(ai,Ue),Ue.innerHTML=mT,a(tt,Vg),a(tt,ti),a(ti,Ge),Ge.innerHTML=yT,l(n,sk,o),l(n,Ve,o),a(Ve,Wg),l(n,ak,o),l(n,et,o),et.innerHTML=wT,l(n,tk,o),l(n,Is,o),a(Is,As),a(As,ei),a(Is,Yg),l(n,ek,o),l(n,We,o),a(We,Jg),l(n,pk,o),l(n,M,o),a(M,zg),a(M,pi),a(pi,Kg),a(M,$g),a(M,oi),a(oi,Xg),a(M,Zg),a(M,li),a(li,Qg),l(n,ok,o),l(n,pt,o),pt.innerHTML=gT,l(n,lk,o),l(n,Ye,o),a(Ye,n1),l(n,ik,o),l(n,ot,o),ot.innerHTML=vT,l(n,ck,o),l(n,Je,o),a(Je,s1),l(n,rk,o),l(n,lt,o),lt.innerHTML=bT,l(n,uk,o),l(n,Os,o),a(Os,a1),a(Os,ii),a(ii,t1),a(Os,e1),l(n,kk,o),l(n,it,o),it.innerHTML=ET,l(n,dk,o),l(n,ze,o),a(ze,p1),l(n,fk,o),l(n,Ps,o),a(Ps,ct),a(ct,ci),a(ci,o1),a(ct,l1),a(ct,ri),a(ri,i1),a(Ps,c1),a(Ps,rt),a(rt,ui),a(ui,Ke),Ke.innerHTML=xT,a(rt,r1),a(rt,ki),a(ki,$e),$e.innerHTML=ST,l(n,hk,o),l(n,$,o),a($,u1),a($,di),a(di,k1),a($,d1),a($,fi),a(fi,f1),a($,h1),l(n,mk,o),l(n,ut,o),ut.innerHTML=TT,l(n,yk,o),l(n,kt,o),a(kt,m1),a(kt,hi),a(hi,y1),l(n,wk,o),l(n,dt,o),dt.innerHTML=_T,l(n,gk,o),l(n,Xe,o),a(Xe,w1),l(n,vk,o),l(n,ft,o),ft.innerHTML=IT,l(n,bk,o),l(n,H,o),a(H,mi),a(mi,g1),a(H,v1),a(H,yi),a(yi,b1),a(H,E1),a(H,wi),a(wi,x1),a(H,S1),l(n,Ek,o),l(n,ht,o),ht.innerHTML=AT,l(n,xk,o),l(n,Ze,o),a(Ze,T1),l(n,Sk,o),l(n,Qe,o),a(Qe,j),l(n,Tk,o),l(n,Cs,o),a(Cs,Ds),a(Ds,gi),a(Cs,_1),l(n,_k,o),l(n,np,o),a(np,I1),l(n,Ik,o),l(n,Rs,o),a(Rs,Ls),a(Ls,vi),a(Rs,A1),l(n,Ak,o),l(n,sp,o),a(sp,O1),l(n,Ok,o),l(n,ap,o),a(ap,P1),l(n,Pk,o),l(n,Ms,o),a(Ms,C1),a(Ms,bi),a(bi,D1),a(Ms,R1),l(n,Ck,o),l(n,Hs,o),a(Hs,js),a(js,Ei),a(Hs,L1),l(n,Dk,o),l(n,tp,o),a(tp,ep),l(n,Rk,o),l(n,Fs,o),a(Fs,M1),a(Fs,xi),a(xi,H1),a(Fs,j1),l(n,Lk,o),l(n,mt,o),mt.innerHTML=OT,l(n,Mk,o),l(n,Bs,o),a(Bs,F1),a(Bs,Si),a(Si,B1),a(Bs,N1),l(n,Hk,o),l(n,yt,o),yt.innerHTML=PT,l(n,jk,o),l(n,Ns,o),a(Ns,q1),a(Ns,Ti),a(Ti,U1),a(Ns,G1),l(n,Fk,o),l(n,pp,o),a(pp,op),l(n,Bk,o),l(n,qs,o),a(qs,Us),a(Us,_i),a(qs,V1),l(n,Nk,o),l(n,Gs,o),a(Gs,W1),a(Gs,Ii),a(Ii,Y1),a(Gs,J1),l(n,qk,o),l(n,wt,o),wt.innerHTML=CT,l(n,Uk,o),l(n,lp,o),a(lp,z1),l(n,Gk,o),l(n,gt,o),gt.innerHTML=DT,l(n,Vk,o),l(n,Vs,o),a(Vs,Ws),a(Ws,Ai),a(Vs,K1),l(n,Wk,o),l(n,ip,o),a(ip,$1),l(n,Yk,o),l(n,d,o),a(d,X1),a(d,Oi),a(Oi,Z1),a(d,Q1),a(d,Pi),a(Pi,nv),a(d,sv),a(d,Ci),a(Ci,av),a(d,tv),a(d,Di),a(Di,ev),a(d,pv),a(d,Ri),a(Ri,ov),a(d,lv),a(d,Li),a(Li,iv),a(d,cv),a(d,Mi),a(Mi,rv),a(d,uv),a(d,Hi),a(Hi,kv),a(d,dv),l(n,Jk,o),l(n,vt,o),vt.innerHTML=RT,l(n,zk,o),l(n,Ys,o),a(Ys,fv),a(Ys,ji),a(ji,hv),a(Ys,mv),l(n,Kk,o),l(n,bt,o),bt.innerHTML=LT,l(n,$k,o),l(n,X,o),a(X,yv),a(X,Fi),a(Fi,wv),a(X,gv),a(X,Bi),a(Bi,vv),a(X,bv),l(n,Xk,o),l(n,Et,o),Et.innerHTML=MT,l(n,Zk,o),l(n,cp,o),a(cp,Ev),l(n,Qk,o),l(n,xt,o),xt.innerHTML=HT,l(n,nd,o),l(n,rp,o),a(rp,xv),l(n,sd,o),l(n,up,o),a(up,Sv),l(n,ad,o),l(n,Js,o),a(Js,zs),a(zs,Ni),a(Js,Tv),l(n,td,o),l(n,kp,o),a(kp,_v),l(n,ed,o),l(n,dp,o),a(dp,Iv),l(n,pd,o),l(n,Z,o),a(Z,qi),a(qi,Av),a(Z,Ov),a(Z,Ui),a(Ui,Pv),a(Z,Cv),a(Z,Gi),a(Gi,Dv),l(n,od,o),l(n,fp,o),a(fp,Rv),l(n,ld,o),l(n,St,o),St.innerHTML=jT,l(n,id,o),l(n,Tt,o),Tt.innerHTML=FT},p:v2,i:v2,o:v2,d(n){n&&s(N),n&&s(zi),n&&s(sn),n&&s(Ki),n&&s(pa),n&&s($i),n&&s(pn),n&&s(Xi),n&&s(At),n&&s(Zi),n&&s(ln),n&&s(Qi),n&&s(Ot),n&&s(nc),n&&s(rn),n&&s(sc),n&&s(kn),n&&s(ac),n&&s(dn),n&&s(tc),n&&s(h),n&&s(ec),n&&s(fn),n&&s(pc),n&&s(mn),n&&s(oc),n&&s(q),n&&s(lc),n&&s(wn),n&&s(ic),n&&s(Ct),n&&s(cc),n&&s(vn),n&&s(rc),n&&s(Rt),n&&s(uc),n&&s(bn),n&&s(kc),n&&s(U),n&&s(dc),n&&s(xn),n&&s(fc),n&&s(Sn),n&&s(hc),n&&s(Lt),n&&s(mc),n&&s(_n),n&&s(yc),n&&s(Mt),n&&s(wc),n&&s(An),n&&s(gc),n&&s(Ht),n&&s(vc),n&&s(Pn),n&&s(bc),n&&s(jt),n&&s(Ec),n&&s(Dn),n&&s(xc),n&&s(Ft),n&&s(Sc),n&&s(Nt),n&&s(Tc),n&&s(y),n&&s(_c),n&&s(Mn),n&&s(Ic),n&&s(jn),n&&s(Ac),n&&s(Ut),n&&s(Oc),n&&s(Bn),n&&s(Pc),n&&s(f),n&&s(Cc),n&&s(Gt),n&&s(Dc),n&&s(Vt),n&&s(Rc),n&&s(Nn),n&&s(Lc),n&&s(Wt),n&&s(Mc),n&&s(Jt),n&&s(Hc),n&&s(Un),n&&s(jc),n&&s(zt),n&&s(Fc),n&&s($t),n&&s(Bc),n&&s(Xt),n&&s(Nc),n&&s(G),n&&s(qc),n&&s(Vn),n&&s(Uc),n&&s(Zt),n&&s(Gc),n&&s(ne),n&&s(Vc),n&&s(se),n&&s(Wc),n&&s(ae),n&&s(Yc),n&&s(S),n&&s(Jc),n&&s(Yn),n&&s(zc),n&&s(te),n&&s(Kc),n&&s(pe),n&&s($c),n&&s(oe),n&&s(Xc),n&&s(T),n&&s(Zc),n&&s(zn),n&&s(Qc),n&&s(le),n&&s(nr),n&&s(b),n&&s(sr),n&&s(ie),n&&s(ar),n&&s(_),n&&s(tr),n&&s($n),n&&s(er),n&&s(ce),n&&s(pr),n&&s(re),n&&s(or),n&&s(Zn),n&&s(lr),n&&s(ke),n&&s(ir),n&&s(ra),n&&s(cr),n&&s(an),n&&s(rr),n&&s(ua),n&&s(ur),n&&s(de),n&&s(kr),n&&s(ns),n&&s(dr),n&&s(he),n&&s(fr),n&&s(ka),n&&s(hr),n&&s(me),n&&s(mr),n&&s(ye),n&&s(yr),n&&s(da),n&&s(wr),n&&s(we),n&&s(gr),n&&s(fa),n&&s(vr),n&&s(ge),n&&s(br),n&&s(ha),n&&s(Er),n&&s(V),n&&s(xr),n&&s(ve),n&&s(Sr),n&&s(ma),n&&s(Tr),n&&s(as),n&&s(_r),n&&s(ya),n&&s(Ir),n&&s(ts),n&&s(Ar),n&&s(wa),n&&s(Or),n&&s(ga),n&&s(Pr),n&&s(ba),n&&s(Cr),n&&s(es),n&&s(Dr),n&&s(be),n&&s(Rr),n&&s(os),n&&s(Lr),n&&s(Ee),n&&s(Mr),n&&s(W),n&&s(Hr),n&&s(Sa),n&&s(jr),n&&s(I),n&&s(Fr),n&&s(tn),n&&s(Br),n&&s(Ta),n&&s(Nr),n&&s(Se),n&&s(qr),n&&s(_a),n&&s(Ur),n&&s(Y),n&&s(Gr),n&&s(Ia),n&&s(Vr),n&&s(Aa),n&&s(Wr),n&&s(ls),n&&s(Yr),n&&s(is),n&&s(Jr),n&&s(Te),n&&s(zr),n&&s(Pa),n&&s(Kr),n&&s(J),n&&s($r),n&&s(Ca),n&&s(Xr),n&&s(cs),n&&s(Zr),n&&s(Da),n&&s(Qr),n&&s(A),n&&s(nu),n&&s(Ra),n&&s(su),n&&s(O),n&&s(au),n&&s(La),n&&s(tu),n&&s(_e),n&&s(eu),n&&s(Ma),n&&s(pu),n&&s(Ha),n&&s(ou),n&&s(ja),n&&s(lu),n&&s(rs),n&&s(iu),n&&s(ks),n&&s(cu),n&&s(Fa),n&&s(ru),n&&s(Ie),n&&s(uu),n&&s(Ae),n&&s(ku),n&&s(Ba),n&&s(du),n&&s(P),n&&s(fu),n&&s(Na),n&&s(hu),n&&s(ds),n&&s(mu),n&&s(qa),n&&s(yu),n&&s(Oe),n&&s(wu),n&&s(Pe),n&&s(gu),n&&s(fs),n&&s(vu),n&&s(C),n&&s(bu),n&&s(ms),n&&s(Eu),n&&s(ws),n&&s(xu),n&&s(gs),n&&s(Su),n&&s(Ua),n&&s(Tu),n&&s(z),n&&s(_u),n&&s(Ga),n&&s(Iu),n&&s(Ce),n&&s(Au),n&&s(Va),n&&s(Ou),n&&s(De),n&&s(Pu),n&&s(Re),n&&s(Cu),n&&s(Me),n&&s(Du),n&&s(Wa),n&&s(Ru),n&&s(He),n&&s(Lu),n&&s(Ya),n&&s(Mu),n&&s(vs),n&&s(Hu),n&&s(Ja),n&&s(ju),n&&s(je),n&&s(Fu),n&&s(za),n&&s(Bu),n&&s(Ka),n&&s(Nu),n&&s(Fe),n&&s(qu),n&&s($a),n&&s(Uu),n&&s(Be),n&&s(Gu),n&&s(Xa),n&&s(Vu),n&&s(Ne),n&&s(Wu),n&&s(Za),n&&s(Yu),n&&s(bs),n&&s(Ju),n&&s(K),n&&s(zu),n&&s(Qa),n&&s(Ku),n&&s(nt),n&&s($u),n&&s(st),n&&s(Xu),n&&s(xs),n&&s(Zu),n&&s(Ts),n&&s(Qu),n&&s(qe),n&&s(nk),n&&s(_s),n&&s(sk),n&&s(Ve),n&&s(ak),n&&s(et),n&&s(tk),n&&s(Is),n&&s(ek),n&&s(We),n&&s(pk),n&&s(M),n&&s(ok),n&&s(pt),n&&s(lk),n&&s(Ye),n&&s(ik),n&&s(ot),n&&s(ck),n&&s(Je),n&&s(rk),n&&s(lt),n&&s(uk),n&&s(Os),n&&s(kk),n&&s(it),n&&s(dk),n&&s(ze),n&&s(fk),n&&s(Ps),n&&s(hk),n&&s($),n&&s(mk),n&&s(ut),n&&s(yk),n&&s(kt),n&&s(wk),n&&s(dt),n&&s(gk),n&&s(Xe),n&&s(vk),n&&s(ft),n&&s(bk),n&&s(H),n&&s(Ek),n&&s(ht),n&&s(xk),n&&s(Ze),n&&s(Sk),n&&s(Qe),n&&s(Tk),n&&s(Cs),n&&s(_k),n&&s(np),n&&s(Ik),n&&s(Rs),n&&s(Ak),n&&s(sp),n&&s(Ok),n&&s(ap),n&&s(Pk),n&&s(Ms),n&&s(Ck),n&&s(Hs),n&&s(Dk),n&&s(tp),n&&s(Rk),n&&s(Fs),n&&s(Lk),n&&s(mt),n&&s(Mk),n&&s(Bs),n&&s(Hk),n&&s(yt),n&&s(jk),n&&s(Ns),n&&s(Fk),n&&s(pp),n&&s(Bk),n&&s(qs),n&&s(Nk),n&&s(Gs),n&&s(qk),n&&s(wt),n&&s(Uk),n&&s(lp),n&&s(Gk),n&&s(gt),n&&s(Vk),n&&s(Vs),n&&s(Wk),n&&s(ip),n&&s(Yk),n&&s(d),n&&s(Jk),n&&s(vt),n&&s(zk),n&&s(Ys),n&&s(Kk),n&&s(bt),n&&s($k),n&&s(X),n&&s(Xk),n&&s(Et),n&&s(Zk),n&&s(cp),n&&s(Qk),n&&s(xt),n&&s(nd),n&&s(rp),n&&s(sd),n&&s(up),n&&s(ad),n&&s(Js),n&&s(td),n&&s(kp),n&&s(ed),n&&s(dp),n&&s(pd),n&&s(Z),n&&s(od),n&&s(fp),n&&s(ld),n&&s(St),n&&s(id),n&&s(Tt)}}}const kI={date:"2022-05-26T17:04:48.123Z",draft:!0,archived:!1,title:"A Trello-like CRM tool with Google Apps Script",tags:["google apps script"],excerpt:"Keeping track of all the leads and opportunities when freelancing or now that I have just been laid off and am job hunting, can be a daunting task. I have built a simple tool in Google Apps Script to make the process easier"};class dI extends J_{constructor(N){super(),z_(this,N,null,rI,K_,{})}}export{dI as default,kI as metadata};

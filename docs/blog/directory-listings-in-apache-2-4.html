<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <link href="../favicon.ico" rel="shortcut icon">
  <link rel="icon" href="../favicon.gif" type="image/gif" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-K0CMFHZ2N0"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());
    gtag('config', 'G-K0CMFHZ2N0');
  </script>
  <meta http-equiv="content-security-policy" content=""><title>Directory listings in Apache 2.4 || gotofritz</title><meta name="description" content="Fritz Stelluto has been a developer and engineering manager in the digital industry since the 90s. He lives in Berlin." data-svelte="svelte-ugxg7c">
	<link rel="stylesheet" href="/app_/assets/pages/__layout.svelte-e730745d.css">
	<link rel="stylesheet" href="/app_/assets/_post-6b79a17e.css">
	<link rel="modulepreload" href="/app_/start-0147dbb1.js">
	<link rel="modulepreload" href="/app_/chunks/index-5f3bee99.js">
	<link rel="modulepreload" href="/app_/pages/__layout.svelte-c6f66827.js">
	<link rel="modulepreload" href="/app_/pages/blog/directory-listings-in-apache-2-4.md-1c446ad5.js">
	<link rel="modulepreload" href="/app_/chunks/_post-1d61ba86.js">
	<link rel="modulepreload" href="/app_/chunks/Header-5bd94491.js">
</head>

<body>
  <div class="gradient-container">
    


<main class="panel-container svelte-y2j27e"><div class="content svelte-y2j27e">

<nav class="flat-nav"><div itemscope itemtype="http://schema.org/Person" class="vcard group-of-links"><a href="storing-bash-profile-and-so-on-on-github">previous post</a>
      <a href="/">home</a>
      <a href="os-x-dns-lookups-too-slow-for-local-hosts">next post</a>
    <form class="search" action="https://google.com/search" method="get"><input type="text" id="search-str" name="q" results="0" placeholder="search" aria-label="search">
      <input type="hidden" name="q" value="site:gotofritz.net"></form></div>
</nav>
<article class="content-post svelte-1r1v8if"><section class="intro svelte-1r1v8if"><div class="post-meta"><time datetime="2015-03-07 23:14">2015-03-07</time>
      //
      <div class="tags"><a href="/tags/apache">apache</a>, <a href="/tags/os x">os x</a></div></div>
    <h1 class="svelte-1r1v8if">Directory listings in Apache 2.4</h1>
    <h2 class="svelte-1r1v8if"><!-- HTML_TAG_START -->Yosemite updates Apache to 2.4. A couple of things stopped working from my previous installation, including autogenerated directory listings. Here's how I got them back.<!-- HTML_TAG_END --></h2></section>
  <section class="post-content"><h2>Yosemite updates Apache from 2.2 to 2.4</h2>
<p>I t copies the old httpd.conf to <code>/etc/apache2/httpd.conf~previous</code> and replaces it with a vannilla one. Annoying, but not too painful to replace, and it doesn’t touch the vhosts. <a href="https://httpd.apache.org/docs/trunk/new_features_2_4.html">The list of 2.4 changes</a> doesn’t include anything I actually use. Sadly that doesn’t mean nothing important has changed - rather, they didn’t bother to list things that matter to me.</p>
<h2>Apache “directory listing forbidden”</h2>
<p>I used to rely on the automatic directory listings generated by mod_autoidex, but they has stopped working. The logs give the message <code>No matching DirectoryIndex (index.html) found, and server-generated directory index forbidden by Options directive</code>. “Impossible!” I cry, the settings are right, and they always worked.</p>
<p>This is the DocumentRoot fragment of httpd.conf. <code>+Indexes</code> is the bit which is supposed to turn on auto-indexing. I use /Library/… for not so important documents I need to put under a webserver for whatever reason.</p>
<pre class="language-xml"><!-- HTML_TAG_START --><code class="language-xml">DocumentRoot "/Library/WebServer/Documents"
&lt;Directory "/Library/WebServer/Documents">
    Options +Indexes +FollowSymLinks
    # etc
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Directory</span><span class="token punctuation">></span></span></code><!-- HTML_TAG_END --></pre>
<p>And this is one of the virtual hosts. For serious dev work, I put my vhosts somewhere other than /Library/…</p>
<pre class="language-xml"><!-- HTML_TAG_START --><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>VirtualHost</span> <span class="token attr-name"><span class="token namespace">*:</span>81</span><span class="token punctuation">></span></span>
    DocumentRoot "/pth/to/somewhere/completely/different"
    ServerName my-virtual-host.dev
    ErrorLog "/private/var/log/apache2/my-virtual-host.dev-error_log"
    CustomLog "/private/var/log/apache2/my-virtual-host.dev-access_log" common
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>VirtualHost</span><span class="token punctuation">></span></span></code><!-- HTML_TAG_END --></pre>
<p>What has changed is that now the options for DocumentRoot don’t automatically carry over to folders which are not subdirectories of DocumentRoot. This can be easily fixed by changing virtual hosts to</p>
<pre class="language-xml"><!-- HTML_TAG_START --><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>VirtualHost</span> <span class="token attr-name"><span class="token namespace">*:</span>80</span><span class="token punctuation">></span></span>
    DocumentRoot "/pth/to/somewhere/completely/different"
    ServerName my-virtual-host.dev
    ErrorLog "/private/var/log/apache2/my-virtual-host.dev-error_log"
    CustomLog "/private/var/log/apache2/my-virtual-host.dev-access_log" common
    &lt;Directory "/pth/to/somewhere/completely/different">
        Options +Indexes
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Directory</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>VirtualHost</span><span class="token punctuation">></span></span></code><!-- HTML_TAG_END --></pre>
<p>That proves what the problem is, but it sucks having to do that for every virtual host. The solution is to add the directive for the common parent folder of all my virtual hosts in httpd.conf</p>
<pre class="language-xml"><!-- HTML_TAG_START --><code class="language-xml">&lt;Directory "/parent/of/somewhere/completely/different">
    Options +Indexes
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Directory</span><span class="token punctuation">></span></span></code><!-- HTML_TAG_END --></pre>
<h2>Restart apache and all is well</h2>
<p>A fter a <code>sudo apachectl restart</code> everything works fine.</p></section>
</article></div>
  <footer class="svelte-tqiyh5"><div class="content svelte-tqiyh5"><nav class="flat-nav svelte-tqiyh5"><div itemscope itemtype="http://schema.org/Person" class="vcard group-of-links svelte-tqiyh5"><a href="https://github.com/gotofritz" class="svelte-tqiyh5">github</a><a href="https://twitter.com/gotofritz" class="svelte-tqiyh5">twitter</a><a href="https://www.linkedin.com/in/gotofritz" class="svelte-tqiyh5">linkedin</a><a href="/feed.xml" class="svelte-tqiyh5">rss</a></div></nav></div>
  
  <div class="content svelte-tqiyh5">All content under <a href="http://creativecommons.org/licenses/by-nc-sa/2.0/de/" class="svelte-tqiyh5">creative commons</a>
    and code under <a href="http://mit-license.org/" class="svelte-tqiyh5">MIT license</a>.
  </div>
</footer>
</main>


		<script type="module" data-hydrate="46f3ly">
		import { start } from "/app_/start-0147dbb1.js";
		start({
			target: document.querySelector('[data-hydrate="46f3ly"]').parentNode,
			paths: {"base":"","assets":""},
			session: {},
			route: true,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/app_/pages/__layout.svelte-c6f66827.js"),
						import("/app_/pages/blog/directory-listings-in-apache-2-4.md-1c446ad5.js")
				],
				params: {},
				routeId: "blog/directory-listings-in-apache-2-4"
			}
		});
	</script>
  </div>
</body>

</html>
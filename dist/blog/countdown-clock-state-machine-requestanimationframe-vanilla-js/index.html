<!DOCTYPE html>


<html lang="en-GB">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Icons / Favicon -->
<link rel="icon" href="/favicon.ico" sizes="any">
<link rel="icon" href="/icon.svg" type="image/svg+xml">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="manifest" href="/manifest.webmanifest">
<link rel="canonical" href="https://gotofritz.net/blog/countdown-clock-state-machine-requestanimationframe-vanilla-js/">

<!-- Primary Meta Tags -->
<title>A countdown clock using requestAnimationFrame, a state machine, and vanilla JS • gotofritz.net</title>
<meta name="title" content="A countdown clock using requestAnimationFrame, a state machine, and vanilla JS • gotofritz.net">
<meta name="description" content="I wanted to play with state machines and requestAnimationFrame in vanilla JS, so I came up with the idea of a simple countdown clock.">
<meta name="author" content="Fritz Stelluto">

<!-- Theme Colour -->
<meta name="theme-color" content="#fafafa">

<!-- Open Graph / Facebook -->
<meta property="og:type" content="article">
<meta property="og:title" content="A countdown clock using requestAnimationFrame, a state machine, and vanilla JS">
<meta property="og:description" content="I wanted to play with state machines and requestAnimationFrame in vanilla JS, so I came up with the idea of a simple countdown clock.">
<meta property="og:url" content="https://gotofritz.net/blog/countdown-clock-state-machine-requestanimationframe-vanilla-js/">
<meta property="og:site_name" content="gotofritz.net">
<meta property="og:locale" content="en_GB">
<meta property="og:image" content="https://gotofritz.net/og-image/countdown-clock-state-machine-requestanimationframe-vanilla-js.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="article:author" content="Fritz Stelluto"><meta property="article:published_time" content="2020-03-29T00:00:00.000Z">

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://gotofritz.net/blog/countdown-clock-state-machine-requestanimationframe-vanilla-js/">
<meta property="twitter:title" content="A countdown clock using requestAnimationFrame, a state machine, and vanilla JS">
<meta property="twitter:description" content="I wanted to play with state machines and <a href=&#34;https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame&#34;>requestAnimationFrame</a> in vanilla JS, so I came up with the idea of a simple countdown clock.">
<meta property="twitter:image" content="https://gotofritz.net/og-image/countdown-clock-state-machine-requestanimationframe-vanilla-js.png">

<!-- RSS auto-discovery -->
<link rel="alternate" type="application/rss+xml" title="gotofritz.net" href="/rss.xml">
    <script>(function(){const siteConfig = {"author":"Fritz Stelluto","title":"gotofritz.net","description":"Hello, I'm Fritz, an experienced engineer based in Berlin. Currently I am working at Trawa, focusing on service development and ML Ops.","lang":"en-GB","ogLocale":"en_GB","themeColorLight":"#fafafa","themeColorDark":"#1d1f21"};

      const root = document.documentElement;
      const colorThemeMetaTag = document.querySelector("meta[name='theme-color']");

      // get user preference of dark mode, 1st local storage, 2nd browser
      function getThemePreference() {
        if (typeof localStorage !== "undefined" && localStorage.getItem("theme")) {
          return localStorage.getItem("theme");
        }
        return window.matchMedia("(prefers-color-scheme: dark)").matches
          ? "dark"
          : "light";
      }

      const isDark = getThemePreference() === "dark";

      // watch document element class attribute and update user preference when it changes.
      const observer = new MutationObserver(() => {
        const rootIsDark = root.classList.contains("dark");
        // set the meta attribute
        colorThemeMetaTag.setAttribute(
          "content",
          siteConfig[rootIsDark ? "themeColorDark" : "themeColorLight"]
        );
        // store user preference
        if (typeof localStorage !== "undefined") {
          localStorage.setItem("theme", rootIsDark ? "dark" : "light");
        }
      });
      observer.observe(root, { attributeFilter: ["class"] });

      // initailse root class attribute
      root.classList.toggle("dark", isDark);
    })();</script>
  <link rel="stylesheet" href="/_astro/_...post_.afbe0fa4.css" /><script type="module" src="/_astro/hoisted.99e77f46.js"></script>
<script type="module" src="/_astro/page.b7cc8384.js"></script></head>
  <body>
    <a href="#main" class="sr-only focus:not-sr-only focus:fixed focus:top-1.5 focus:left-1">skip to content
</a>
    <header id="main-header" class="group mb-12 flex flex-wrap items-center justify-start gap-y-8 sm:mb-28 sm:gap-y-0">
  <a href="/" class="order-1 block grow-0 items-center grayscale hover:filter-none">
    <svg class="h-10 w-10 rounded-md bg-black dark:bg-white sm:mr-0 sm:h-[4.25rem] sm:w-[4.25rem]" aria-hidden="true" focusable="false" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
      <g>
        <path id="path-goto" d="M 123.8 88 L 52 88 L 52 194.7 L 87 194.7 L 87 159.6 L 70 159.6 L 70 123.6 L 124 123 L 124 230 L 17 230 C 17 230 17 17 17 52 C 17 52 124 52 124 52 L 124 88 L 123.8 88 Z M 176.25 194.684 C 176.25 194.684 210.52 194.684 210.52 194.684 C 210.52 194.684 211 89 211 89 C 211 89 176 89 176 89 C 176 89 176 195 176 195 L 176.25 194.684 Z M 246 230 L 140 230 C 140 230 140 52 140 52 C 140 52 247 52 247 52 C 247 52 246 230 246 230 Z M 334 230 L 297 230 L 298.27 88.527 L 263.02 88.527 C 263.02 88.527 263 52 263 52 C 263 52 369 52 369 52 C 369 52 369.75 88.527 369.75 88.527 L 334.5 88.527 L 334 230 Z M 422.25 194.684 C 422.25 194.684 456.52 194.684 456.52 194.684 C 456.52 194.684 456 88.79 456 88.79 C 456 88.79 422 88.79 422 88.79 C 422 88.79 422.25 194.684 422.25 194.684 Z M 492 230 L 386 230 C 386 230 386 52 386 52 C 386 52 492 52 492 52 L 492 230 Z" class="fill-white stroke-none dark:fill-black">
          <title>GOTO</title>
        </path>
      </g>
      <g>
        <path id="path-fritz" stroke-width="1" d="M 51 461 L 17 461 L 17 294 L 100 294 L 100 327.337 L 51 327.375 L 51 361.722 L 100 361.685 L 100 395.022 L 51 395.06 L 51 461 Z M 150 327.375 C 150 327.375 150 361.722 150 361.722 C 150 361.722 182 361.685 182 361.685 C 182 361.685 182 327.337 182 327.337 C 182 327.337 150 327.375 150 327.375 Z M 150 461 L 116 461 L 116 294 L 199.5 294.037 L 200 311.174 L 216 311.211 L 216 378.859 L 200 378.859 L 200 395.022 L 216 395.022 L 216 461 L 182 461 L 182 395.022 L 150 395.06 L 150 461 Z M 265 461.697 L 231.1 461 L 231 294 L 265 294.037 L 265 461 L 265 461.697 Z M 347 461.697 L 313 461 L 313 327.337 L 280 327.337 L 280 294 L 380 294.037 L 380 327.375 L 347 327.375 L 347 461 L 347 461.697 Z M 495 461.697 L 395 461 L 395 394.517 L 411.58 394.524 L 411.58 377.856 L 428.08 377.856 L 428.08 361.722 L 444.58 361.722 L 444.58 344.549 L 462 344.511 L 461.08 327.375 L 395 327.337 L 395 294 L 495 294.037 L 495 345.559 L 478.5 345.559 L 478.5 361.722 L 462 361.722 L 462 377.886 L 445 377.848 L 445 395.022 L 429 395.06 L 429 429.407 L 495 429.407 L 495 461 L 495 461.697 Z M 462 361.722 L 478 361.685 L 462 361.722 Z M 478.5 345.559 L 495 345.559 L 478 345.521 L 478.5 345.559 Z" class="fill-white stroke-none dark:fill-black">
          <title>FRITZ</title>
        </path>
      </g>
    </svg></a>
  
  

<theme-toggle class="ml-auto order-3 sm:order-3">
  <button type="button" id="toggle-theme" class="group relative h-10 w-10 rounded-md bg-zinc-200 p-2 ring-zinc-400 transition-all hover:ring-2 dark:bg-zinc-700" aria-label="Toggle Dark Mode">
    <svg id="sun-svg" class="absolute top-1/2 left-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all group-aria-pressed:scale-100 group-aria-pressed:opacity-100" aria-hidden="true" focusable="false" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
      <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
      <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
      <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
      <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
      <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
      <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
      <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
      <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
    </svg>
    <svg id="moon-svg" class="absolute top-1/2 left-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all group-aria-[pressed=false]:scale-100 group-aria-[pressed=false]:opacity-100" aria-hidden="true" focusable="false" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="1.5"></circle>
      <path d="M7.63262 3.06689C8.98567 3.35733 9.99999 4.56025 9.99999 6.00007C9.99999 7.65693 8.65685 9.00007 6.99999 9.00007C5.4512 9.00007 4.17653 7.82641 4.01685 6.31997" stroke="currentColor" stroke-width="1.5"></path>
      <path d="M22 13.0505C21.3647 12.4022 20.4793 12 19.5 12C17.567 12 16 13.567 16 15.5C16 17.2632 17.3039 18.7219 19 18.9646" stroke="currentColor" stroke-width="1.5"></path>
      <path d="M14.5 8.51L14.51 8.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
      <path d="M10 17C11.1046 17 12 16.1046 12 15C12 13.8954 11.1046 13 10 13C8.89543 13 8 13.8954 8 15C8 16.1046 8.89543 17 10 17Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
    </svg>
  </button>
</theme-toggle>
  <nav id="navigation-menu" class="flex gap-y-4 grow sm:grow-no items-end sm:flex-row sm:flex sm:items-center sm:mt-1 sm:py-0 sm:ml-8 text-accent order-2 sm:order-2 justify-around sm:justify-start" aria-label="Main menu">
    <a href="/" class="px-2 py-4 sm:py-0 sm:hover:underline" rel="prefetch">
      Home
    </a>
    <a href="/about" class="px-2 py-4 sm:py-0 sm:hover:underline" rel="prefetch">
      About
    </a>
    <a href="/blog" class="px-2 py-4 sm:py-0 sm:hover:underline" rel="prefetch">
      Blog
    </a>
    <a href="/fritz-stelluto_resume.pdf" class="px-2 py-4 sm:py-0 sm:hover:underline hidden sm:block">Resume</a>
  </nav>
</header>
    <main id="main" class="flex-1">
      <div class="sm:grid sm:grid-cols-4 sm:items-start sm:gap-x-10">
    <article class="col-span-3 break-words">
      <div id="blog-hero"><h1 class="title mb-1 text-5xl">A countdown clock using requestAnimationFrame, a state machine, and vanilla JS</h1>
<time datetime="2020-03-29T00:00:00.000Z">29 Mar 2020 </time>
<div class="before:content-['|'] inline">
      <svg aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" class="inline-block h-6 w-6" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <path d="M7.859 6h-2.834a2.025 2.025 0 0 0 -2.025 2.025v2.834c0 .537 .213 1.052 .593 1.432l6.116 6.116a2.025 2.025 0 0 0 2.864 0l2.834 -2.834a2.025 2.025 0 0 0 0 -2.864l-6.117 -6.116a2.025 2.025 0 0 0 -1.431 -.593z"></path>
          <path d="M17.573 18.407l2.834 -2.834a2.025 2.025 0 0 0 0 -2.864l-7.117 -7.116"></path>
          <path d="M6 9h-.01"></path>
        </svg>
      <a class="inline-block pr-1" aria-label="View more blogs with the tag Javascript" href="/tags/Javascript">
          #Javascript
        </a>
    </div>
<p class="mt-8 text-xl leading-7">I wanted to play with state machines and <a href="https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame">requestAnimationFrame</a> in vanilla JS, so I came up with the idea of a simple countdown clock.</p></div>
      <div class="prose prose-sm prose-cactus mt-12 prose-headings:font-semibold prose-headings:before:absolute prose-headings:before:-ml-4 prose-headings:before:text-accent prose-headings:before:content-['#'] prose-th:before:content-none">
        <iframe src="https://codesandbox.io/embed/vanilla-js-countdown-clock-kslrp?editorsize=65&#x26;codemirror=1&#x26;fontsize=14&#x26;theme=dark&#x26;view=split" style="width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;" title="Vanilla JS countdown clock" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin"></iframe>
<h2 id="setting-up-the-project-with-parcel--codesandboxio">Setting up the project with Parcel @ CodeSandbox.io</h2>
<p>I am doing this in CodeSandbox, which has a lot of nice project starters with Babel and Parcel. With that I don’t need to worry about bundles and using the <a href="https://addyosmani.com/resources/essentialjsdesignpatterns/book/#revealingmodulepatternjavascript">revealing module pattern</a> and all that jazz - I can just use standard ES6 modules and CSS files. The UI is built in basic HTML with CSS, all updated as needed by the javascript code, which is organised in modules. The main js file, <code>index.js</code>, orchestrates all the modules and connects them together. The heart of the app is a state machine</p>
<h2 id="the-state-machine">The State Machine</h2>
<p>State machines are a neat way to organise apps; they encapsulate behaviour and I like the way they make us approach problems in terms of state. The implementation I came up with is very simple, basically a pub / sub pattern in which subscribers are able to trigger state changes as well. The state machine source file lives in the modules/ folder and exports a singleton. It’s generic enough it could be dropped in another project</p>
<pre is:raw="" class="astro-code" style="background-color: #272822; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #66D9EF">let</span><span style="color: #F8F8F2"> state;</span></span>
<span class="line"><span style="color: #66D9EF">const</span><span style="color: #F8F8F2"> entities </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> [];</span></span>
<span class="line"><span style="color: #66D9EF">const</span><span style="color: #F8F8F2"> states </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">new</span><span style="color: #F8F8F2"> </span><span style="color: #A6E22E">Set</span><span style="color: #F8F8F2">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F92672">export</span><span style="color: #F8F8F2"> </span><span style="color: #66D9EF">const</span><span style="color: #F8F8F2"> StateMachine </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> {</span></span>
<span class="line"><span style="color: #F8F8F2">  </span><span style="color: #88846F">// states could be anything at all, but it only really</span></span>
<span class="line"><span style="color: #F8F8F2">  </span><span style="color: #88846F">// makes sense to use strings or symbols. Maybe numbers.</span></span>
<span class="line"><span style="color: #F8F8F2">  </span><span style="color: #88846F">// States need to be added before they can be triggered,</span></span>
<span class="line"><span style="color: #F8F8F2">  </span><span style="color: #88846F">// just so that the engine knows which ones to reject.</span></span>
<span class="line"><span style="color: #F8F8F2">  </span><span style="color: #88846F">// state can be either an array or a scalar</span></span>
<span class="line"><span style="color: #F8F8F2">  </span><span style="color: #A6E22E">addStates</span><span style="color: #F8F8F2">: (</span><span style="color: #FD971F">stateOrStates</span><span style="color: #F8F8F2">) </span><span style="color: #66D9EF">=></span><span style="color: #F8F8F2"> {</span></span>
<span class="line"><span style="color: #F8F8F2">    [].</span><span style="color: #A6E22E">concat</span><span style="color: #F8F8F2">(stateOrStates).</span><span style="color: #A6E22E">forEach</span><span style="color: #F8F8F2">((</span><span style="color: #FD971F">s</span><span style="color: #F8F8F2">) </span><span style="color: #66D9EF">=></span><span style="color: #F8F8F2"> states.</span><span style="color: #A6E22E">add</span><span style="color: #F8F8F2">(s));</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #88846F">// all methods are chainable</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #F92672">return</span><span style="color: #F8F8F2"> StateMachine;</span></span>
<span class="line"><span style="color: #F8F8F2">  },</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">  </span><span style="color: #A6E22E">addEntity</span><span style="color: #F8F8F2">: (</span><span style="color: #FD971F">entity</span><span style="color: #F8F8F2">) </span><span style="color: #66D9EF">=></span><span style="color: #F8F8F2"> {</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #88846F">// entities can be anything that has methods</span></span>
<span class="line"><span style="color: #F8F8F2">    entities.</span><span style="color: #A6E22E">push</span><span style="color: #F8F8F2">(entity);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #88846F">// If an entity needs to trigger states, it needs</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #88846F">// to implement a linkStateMachine method and</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #88846F">// save a reference to StateMachine.setState for</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #88846F">// later use</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #F92672">if</span><span style="color: #F8F8F2"> (entity.linkStateMachine) {</span></span>
<span class="line"><span style="color: #F8F8F2">      entity.</span><span style="color: #A6E22E">linkStateMachine</span><span style="color: #F8F8F2">(StateMachine.setState);</span></span>
<span class="line"><span style="color: #F8F8F2">    }</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #F92672">return</span><span style="color: #F8F8F2"> StateMachine;</span></span>
<span class="line"><span style="color: #F8F8F2">  },</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">  </span><span style="color: #A6E22E">setState</span><span style="color: #F8F8F2">: (</span><span style="color: #FD971F">s</span><span style="color: #F8F8F2">) </span><span style="color: #66D9EF">=></span><span style="color: #F8F8F2"> {</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #88846F">// only states previously added with addState can be set.</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #F92672">if</span><span style="color: #F8F8F2"> (states.</span><span style="color: #A6E22E">has</span><span style="color: #F8F8F2">(s) </span><span style="color: #F92672">&#x26;&#x26;</span><span style="color: #F8F8F2"> s </span><span style="color: #F92672">!==</span><span style="color: #F8F8F2"> state) {</span></span>
<span class="line"><span style="color: #F8F8F2">      state </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> s;</span></span>
<span class="line"><span style="color: #F8F8F2">      entities.</span><span style="color: #A6E22E">forEach</span><span style="color: #F8F8F2">((</span><span style="color: #FD971F">entity</span><span style="color: #F8F8F2">) </span><span style="color: #66D9EF">=></span><span style="color: #F8F8F2"> {</span></span>
<span class="line"><span style="color: #F8F8F2">        </span><span style="color: #88846F">// if an entity wants to respond to a state, it needs</span></span>
<span class="line"><span style="color: #F8F8F2">        </span><span style="color: #88846F">// to implement a method by the same name as the state.</span></span>
<span class="line"><span style="color: #F8F8F2">        </span><span style="color: #88846F">// If not there, nothing happens</span></span>
<span class="line"><span style="color: #F8F8F2">        </span><span style="color: #F92672">if</span><span style="color: #F8F8F2"> (s </span><span style="color: #F92672">in</span><span style="color: #F8F8F2"> entity) {</span></span>
<span class="line"><span style="color: #F8F8F2">          entity[s]();</span></span>
<span class="line"><span style="color: #F8F8F2">        }</span></span>
<span class="line"><span style="color: #F8F8F2">      });</span></span>
<span class="line"><span style="color: #F8F8F2">    }</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #F92672">return</span><span style="color: #F8F8F2"> StateMachine;</span></span>
<span class="line"><span style="color: #F8F8F2">  },</span></span>
<span class="line"><span style="color: #F8F8F2">};</span></span></code></pre>
<p>The state machine offers three methods: <code>addStates</code>, <code>addEntity</code>, <code>setState</code>, all chainable. ‘States’ can technically be anything at all, but it only really make sense to use strings or symbols. Maybe numbers or Date objects if you are so inclined. <code>addStates</code> simply stores a list of these states, and the state machine will not set a state with <code>setState</code> event unless the state was previously added with <code>addStates</code> (it will fail silently).</p>
<p>An ‘entity’ here is anything that is expected to respond to, or trigger, state changes. It can be any type of JS variable which is not undefine or null. Entities can respond to state changes by implementing a method with the same name as the state, and if they do not need to respond to a specific state change they simply do not implement the corresponding method; the state handling methods are basically mixed in into a ‘normal’ object. Additionally, they can have other methods of their own. For example, this is how it is used in this countdown example (IS_PAUSED, IS_RUNNING, IS_COMPLETE are symbols imported from a constants.js file):</p>
<pre is:raw="" class="astro-code" style="background-color: #272822; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #F8F8F2">StateMachine.</span><span style="color: #A6E22E">addStates</span><span style="color: #F8F8F2">([IS_PAUSED, IS_RUNNING, IS_COMPLETE])</span></span>
<span class="line"><span style="color: #F8F8F2">  .</span><span style="color: #A6E22E">addEntity</span><span style="color: #F8F8F2">(UI)</span></span>
<span class="line"><span style="color: #F8F8F2">  .</span><span style="color: #A6E22E">addEntity</span><span style="color: #F8F8F2">(CountDownTimer)</span></span>
<span class="line"><span style="color: #F8F8F2">  .</span><span style="color: #A6E22E">setState</span><span style="color: #F8F8F2">(IS_PAUSED);</span></span></code></pre>
<p>If <code>UI</code> has a method called <code>[IS_PAUSED]</code> (it does) then it will be called when the app starts up, and the same for CountDownTimer.</p>
<p>Additionally if a module needs to trigger a state change, it can implement a <code>linkStateMachine</code> method, which takes a reference to the state machine’s <code>setState</code> method as its sole argument. <code>linkStateMachine</code> will be called when a reference to the module is added to the state machine with <code>addEntity</code>; the module can then store that reference internally, so that it can call it whenever it needs. For example, the countdown module will call <code>setState(IS_COMPLETE)</code> when the countdown reaches 0, and the UI will change accordindly. The button in the UI also calls <code>setState</code> whenever it’s clicked.</p>
<p>The state machine is used to orchestrate changes among its subscribers, it doesn’t really know anything about the states at all except for keeping a list of what states are allowed. It is the entities which encapsulate the logic and know what to do.</p>
<p>Note that the actual countdown “animation” doesn’t actually go through the state machine - rather, it feeds directly into the UI module. This is done to avoid the extra overhead and increase performance. Conceptually it also makes sense: when changing the time in the UI, the app is always in the same state, ‘IS_RUNNING’. One could instead see each seconds passing as a different state - this may make sense, for example, if you have a few components all animating in sync. But the current code works well for the case at hand.</p>
<h2 id="the-ui-module">The UI module</h2>
<p>The UI is actually built in HTML; the UI module simply finds the DOM elements it needs (the time and the button) and updates them as needed in response to state changes. It implements methods for each state, and it can trigger a state change when the button is clicked on</p>
<pre is:raw="" class="astro-code" style="background-color: #272822; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #66D9EF">const</span><span style="color: #F8F8F2"> component </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> document.</span><span style="color: #A6E22E">querySelector</span><span style="color: #F8F8F2">(</span><span style="color: #E6DB74">".Header"</span><span style="color: #F8F8F2">);</span></span>
<span class="line"><span style="color: #66D9EF">const</span><span style="color: #F8F8F2"> timer </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> document.</span><span style="color: #A6E22E">getElementById</span><span style="color: #F8F8F2">(</span><span style="color: #E6DB74">"js-time"</span><span style="color: #F8F8F2">);</span></span>
<span class="line"><span style="color: #66D9EF">const</span><span style="color: #F8F8F2"> button </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> document.</span><span style="color: #A6E22E">getElementById</span><span style="color: #F8F8F2">(</span><span style="color: #E6DB74">"js-button"</span><span style="color: #F8F8F2">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #66D9EF">let</span><span style="color: #F8F8F2"> lastTime;</span></span>
<span class="line"><span style="color: #66D9EF">let</span><span style="color: #F8F8F2"> setState;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #66D9EF">let</span><span style="color: #F8F8F2"> nextState;</span></span>
<span class="line"><span style="color: #88846F">// assigning handleClick to a var so that I can remove it</span></span>
<span class="line"><span style="color: #66D9EF">let</span><span style="color: #F8F8F2"> </span><span style="color: #A6E22E">handleClick</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> () </span><span style="color: #66D9EF">=></span><span style="color: #F8F8F2"> {</span></span>
<span class="line"><span style="color: #F8F8F2">  </span><span style="color: #A6E22E">setState</span><span style="color: #F8F8F2">(nextState);</span></span>
<span class="line"><span style="color: #F8F8F2">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F92672">export</span><span style="color: #F8F8F2"> </span><span style="color: #66D9EF">const</span><span style="color: #F8F8F2"> UI </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> {</span></span>
<span class="line"><span style="color: #F8F8F2">  </span><span style="color: #A6E22E">linkStateMachine</span><span style="color: #F8F8F2">: (</span><span style="color: #FD971F">ss</span><span style="color: #F8F8F2">) </span><span style="color: #66D9EF">=></span><span style="color: #F8F8F2"> {</span></span>
<span class="line"><span style="color: #F8F8F2">    setState </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> ss;</span></span>
<span class="line"><span style="color: #F8F8F2">  },</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">  </span><span style="color: #A6E22E">init</span><span style="color: #F8F8F2">: ({ onClick: </span><span style="color: #FD971F">clickHandler</span><span style="color: #F8F8F2">, </span><span style="color: #FD971F">time</span><span style="color: #F8F8F2"> }) </span><span style="color: #66D9EF">=></span><span style="color: #F8F8F2"> {</span></span>
<span class="line"><span style="color: #F8F8F2">    button.</span><span style="color: #A6E22E">addEventListener</span><span style="color: #F8F8F2">(</span><span style="color: #E6DB74">"click"</span><span style="color: #F8F8F2">, handleClick);</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #F92672">if</span><span style="color: #F8F8F2"> (time </span><span style="color: #F92672">!==</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">undefined</span><span style="color: #F8F8F2">) {</span></span>
<span class="line"><span style="color: #F8F8F2">      UI.</span><span style="color: #A6E22E">updateTime</span><span style="color: #F8F8F2">(time);</span></span>
<span class="line"><span style="color: #F8F8F2">    }</span></span>
<span class="line"><span style="color: #F8F8F2">    document.</span><span style="color: #A6E22E">querySelector</span><span style="color: #F8F8F2">(</span><span style="color: #E6DB74">".App"</span><span style="color: #F8F8F2">).style.display </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #E6DB74">"block"</span><span style="color: #F8F8F2">;</span></span>
<span class="line"><span style="color: #F8F8F2">  },</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">  </span><span style="color: #88846F">// this to avoid memory leaks, although I don't need it in this app</span></span>
<span class="line"><span style="color: #F8F8F2">  </span><span style="color: #A6E22E">destroy</span><span style="color: #F8F8F2">: () </span><span style="color: #66D9EF">=></span><span style="color: #F8F8F2"> button.</span><span style="color: #A6E22E">removeEventListener</span><span style="color: #F8F8F2">(</span><span style="color: #E6DB74">"click"</span><span style="color: #F8F8F2">, handleClick),</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">  [IS_RUNNING]: (</span><span style="color: #FD971F">time</span><span style="color: #F8F8F2">) </span><span style="color: #66D9EF">=></span><span style="color: #F8F8F2"> {</span></span>
<span class="line"><span style="color: #F8F8F2">    button.textContent </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #E6DB74">"PAUSE"</span><span style="color: #F8F8F2">;</span></span>
<span class="line"><span style="color: #F8F8F2">    nextState </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> IS_PAUSED;</span></span>
<span class="line"><span style="color: #F8F8F2">    UI.</span><span style="color: #A6E22E">updateTime</span><span style="color: #F8F8F2">(time);</span></span>
<span class="line"><span style="color: #F8F8F2">  },</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">  [IS_COMPLETE]: (</span><span style="color: #FD971F">time</span><span style="color: #F8F8F2">) </span><span style="color: #66D9EF">=></span><span style="color: #F8F8F2"> {</span></span>
<span class="line"><span style="color: #F8F8F2">    button.</span><span style="color: #A6E22E">remove</span><span style="color: #F8F8F2">();</span></span>
<span class="line"><span style="color: #F8F8F2">    UI.</span><span style="color: #A6E22E">updateTime</span><span style="color: #F8F8F2">(</span><span style="color: #AE81FF">0</span><span style="color: #F8F8F2">);</span></span>
<span class="line"><span style="color: #F8F8F2">    component.classList.</span><span style="color: #A6E22E">add</span><span style="color: #F8F8F2">(</span><span style="color: #E6DB74">"complete"</span><span style="color: #F8F8F2">);</span></span>
<span class="line"><span style="color: #F8F8F2">  },</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">  [IS_PAUSED]: () </span><span style="color: #66D9EF">=></span><span style="color: #F8F8F2"> {</span></span>
<span class="line"><span style="color: #F8F8F2">    button.textContent </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #E6DB74">"RUN"</span><span style="color: #F8F8F2">;</span></span>
<span class="line"><span style="color: #F8F8F2">    nextState </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> IS_RUNNING;</span></span>
<span class="line"><span style="color: #F8F8F2">  },</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">  </span><span style="color: #A6E22E">updateTime</span><span style="color: #F8F8F2">: (</span><span style="color: #FD971F">time</span><span style="color: #F8F8F2">) </span><span style="color: #66D9EF">=></span><span style="color: #F8F8F2"> {</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #66D9EF">const</span><span style="color: #F8F8F2"> newTime </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #A6E22E">formatTime</span><span style="color: #F8F8F2">(time);</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #F92672">if</span><span style="color: #F8F8F2"> (newTime </span><span style="color: #F92672">===</span><span style="color: #F8F8F2"> lastTime) </span><span style="color: #F92672">return</span><span style="color: #F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">    timer.innerText </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> newTime;</span></span>
<span class="line"><span style="color: #F8F8F2">    lastTime </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> newTime;</span></span>
<span class="line"><span style="color: #F8F8F2">  },</span></span>
<span class="line"><span style="color: #F8F8F2">};</span></span></code></pre>
<p>The module uses a util function, <code>formatDate</code>, to convert the time it gets from the countdown timer into the ‘XX:XX’ format. To avoid touching the DOM unless needed, it stores a copy of the last formatted time it has set, and will stop unless it has changed</p>
<h2 id="the-countdown-timer">The Countdown timer</h2>
<p>The timer only responds to the IS_RUNNING and IS_PAUSED states. It uses requestAnimationFrame calling itself recursively to do the counting, and since requestAnimationFrame passes on an unknown timestamp to its method, a few variables are needed to keep track of where we are.</p>
<pre is:raw="" class="astro-code" style="background-color: #272822; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #66D9EF">let</span><span style="color: #F8F8F2"> latestStartTime;</span></span>
<span class="line"><span style="color: #66D9EF">let</span><span style="color: #F8F8F2"> animationRef;</span></span>
<span class="line"><span style="color: #66D9EF">let</span><span style="color: #F8F8F2"> isFinished </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">false</span><span style="color: #F8F8F2">;</span></span>
<span class="line"><span style="color: #66D9EF">let</span><span style="color: #F8F8F2"> remainingTime;</span></span>
<span class="line"><span style="color: #66D9EF">let</span><span style="color: #F8F8F2"> callback </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #66D9EF">Function</span><span style="color: #F8F8F2">.prototype;</span></span>
<span class="line"><span style="color: #66D9EF">let</span><span style="color: #F8F8F2"> setState;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #88846F">// this is the heart of the animation.</span></span>
<span class="line"><span style="color: #66D9EF">const</span><span style="color: #F8F8F2"> </span><span style="color: #A6E22E">animate</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> (</span><span style="color: #FD971F">timestamp</span><span style="color: #F8F8F2">) </span><span style="color: #66D9EF">=></span><span style="color: #F8F8F2"> {</span></span>
<span class="line"><span style="color: #F8F8F2">  </span><span style="color: #88846F">// is it the first iteration in this cycle?</span></span>
<span class="line"><span style="color: #F8F8F2">  </span><span style="color: #F92672">if</span><span style="color: #F8F8F2"> (latestStartTime </span><span style="color: #F92672">===</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">undefined</span><span style="color: #F8F8F2">) {</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #88846F">// make a note of the start time</span></span>
<span class="line"><span style="color: #F8F8F2">    latestStartTime </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> timestamp </span><span style="color: #F92672">+</span><span style="color: #F8F8F2"> remainingTime;</span></span>
<span class="line"><span style="color: #F8F8F2">  }</span></span>
<span class="line"><span style="color: #F8F8F2">  </span><span style="color: #88846F">// the time to display now</span></span>
<span class="line"><span style="color: #F8F8F2">  </span><span style="color: #66D9EF">const</span><span style="color: #F8F8F2"> currentTime </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> latestStartTime </span><span style="color: #F92672">-</span><span style="color: #F8F8F2"> timestamp;</span></span>
<span class="line"><span style="color: #F8F8F2">  </span><span style="color: #F92672">if</span><span style="color: #F8F8F2"> (currentTime </span><span style="color: #F92672">&#x3C;=</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">0</span><span style="color: #F8F8F2">) {</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #A6E22E">cancelAnimationFrame</span><span style="color: #F8F8F2">(animationRef);</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #A6E22E">callback</span><span style="color: #F8F8F2">(</span><span style="color: #AE81FF">0</span><span style="color: #F8F8F2">);</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #88846F">// trigger a state event in the rest of the app</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #A6E22E">setState</span><span style="color: #F8F8F2">(IS_COMPLETE);</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #88846F">// this is an internal state</span></span>
<span class="line"><span style="color: #F8F8F2">    isFinished </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">true</span><span style="color: #F8F8F2">;</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #F92672">return</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">0</span><span style="color: #F8F8F2">;</span></span>
<span class="line"><span style="color: #F8F8F2">  }</span></span>
<span class="line"><span style="color: #F8F8F2">  </span><span style="color: #A6E22E">callback</span><span style="color: #F8F8F2">(currentTime);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">  </span><span style="color: #88846F">// keep animating recursively</span></span>
<span class="line"><span style="color: #F8F8F2">  animationRef </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #A6E22E">requestAnimationFrame</span><span style="color: #F8F8F2">(animate);</span></span>
<span class="line"><span style="color: #F8F8F2">  </span><span style="color: #F92672">return</span><span style="color: #F8F8F2"> currentTime;</span></span>
<span class="line"><span style="color: #F8F8F2">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F92672">export</span><span style="color: #F8F8F2"> </span><span style="color: #66D9EF">const</span><span style="color: #F8F8F2"> CountDownTimer </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> {</span></span>
<span class="line"><span style="color: #F8F8F2">  </span><span style="color: #A6E22E">linkStateMachine</span><span style="color: #F8F8F2">: (</span><span style="color: #FD971F">ss</span><span style="color: #F8F8F2">) </span><span style="color: #66D9EF">=></span><span style="color: #F8F8F2"> {</span></span>
<span class="line"><span style="color: #F8F8F2">    setState </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> ss;</span></span>
<span class="line"><span style="color: #F8F8F2">  },</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">  </span><span style="color: #A6E22E">init</span><span style="color: #F8F8F2">: ({ </span><span style="color: #FD971F">countdownFrom</span><span style="color: #F8F8F2">, callback: </span><span style="color: #FD971F">cb</span><span style="color: #F8F8F2"> }) </span><span style="color: #66D9EF">=></span><span style="color: #F8F8F2"> {</span></span>
<span class="line"><span style="color: #F8F8F2">    remainingTime </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> countdownFrom;</span></span>
<span class="line"><span style="color: #F8F8F2">    callback </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> cb;</span></span>
<span class="line"><span style="color: #F8F8F2">  },</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">  [IS_RUNNING]: (</span><span style="color: #FD971F">time</span><span style="color: #F8F8F2">) </span><span style="color: #66D9EF">=></span><span style="color: #F8F8F2"> {</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #F92672">if</span><span style="color: #F8F8F2"> (isFinished) </span><span style="color: #F92672">return</span><span style="color: #F8F8F2">;</span></span>
<span class="line"><span style="color: #F8F8F2">    animationRef </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #A6E22E">requestAnimationFrame</span><span style="color: #F8F8F2">(animate);</span></span>
<span class="line"><span style="color: #F8F8F2">  },</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">  [IS_PAUSED]: () </span><span style="color: #66D9EF">=></span><span style="color: #F8F8F2"> {</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #A6E22E">cancelAnimationFrame</span><span style="color: #F8F8F2">(animationRef);</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #F92672">if</span><span style="color: #F8F8F2"> (latestStartTime </span><span style="color: #F92672">!==</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">undefined</span><span style="color: #F8F8F2">) {</span></span>
<span class="line"><span style="color: #F8F8F2">      </span><span style="color: #88846F">// prepare for the next cycle</span></span>
<span class="line"><span style="color: #F8F8F2">      remainingTime </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> latestStartTime </span><span style="color: #F92672">-</span><span style="color: #F8F8F2"> performance.</span><span style="color: #A6E22E">now</span><span style="color: #F8F8F2">();</span></span>
<span class="line"><span style="color: #F8F8F2">      latestStartTime </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">undefined</span><span style="color: #F8F8F2">;</span></span>
<span class="line"><span style="color: #F8F8F2">    }</span></span>
<span class="line"><span style="color: #F8F8F2">  },</span></span>
<span class="line"><span style="color: #F8F8F2">};</span></span></code></pre>
      </div>
    </article>
    <aside class="col-span-1 hidden text-right sm:sticky sm:top-20 sm:block">
      <nav class="mb-4 flex w-full flex-nowrap justify-end gap-4 text-xs text-gray-600 dark:text-gray-300">
        
        <a class="before:content-['<<']" href="/blog/music-remove-album-ratings-applescript">
              older
            </a>
        <a class="after:content-['>>']" href="/blog/setting-css-values-dynamically-in-svelte">
              newer
            </a>
        
      </nav>
      <h2 class="font-semibold">Table of Contents</h2><ul class="mt-4 space-y-2 text-xs">
              <li class="line-clamp-2 hover:text-accent">
                  <a href="#setting-up-the-project-with-parcel--codesandboxio" aria-label="Scroll to section: Setting up the project with Parcel @ CodeSandbox.io">
                    <span>&#35;</span> Setting up the project with Parcel @ CodeSandbox.io
                  </a>
                </li><li class="line-clamp-2 hover:text-accent">
                  <a href="#the-state-machine" aria-label="Scroll to section: The State Machine">
                    <span>&#35;</span> The State Machine
                  </a>
                </li><li class="line-clamp-2 hover:text-accent">
                  <a href="#the-ui-module" aria-label="Scroll to section: The UI module">
                    <span>&#35;</span> The UI module
                  </a>
                </li><li class="line-clamp-2 hover:text-accent">
                  <a href="#the-countdown-timer" aria-label="Scroll to section: The Countdown timer">
                    <span>&#35;</span> The Countdown timer
                  </a>
                </li>
            </ul>
    </aside>
  </div><button id="to-top-btn" class="z-90 fixed bottom-8 right-4 flex h-10 w-10 translate-y-28 items-center justify-center rounded-full border-2 border-transparent bg-zinc-200 text-3xl opacity-0 transition-all duration-300 hover:border-zinc-400 data-[show=true]:translate-y-0 data-[show=true]:opacity-100 dark:bg-zinc-700 sm:right-8 sm:h-12 sm:w-12" aria-label="Back to Top" data-show="false"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="h-6 w-6">
      <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 15.75l7.5-7.5 7.5 7.5"></path>
    </svg>
  </button>
    </main>
    <footer class="mt-auto flex w-full flex-col flex-wrap items-center justify-center gap-y-2 pt-20 pb-4 text-center align-top text-gray-500 sm:flex-row sm:justify-between sm:text-xs">
  <div class="flex flex-wrap items-center gap-x-4 sm:items-center">
  <p>Find me on</p>
  <ul class="flex flex-1 items-center gap-x-4 sm:flex-initial">
    <li>
      <a class="inline-block p-2 sm:hover:text-link" href="https://github.com/gotofritz" target="_blank" rel="noopener noreferrer">
        <svg class="h-6 w-6" aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5">
          </path>
          <title>Github</title>
        </svg>
        <span class="sr-only">Github</span>
      </a>
    </li>
    <!-- <li>
      <a
        class="inline-block p-2 sm:hover:text-link"
        href="https://fosstodon.org/@gotofritz"
        target="_blank"
        rel="noopener noreferrer"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-6 w-6"
          stroke-width="1.5"
          stroke="currentColor"
          fill="none"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <path
            d="M18.648 15.254c-1.816 1.763 -6.648 1.626 -6.648 1.626a18.262 18.262 0 0 1 -3.288 -.256c1.127 1.985 4.12 2.81 8.982 2.475c-1.945 2.013 -13.598 5.257 -13.668 -7.636l-.026 -1.154c0 -3.036 .023 -4.115 1.352 -5.633c1.671 -1.91 6.648 -1.666 6.648 -1.666s4.977 -.243 6.648 1.667c1.329 1.518 1.352 2.597 1.352 5.633s-.456 4.074 -1.352 4.944z"
          ></path>
          <path
            d="M12 11.204v-2.926c0 -1.258 -.895 -2.278 -2 -2.278s-2 1.02 -2 2.278v4.722m4 -4.722c0 -1.258 .895 -2.278 2 -2.278s2 1.02 2 2.278v4.722"
          ></path>

          <title>Mastodon</title>
        </svg>
        <span class="sr-only">Mastodon</span>
      </a>
    </li> -->
    <li>
      <a class="inline-block p-2 sm:hover:text-link" href="https://www.linkedin.com/in/gotofritz/" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" aria-hidden="true" focusable="false" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <rect x="4" y="4" width="16" height="16" rx="2"></rect>
          <line x1="8" y1="11" x2="8" y2="16"></line>
          <line x1="8" y1="8" x2="8" y2="8.01"></line>
          <line x1="12" y1="16" x2="12" y2="11"></line>
          <path d="M16 16v-3a2 2 0 0 0 -4 0"></path>
          <title>LinkedIn</title>
        </svg>
        <span class="sr-only">LinkedIn</span>
      </a>
    </li>
    <li>
      <a class="inline-block p-2 sm:hover:text-link" href="mailto:info@gotofritz.net">
        <svg class="h-6 w-6" aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <rect x="3" y="5" width="18" height="14" rx="2"></rect>
          <polyline points="3 7 12 13 21 7"></polyline>
          <title>Email</title>
        </svg>
        <span class="sr-only">Email</span>
      </a>
    </li>
    <li>
      <a class="inline-block p-2 sm:hover:text-link" href="/feed.xml">
        <svg class="h-6 w-6" aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <circle cx="5" cy="19" r="1"></circle>
          <path d="M4 4a16 16 0 0 1 16 16"></path>
          <path d="M4 11a9 9 0 0 1 9 9"></path>
          <title>RSS</title>
        </svg>
        <span class="sr-only">RSS</span>
      </a>
    </li>
  </ul>
</div>
  <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
    <a href="/" class="sm:px-4 px-2 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline">Home</a>
    <a href="/about" class="sm:px-4 px-2 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline">About</a>
    <a href="/posts" class="sm:px-4 px-2 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline">Blog</a>
    <a href="/fritz-stelluto_resume.pdf" class="sm:px-4 px-2 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline">Resume</a>
  </nav>
  <div class="my-8 mr-0 sm:mr-4">
    <a href="https://creativecommons.org/licenses/by/4.0/">Licensed under a Creative Commons Attribution 4.0 license</a>
  </div>
</footer>
  </body></html>
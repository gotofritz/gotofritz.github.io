<!DOCTYPE html>


<html lang="en-GB">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Icons / Favicon -->
<link rel="icon" href="/favicon.ico" sizes="any">
<link rel="icon" href="/icon.svg" type="image/svg+xml">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="manifest" href="/manifest.webmanifest">
<link rel="canonical" href="https://gotofritz.net/blog/migrating-youtube-playlists-by-adding-videos-via-cli/">

<!-- Primary Meta Tags -->
<title>Adding videos to a youtube playlists via a terminal python script • gotofritz.net</title>
<meta name="title" content="Adding videos to a youtube playlists via a terminal python script • gotofritz.net">
<meta name="description" content="I wanted to duplicate another user's playlist to one of my free google accounts. But it's no longer possible from the web interface. None of the methods described in various SO answers are functional, they are obsolete. But it can be done with a Python script in your terminal.">
<meta name="author" content="Fritz Stelluto">

<!-- Theme Colour -->
<meta name="theme-color" content="#fafafa">

<!-- Open Graph / Facebook -->
<meta property="og:type" content="article">
<meta property="og:title" content="Adding videos to a youtube playlists via a terminal python script">
<meta property="og:description" content="I wanted to duplicate another user's playlist to one of my free google accounts. But it's no longer possible from the web interface. None of the methods described in various SO answers are functional, they are obsolete. But it can be done with a Python script in your terminal.">
<meta property="og:url" content="https://gotofritz.net/blog/migrating-youtube-playlists-by-adding-videos-via-cli/">
<meta property="og:site_name" content="gotofritz.net">
<meta property="og:locale" content="en_GB">
<meta property="og:image" content="https://gotofritz.net/og-image/migrating-youtube-playlists-by-adding-videos-via-cli.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="article:author" content="Fritz Stelluto"><meta property="article:published_time" content="2022-08-23T00:00:00.000Z">

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://gotofritz.net/blog/migrating-youtube-playlists-by-adding-videos-via-cli/">
<meta property="twitter:title" content="Adding videos to a youtube playlists via a terminal python script">
<meta property="twitter:description" content="I wanted to duplicate another user's playlist to one of my free google accounts. But it's no longer possible from the web interface. None of <a href=&#34;https://webapps.stackexchange.com/questions/39686/how-to-copy-youtube-playlist-from-one-account-to-another&#34; title=&#34;read those answers in Stack Overflow&#34;>the methods described in various SO answers</a> are functional, they are obsolete. But it can be done with a Python script in your terminal.">
<meta property="twitter:image" content="https://gotofritz.net/og-image/migrating-youtube-playlists-by-adding-videos-via-cli.png">

<!-- RSS auto-discovery -->
<link rel="alternate" type="application/rss+xml" title="gotofritz.net" href="/rss.xml">
    <script>(function(){const siteConfig = {"author":"Fritz Stelluto","title":"gotofritz.net","description":"Hello, I'm Fritz, an experienced engineer based in Berlin. Currently I am working at Trawa, focusing on service development and ML Ops.","lang":"en-GB","ogLocale":"en_GB","themeColorLight":"#fafafa","themeColorDark":"#1d1f21"};

      const root = document.documentElement;
      const colorThemeMetaTag = document.querySelector("meta[name='theme-color']");

      // get user preference of dark mode, 1st local storage, 2nd browser
      function getThemePreference() {
        if (typeof localStorage !== "undefined" && localStorage.getItem("theme")) {
          return localStorage.getItem("theme");
        }
        return window.matchMedia("(prefers-color-scheme: dark)").matches
          ? "dark"
          : "light";
      }

      const isDark = getThemePreference() === "dark";

      // watch document element class attribute and update user preference when it changes.
      const observer = new MutationObserver(() => {
        const rootIsDark = root.classList.contains("dark");
        // set the meta attribute
        colorThemeMetaTag.setAttribute(
          "content",
          siteConfig[rootIsDark ? "themeColorDark" : "themeColorLight"]
        );
        // store user preference
        if (typeof localStorage !== "undefined") {
          localStorage.setItem("theme", rootIsDark ? "dark" : "light");
        }
      });
      observer.observe(root, { attributeFilter: ["class"] });

      // initailse root class attribute
      root.classList.toggle("dark", isDark);
    })();</script>
  <link rel="stylesheet" href="/_astro/_...post_.3353b40d.css" /><script type="module" src="/_astro/hoisted.99e77f46.js"></script>
<script type="module" src="/_astro/page.b7cc8384.js"></script></head>
  <body>
    <a href="#main" class="sr-only focus:not-sr-only focus:fixed focus:top-1.5 focus:left-1">skip to content
</a>
    <header id="main-header" class="group mb-12 flex flex-wrap items-center justify-start gap-y-8 sm:mb-28 sm:gap-y-0">
  <a href="/" class="order-1 block grow-0 items-center grayscale hover:filter-none">
    <svg class="h-10 w-10 rounded-md bg-black dark:bg-white sm:mr-0 sm:h-[4.25rem] sm:w-[4.25rem]" aria-hidden="true" focusable="false" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
      <g>
        <path id="path-goto" d="M 123.8 88 L 52 88 L 52 194.7 L 87 194.7 L 87 159.6 L 70 159.6 L 70 123.6 L 124 123 L 124 230 L 17 230 C 17 230 17 17 17 52 C 17 52 124 52 124 52 L 124 88 L 123.8 88 Z M 176.25 194.684 C 176.25 194.684 210.52 194.684 210.52 194.684 C 210.52 194.684 211 89 211 89 C 211 89 176 89 176 89 C 176 89 176 195 176 195 L 176.25 194.684 Z M 246 230 L 140 230 C 140 230 140 52 140 52 C 140 52 247 52 247 52 C 247 52 246 230 246 230 Z M 334 230 L 297 230 L 298.27 88.527 L 263.02 88.527 C 263.02 88.527 263 52 263 52 C 263 52 369 52 369 52 C 369 52 369.75 88.527 369.75 88.527 L 334.5 88.527 L 334 230 Z M 422.25 194.684 C 422.25 194.684 456.52 194.684 456.52 194.684 C 456.52 194.684 456 88.79 456 88.79 C 456 88.79 422 88.79 422 88.79 C 422 88.79 422.25 194.684 422.25 194.684 Z M 492 230 L 386 230 C 386 230 386 52 386 52 C 386 52 492 52 492 52 L 492 230 Z" class="fill-white stroke-none dark:fill-black">
          <title>GOTO</title>
        </path>
      </g>
      <g>
        <path id="path-fritz" stroke-width="1" d="M 51 461 L 17 461 L 17 294 L 100 294 L 100 327.337 L 51 327.375 L 51 361.722 L 100 361.685 L 100 395.022 L 51 395.06 L 51 461 Z M 150 327.375 C 150 327.375 150 361.722 150 361.722 C 150 361.722 182 361.685 182 361.685 C 182 361.685 182 327.337 182 327.337 C 182 327.337 150 327.375 150 327.375 Z M 150 461 L 116 461 L 116 294 L 199.5 294.037 L 200 311.174 L 216 311.211 L 216 378.859 L 200 378.859 L 200 395.022 L 216 395.022 L 216 461 L 182 461 L 182 395.022 L 150 395.06 L 150 461 Z M 265 461.697 L 231.1 461 L 231 294 L 265 294.037 L 265 461 L 265 461.697 Z M 347 461.697 L 313 461 L 313 327.337 L 280 327.337 L 280 294 L 380 294.037 L 380 327.375 L 347 327.375 L 347 461 L 347 461.697 Z M 495 461.697 L 395 461 L 395 394.517 L 411.58 394.524 L 411.58 377.856 L 428.08 377.856 L 428.08 361.722 L 444.58 361.722 L 444.58 344.549 L 462 344.511 L 461.08 327.375 L 395 327.337 L 395 294 L 495 294.037 L 495 345.559 L 478.5 345.559 L 478.5 361.722 L 462 361.722 L 462 377.886 L 445 377.848 L 445 395.022 L 429 395.06 L 429 429.407 L 495 429.407 L 495 461 L 495 461.697 Z M 462 361.722 L 478 361.685 L 462 361.722 Z M 478.5 345.559 L 495 345.559 L 478 345.521 L 478.5 345.559 Z" class="fill-white stroke-none dark:fill-black">
          <title>FRITZ</title>
        </path>
      </g>
    </svg></a>
  
  

<theme-toggle class="ml-auto order-3 sm:order-3">
  <button type="button" id="toggle-theme" class="group relative h-10 w-10 rounded-md bg-zinc-200 p-2 ring-zinc-400 transition-all hover:ring-2 dark:bg-zinc-700" aria-label="Toggle Dark Mode">
    <svg id="sun-svg" class="absolute top-1/2 left-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all group-aria-pressed:scale-100 group-aria-pressed:opacity-100" aria-hidden="true" focusable="false" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
      <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
      <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
      <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
      <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
      <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
      <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
      <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
      <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
    </svg>
    <svg id="moon-svg" class="absolute top-1/2 left-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all group-aria-[pressed=false]:scale-100 group-aria-[pressed=false]:opacity-100" aria-hidden="true" focusable="false" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="1.5"></circle>
      <path d="M7.63262 3.06689C8.98567 3.35733 9.99999 4.56025 9.99999 6.00007C9.99999 7.65693 8.65685 9.00007 6.99999 9.00007C5.4512 9.00007 4.17653 7.82641 4.01685 6.31997" stroke="currentColor" stroke-width="1.5"></path>
      <path d="M22 13.0505C21.3647 12.4022 20.4793 12 19.5 12C17.567 12 16 13.567 16 15.5C16 17.2632 17.3039 18.7219 19 18.9646" stroke="currentColor" stroke-width="1.5"></path>
      <path d="M14.5 8.51L14.51 8.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
      <path d="M10 17C11.1046 17 12 16.1046 12 15C12 13.8954 11.1046 13 10 13C8.89543 13 8 13.8954 8 15C8 16.1046 8.89543 17 10 17Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
    </svg>
  </button>
</theme-toggle>
  <nav id="navigation-menu" class="flex gap-y-4 grow sm:grow-no items-end sm:flex-row sm:flex sm:items-center sm:mt-1 sm:py-0 sm:ml-8 text-accent order-2 sm:order-2 justify-around sm:justify-start" aria-label="Main menu">
    <a href="/" class="px-2 py-4 sm:py-0 sm:hover:underline" rel="prefetch">
      Home
    </a>
    <a href="/about" class="px-2 py-4 sm:py-0 sm:hover:underline" rel="prefetch">
      About
    </a>
    <a href="/blog" class="px-2 py-4 sm:py-0 sm:hover:underline" rel="prefetch">
      Blog
    </a>
    <a href="/fritz-stelluto_resume.pdf" class="px-2 py-4 sm:py-0 sm:hover:underline hidden sm:block">Resume</a>
  </nav>
</header>
    <main id="main" class="flex-1">
      <div class="sm:grid sm:grid-cols-4 sm:items-start sm:gap-x-10">
    <article class="col-span-3 break-words">
      <div id="blog-hero"><h1 class="title mb-1 text-5xl">Adding videos to a youtube playlists via a terminal python script</h1>
<time datetime="2022-08-23T00:00:00.000Z">23 Aug 2022 </time>
<div class="before:content-['|'] inline">
      <svg aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" class="inline-block h-6 w-6" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <path d="M7.859 6h-2.834a2.025 2.025 0 0 0 -2.025 2.025v2.834c0 .537 .213 1.052 .593 1.432l6.116 6.116a2.025 2.025 0 0 0 2.864 0l2.834 -2.834a2.025 2.025 0 0 0 0 -2.864l-6.117 -6.116a2.025 2.025 0 0 0 -1.431 -.593z"></path>
          <path d="M17.573 18.407l2.834 -2.834a2.025 2.025 0 0 0 0 -2.864l-7.117 -7.116"></path>
          <path d="M6 9h-.01"></path>
        </svg>
      <a class="inline-block pr-1" aria-label="View more blogs with the tag Google" href="/tags/Google">
          #Google
        </a><a class="inline-block pr-1" aria-label="View more blogs with the tag YouTubeApi" href="/tags/YouTubeApi">
          #YouTubeApi
        </a><a class="inline-block pr-1" aria-label="View more blogs with the tag Python" href="/tags/Python">
          #Python
        </a>
    </div>
<p class="mt-8 text-xl leading-7">I wanted to duplicate another user's playlist to one of my free google accounts. But it's no longer possible from the web interface. None of <a href="https://webapps.stackexchange.com/questions/39686/how-to-copy-youtube-playlist-from-one-account-to-another" title="read those answers in Stack Overflow">the methods described in various SO answers</a> are functional, they are obsolete. But it can be done with a Python script in your terminal.</p></div>
      <div class="prose prose-l prose-cactus mt-12 prose-headings:font-semibold prose-headings:before:absolute prose-headings:before:-ml-4 prose-headings:before:text-accent prose-headings:before:content-['#'] prose-th:before:content-none">
        <h2 id="copying-another-users-playlist-why">Copying another user’s playlist? Why?</h2>
<p>It all began when Google decided to start charging me for using my own domain name on their servers. I don’t mind paying for the service, but if I’m paying then I can shop around. Google is not the only game in town. Having decided to move away, the next step was to migrate the data. There is not much I can do with YouTube data. Either I download the videos and store them myself (which I do, for some videos). Or transfer the playlists to a different user account, a free one. But one doesn’t simple “transfer a playlist” on YouTube. You need to create a script and register to access their api. And this is what this post is all about</p>
<h2 id="step-0-set-up-the-python-project">Step 0: set up the python project</h2>
<p>Since this is going to be a python project, let’s set it up that way.</p>
<p>Started by creating a folder on my local machine. Then initialised the project with poetry and the right version of python</p>
<pre is:raw="" class="astro-code" style="background-color: #272822; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #F8F8F2">❯ mkdir my-project </span><span style="color: #F92672">&#x26;&#x26;</span><span style="color: #F8F8F2"> </span><span style="color: #66D9EF">cd</span><span style="color: #F8F8F2"> my-project</span></span>
<span class="line"><span style="color: #F8F8F2">❯ python -V</span></span>
<span class="line"><span style="color: #F8F8F2">3.8.5</span></span>
<span class="line"><span style="color: #F8F8F2">❯ pyenv </span><span style="color: #F92672">local</span><span style="color: #F8F8F2"> 3.10.1</span></span>
<span class="line"><span style="color: #F8F8F2">...</span></span>
<span class="line"><span style="color: #F8F8F2">❯ python -V</span></span>
<span class="line"><span style="color: #F8F8F2">3.10.1</span></span>
<span class="line"><span style="color: #F8F8F2">❯ poetry init</span></span>
<span class="line"><span style="color: #F8F8F2">... accept all default except </span><span style="color: #F92672">for</span></span>
<span class="line"><span style="color: #F8F8F2">... </span><span style="color: #E6DB74">`Would you like to define your main dependencies interactively</span><span style="color: #F92672">?</span><span style="color: #E6DB74">`</span></span>
<span class="line"><span style="color: #F8F8F2">❯ poetry shell</span></span>
<span class="line"><span style="color: #F8F8F2">/Users/gotofritz/Library/Caches/pypoetry/virtualenvs/youtube-migration--G8ptBqy-py3.10</span></span></code></pre>
<p>Set up VScode to use the poetry environment. To do that I click on the status bar at the bottom right of the editor, where it shows the python version. Clicking it brings up a list of possible python runtimes. I paste in the path that was given when I run <code>poetry shell</code>, plus the fragment <code>bin/python3.10</code> - i.e., <code>/Users/gotofritz/Library/Caches/pypoetry/virtualenvs/youtube-migration--G8ptBqy-py3.10/bin/python3.10</code></p>
<p>Then I added the dependencies - for now just the black formatter. My VSCode is set up to format on save and use Black as default formatter, so if it’s there it will find it and use it</p>
<pre is:raw="" class="astro-code" style="background-color: #272822; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #F8F8F2">❯ poetry add -D black</span></span></code></pre>
<p>I created a <code>.gitignore</code> with settings for python and VSCode, and initialised the git project</p>
<pre is:raw="" class="astro-code" style="background-color: #272822; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #88846F"># toptal.com offers a free, comprehensive .gitignore generator</span></span>
<span class="line"><span style="color: #F8F8F2">❯ curl -L https://www.toptal.com/developers/gitignore/api/python,visualstudiocode </span><span style="color: #F92672">></span><span style="color: #F8F8F2"> .gitignore</span></span>
<span class="line"><span style="color: #F8F8F2">❯ git init</span></span>
<span class="line"><span style="color: #F8F8F2"> ... accept all defaults</span></span></code></pre>
<p>Now I’m ready to start</p>
<h2 id="step-1-download-the-playlist-information-as-csv-files">Step 1: download the playlist information as CSV files</h2>
<p>This step only applies because the source account, the one I am copying the playlist from, is mine. Later on I will make this step general and replace it with a script too. But for now, a manual download is fine. There isn’t much to it - you just go to the <a href="https://takeout.google.com/settings/takeout/">google takeout page</a> and follow the instructions there. The result is a zip file. Inside the zip a folder called <code>playlists</code>, full of CSV files. That’s what we are after.</p>
<p>(<em>TODO: Fetch playlists using the same API I use for creating them.</em>)</p>
<h2 id="step-2-preprocess-the-youtube-takeout-data-and-concat-into-a-single-file">Step 2: preprocess the youtube takeout data and concat into a single file</h2>
<p>The takeout data has one file per playlist. For reasons that will become clear later (spoiler: it’s to do with API quotas), I prefer working with a single CSV file. That means two things. First, concatenating the csvs, and removing unneeded metadata at the top as I do so. Second, for each row, adding the playlist id in a new spreadsheet column. That means those playlists must already exist; I go and create them manually in the YouTube page. I then rename each CSV file with the id of the playlist the videos in that file will go to. A bit of a hack, but sufficient for a quick one-off job.</p>
<p>(<em>TODO: later on I could also automate the playlist creation.</em>)</p>
<p>Pandas is the standard library for CSV massaging in python, although I could get away with the built-in csv module. So the first step is installing it</p>
<pre is:raw="" class="astro-code" style="background-color: #272822; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #F8F8F2">❯ poetry add pandas</span></span>
<span class="line"><span style="color: #F8F8F2">Using version ^1.4.3 </span><span style="color: #F92672">for</span><span style="color: #F8F8F2"> pandas</span></span>
<span class="line"><span style="color: #F8F8F2">...</span></span></code></pre>
<p>The initial script just finds the source csv files and list them. Note the <code>skiprows=3</code> in the read_csv - that’s because the playlist files have 3 lines of metadata at the top.</p>
<pre is:raw="" class="astro-code" style="background-color: #272822; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #88846F"># csv-concat.py</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F92672">from</span><span style="color: #F8F8F2"> pathlib </span><span style="color: #F92672">import</span><span style="color: #F8F8F2"> Path</span></span>
<span class="line"><span style="color: #F92672">import</span><span style="color: #F8F8F2"> pandas </span><span style="color: #F92672">as</span><span style="color: #F8F8F2"> pd</span></span>
<span class="line"></span>
<span class="line"><span style="color: #AE81FF">SOURCE_DIR</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> Path(</span><span style="color: #E6DB74">"~/Downloads/takeout/playlists"</span><span style="color: #F8F8F2">)</span></span>
<span class="line"><span style="color: #AE81FF">TARGET_DIR</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> Path(</span><span style="color: #E6DB74">"./data"</span><span style="color: #F8F8F2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #66D9EF">def</span><span style="color: #F8F8F2"> </span><span style="color: #A6E22E">get_csv_files</span><span style="color: #F8F8F2">():</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #F92672">for</span><span style="color: #F8F8F2"> p </span><span style="color: #F92672">in</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">SOURCE_DIR</span><span style="color: #F8F8F2">.glob(</span><span style="color: #E6DB74">"*.csv"</span><span style="color: #F8F8F2">):</span></span>
<span class="line"><span style="color: #F8F8F2">        df </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> pd.read_csv(</span><span style="color: #AE81FF">SOURCE_DIR</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">/</span><span style="color: #F8F8F2"> p.name, </span><span style="color: #FD971F">skiprows</span><span style="color: #F92672">=</span><span style="color: #AE81FF">3</span><span style="color: #F8F8F2">)</span></span>
<span class="line"><span style="color: #F8F8F2">        </span><span style="color: #66D9EF">print</span><span style="color: #F8F8F2">(df)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #66D9EF">def</span><span style="color: #F8F8F2"> </span><span style="color: #A6E22E">main</span><span style="color: #F8F8F2">():</span></span>
<span class="line"><span style="color: #F8F8F2">    get_csv_files()</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F92672">if</span><span style="color: #F8F8F2"> __name__ </span><span style="color: #F92672">==</span><span style="color: #F8F8F2"> </span><span style="color: #E6DB74">"__main__"</span><span style="color: #F8F8F2">:</span></span>
<span class="line"><span style="color: #F8F8F2">    main()</span></span></code></pre>
<p>After a few iterations I ended up with this. It concats the csv files to a csv with the timestamp in its name. The <code>with_timestamp</code> I will probably reuse later</p>
<pre is:raw="" class="astro-code" style="background-color: #272822; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #F92672">from</span><span style="color: #F8F8F2"> pathlib </span><span style="color: #F92672">import</span><span style="color: #F8F8F2"> Path</span></span>
<span class="line"><span style="color: #F92672">import</span><span style="color: #F8F8F2"> pandas </span><span style="color: #F92672">as</span><span style="color: #F8F8F2"> pd</span></span>
<span class="line"><span style="color: #F92672">from</span><span style="color: #F8F8F2"> datetime </span><span style="color: #F92672">import</span><span style="color: #F8F8F2"> datetime</span></span>
<span class="line"></span>
<span class="line"><span style="color: #AE81FF">SOURCE_DIR</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> Path(</span><span style="color: #E6DB74">"~/Downloads/takeout/playlists"</span><span style="color: #F8F8F2">)</span></span>
<span class="line"><span style="color: #AE81FF">TARGET_DIR</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> Path(</span><span style="color: #E6DB74">"./data"</span><span style="color: #F8F8F2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #66D9EF">def</span><span style="color: #F8F8F2"> </span><span style="color: #A6E22E">with_timestamp</span><span style="color: #F8F8F2">(</span><span style="color: #FD971F">stem</span><span style="color: #F8F8F2">: </span><span style="color: #66D9EF">str</span><span style="color: #F8F8F2">) -> </span><span style="color: #66D9EF">str</span><span style="color: #F8F8F2">:</span></span>
<span class="line"><span style="color: #F8F8F2">    dt </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> datetime.now()</span></span>
<span class="line"><span style="color: #F8F8F2">    dt_string </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> dt.strftime(</span><span style="color: #E6DB74">"%Y%m</span><span style="color: #AE81FF">%d</span><span style="color: #E6DB74">T%H%M%S"</span><span style="color: #F8F8F2">)</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #F92672">return</span><span style="color: #F8F8F2"> dt_string </span><span style="color: #F92672">+</span><span style="color: #F8F8F2"> </span><span style="color: #E6DB74">"_"</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">+</span><span style="color: #F8F8F2"> stem</span></span>
<span class="line"></span>
<span class="line"><span style="color: #66D9EF">def</span><span style="color: #F8F8F2"> </span><span style="color: #A6E22E">get_csv_files</span><span style="color: #F8F8F2">():</span></span>
<span class="line"><span style="color: #F8F8F2">    csvs </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> []</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #F92672">for</span><span style="color: #F8F8F2"> p </span><span style="color: #F92672">in</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">SOURCE_DIR</span><span style="color: #F8F8F2">.glob(</span><span style="color: #E6DB74">"*.csv"</span><span style="color: #F8F8F2">):</span></span>
<span class="line"><span style="color: #F8F8F2">        </span><span style="color: #66D9EF">print</span><span style="color: #F8F8F2">(</span><span style="color: #66D9EF">f</span><span style="color: #E6DB74">"reading </span><span style="color: #AE81FF">{</span><span style="color: #F8F8F2">p.name</span><span style="color: #AE81FF">}</span><span style="color: #E6DB74">"</span><span style="color: #F8F8F2">)</span></span>
<span class="line"><span style="color: #F8F8F2">        playlist </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> Path(p.name).stem</span></span>
<span class="line"><span style="color: #F8F8F2">        df </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> pd.read_csv(</span><span style="color: #AE81FF">SOURCE_DIR</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">/</span><span style="color: #F8F8F2"> p.name, </span><span style="color: #FD971F">skiprows</span><span style="color: #F92672">=</span><span style="color: #AE81FF">3</span><span style="color: #F8F8F2">)</span></span>
<span class="line"><span style="color: #F8F8F2">        df[</span><span style="color: #E6DB74">"Status"</span><span style="color: #F8F8F2">] </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> pd.Series([</span><span style="color: #E6DB74">""</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">for</span><span style="color: #F8F8F2"> x </span><span style="color: #F92672">in</span><span style="color: #F8F8F2"> </span><span style="color: #66D9EF">range</span><span style="color: #F8F8F2">(</span><span style="color: #66D9EF">len</span><span style="color: #F8F8F2">(df.index))])</span></span>
<span class="line"><span style="color: #F8F8F2">        df[</span><span style="color: #E6DB74">"Playlist ID"</span><span style="color: #F8F8F2">] </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> pd.Series([playlist </span><span style="color: #F92672">for</span><span style="color: #F8F8F2"> x </span><span style="color: #F92672">in</span><span style="color: #F8F8F2"> </span><span style="color: #66D9EF">range</span><span style="color: #F8F8F2">(</span><span style="color: #66D9EF">len</span><span style="color: #F8F8F2">(df.index))])</span></span>
<span class="line"><span style="color: #F8F8F2">        csvs.append(df)</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #F92672">return</span><span style="color: #F8F8F2"> pd.concat(csvs)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #66D9EF">def</span><span style="color: #F8F8F2"> </span><span style="color: #A6E22E">main</span><span style="color: #F8F8F2">():</span></span>
<span class="line"><span style="color: #F8F8F2">    concatenated_df </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> get_csv_files()</span></span>
<span class="line"><span style="color: #F8F8F2">    destination_csv </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">TARGET_DIR</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">/</span><span style="color: #F8F8F2"> with_timestamp(</span><span style="color: #E6DB74">"data.csv"</span><span style="color: #F8F8F2">)</span></span>
<span class="line"><span style="color: #F8F8F2">    concatenated_df.to_csv(destination_csv, </span><span style="color: #FD971F">index</span><span style="color: #F92672">=</span><span style="color: #AE81FF">False</span><span style="color: #F8F8F2">)</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #66D9EF">print</span><span style="color: #F8F8F2">(</span><span style="color: #66D9EF">f</span><span style="color: #E6DB74">"Created </span><span style="color: #AE81FF">{</span><span style="color: #F8F8F2">destination_csv</span><span style="color: #AE81FF">}</span><span style="color: #E6DB74">"</span><span style="color: #F8F8F2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F92672">if</span><span style="color: #F8F8F2"> __name__ </span><span style="color: #F92672">==</span><span style="color: #F8F8F2"> </span><span style="color: #E6DB74">"__main__"</span><span style="color: #F8F8F2">:</span></span>
<span class="line"><span style="color: #F8F8F2">    main()</span></span></code></pre>
<p>It does the job</p>
<pre is:raw="" class="astro-code" style="background-color: #272822; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #F8F8F2">❯ python csv-concat.py</span></span>
<span class="line"><span style="color: #F8F8F2">reading PLZ6Ih9wLHQ2H1u5cOpSWgVGsn8YLWMmdy.csv</span></span>
<span class="line"><span style="color: #F8F8F2">reading PLZ6Ih9wLHQ2Em6nwtgGZ9q-eBRlSSbDRU.csv</span></span>
<span class="line"><span style="color: #F8F8F2">reading PLZ6Ih9wLHQ2HDOnRZaKQSWz8R4II0163v.csv</span></span>
<span class="line"><span style="color: #F8F8F2">reading PLZ6Ih9wLHQ2FDvivyW8_xcp6qG4-D45yh.csv</span></span>
<span class="line"><span style="color: #F8F8F2">Created data/20220828T170021_data.csv</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">❯ head -n 3 data/20220828T170021_data.csv</span></span>
<span class="line"><span style="color: #F8F8F2">Video ID,Time Added,Status,Playlist ID</span></span>
<span class="line"><span style="color: #F8F8F2">nmdUMwlrezs,2022-05-01 16:28:50 UTC,,PLZ6Ih9wLHQ2H1u5cOpSWgVGsn8YLWMmdy</span></span>
<span class="line"><span style="color: #F8F8F2">8qIMIAG5Z_E,2022-05-01 16:31:08 UTC,,PLZ6Ih9wLHQ2H1u5cOpSWgVGsn8YLWMmdy</span></span></code></pre>
<p>As a final step, I add a <code>.gitkeep</code> file to the <code>data/</code> folder, and then add the rest of that folder to <code>.gitignore</code></p>
<pre is:raw="" class="astro-code" style="background-color: #272822; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #F8F8F2">❯ touch data/.gitkeep</span></span>
<span class="line"><span style="color: #F8F8F2">❯ </span><span style="color: #66D9EF">echo</span><span style="color: #F8F8F2"> </span><span style="color: #E6DB74">"data/*.csv"</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">>></span><span style="color: #F8F8F2"> .gitignore</span></span>
<span class="line"><span style="color: #F8F8F2">❯ git add -a </span><span style="color: #66D9EF">.</span></span>
<span class="line"><span style="color: #F8F8F2">❯ git commit -m </span><span style="color: #E6DB74">"initial commit"</span></span></code></pre>
<h2 id="step-3-setting-up-a-gcp-project-and-getting-youtube-api-access">Step 3: setting up a GCP project and getting YouTube API access</h2>
<ol>
<li>
<p>Went to <a href="https://console.developers.google.com/">https://console.developers.google.com/</a> with my free Google account, created a new project</p>
</li>
<li>
<p>Searched for ‘YouTube API’ and enabled it</p>
</li>
<li>
<p>Clicked on ‘credentials’ on side bar, and then ‘Configure consent screen’. I had to pick ‘External’. Added the email address and a made up app name in the next screen.</p>
</li>
<li>
<p>Click on ‘add scopes’ and find the YouTube API ones in the list. Select them all and clicked on ‘save’</p>
</li>
<li>
<p>In the next screen, added myself as a test user, then ‘Save and Continue’</p>
</li>
<li>
<p>Back on ‘credentials’ on side bar, then <code>Create OAuth client ID</code>. Picked <code>OAuth Client Id</code></p>
</li>
<li>
<p>In the next screen I entered some app details. NOTE: Type should not be “web application”, but “desktop app”. Clicked on “create” and then “download JSON” in the modal box on the next screen</p>
</li>
<li>
<p>Moved the <code>client_json_xxxxx</code> file and playlists files to my project folder. Don’t forget to add to .gitignore!</p>
<pre is:raw="" class="astro-code" style="background-color: #272822; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #F8F8F2">❯ cp </span><span style="color: #F92672">~</span><span style="color: #F8F8F2">/Downloads/client....json client_secret.json</span></span>
<span class="line"><span style="color: #F8F8F2">❯ </span><span style="color: #66D9EF">echo</span><span style="color: #F8F8F2"> </span><span style="color: #E6DB74">"client_secret.json"</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">>></span><span style="color: #F8F8F2"> .gitignore</span></span></code></pre>
</li>
</ol>
<h2 id="step-4-read-and-manage-csv-files-with-list-of-video-ids-to-add-to-playlist">Step 4: Read and manage csv files with list of video ids to add to playlist</h2>
<p>I now start with the python script that adds the songs to the playlist. The first iteration will simply read a timestamped CSV file with pandas, and copy it to a new timestamped CSV file. This is needed because of quotas. Basically you won’t be able to run the whole job in one go. Google limits the amount of calls you can make. You will have to run it a bit every day, and carry on from where you left off the previous day.</p>
<pre is:raw="" class="astro-code" style="background-color: #272822; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #88846F"># uploader.py</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F92672">import</span><span style="color: #F8F8F2"> pandas </span><span style="color: #F92672">as</span><span style="color: #F8F8F2"> pd</span></span>
<span class="line"><span style="color: #F92672">from</span><span style="color: #F8F8F2"> datetime </span><span style="color: #F92672">import</span><span style="color: #F8F8F2"> datetime</span></span>
<span class="line"><span style="color: #F92672">from</span><span style="color: #F8F8F2"> pathlib </span><span style="color: #F92672">import</span><span style="color: #F8F8F2"> Path</span></span>
<span class="line"></span>
<span class="line"><span style="color: #AE81FF">DATA_DIR</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> Path(</span><span style="color: #E6DB74">"./data"</span><span style="color: #F8F8F2">)</span></span>
<span class="line"><span style="color: #AE81FF">FILE_STEM</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #E6DB74">"data.csv"</span></span>
<span class="line"></span>
<span class="line"><span style="color: #66D9EF">def</span><span style="color: #F8F8F2"> </span><span style="color: #A6E22E">pick_latest_file</span><span style="color: #F8F8F2">(</span><span style="color: #FD971F">dir</span><span style="color: #F8F8F2">: Path) -> Path:</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #E6DB74">"""assume that all files have a timestamp in the name, and hence the</span></span>
<span class="line"><span style="color: #E6DB74">    last in the list is the most recent</span></span>
<span class="line"><span style="color: #E6DB74">    """</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #F92672">return</span><span style="color: #F8F8F2"> </span><span style="color: #66D9EF">sorted</span><span style="color: #F8F8F2">(</span><span style="color: #AE81FF">DATA_DIR</span><span style="color: #F8F8F2">.glob(</span><span style="color: #E6DB74">"*.csv"</span><span style="color: #F8F8F2">)).pop()</span></span>
<span class="line"></span>
<span class="line"><span style="color: #66D9EF">def</span><span style="color: #F8F8F2"> </span><span style="color: #A6E22E">with_timestamp</span><span style="color: #F8F8F2">(</span><span style="color: #FD971F">stem</span><span style="color: #F8F8F2">: </span><span style="color: #66D9EF">str</span><span style="color: #F8F8F2">) -> </span><span style="color: #66D9EF">str</span><span style="color: #F8F8F2">:</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #E6DB74">"""prepend a timestamp to a string. Typically used for filenames"""</span></span>
<span class="line"><span style="color: #F8F8F2">    dt </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> datetime.now()</span></span>
<span class="line"><span style="color: #F8F8F2">    dt_string </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> dt.strftime(</span><span style="color: #E6DB74">"%Y%m</span><span style="color: #AE81FF">%d</span><span style="color: #E6DB74">T%H%M%S"</span><span style="color: #F8F8F2">)</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #F92672">return</span><span style="color: #F8F8F2"> dt_string </span><span style="color: #F92672">+</span><span style="color: #F8F8F2"> </span><span style="color: #E6DB74">"_"</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">+</span><span style="color: #F8F8F2"> stem</span></span>
<span class="line"></span>
<span class="line"><span style="color: #66D9EF">def</span><span style="color: #F8F8F2"> </span><span style="color: #A6E22E">partly_processed_csv</span><span style="color: #F8F8F2">(</span><span style="color: #FD971F">source_df</span><span style="color: #F8F8F2">: pd.DataFrame) -> pd.DataFrame:</span></span>
<span class="line"><span style="color: #F8F8F2">    processed_df </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> source_df.copy()</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #E6DB74">""" THIS IS WHERE THE MAGIC WILL HAPPEN """</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #F92672">return</span><span style="color: #F8F8F2"> processed_df</span></span>
<span class="line"></span>
<span class="line"><span style="color: #66D9EF">def</span><span style="color: #F8F8F2"> </span><span style="color: #A6E22E">main</span><span style="color: #F8F8F2">():</span></span>
<span class="line"><span style="color: #F8F8F2">    source_file </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> pick_latest_file(</span><span style="color: #AE81FF">DATA_DIR</span><span style="color: #F8F8F2">)</span></span>
<span class="line"><span style="color: #F8F8F2">    source_df </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> pd.read_csv(source_file)</span></span>
<span class="line"><span style="color: #F8F8F2">    processed_df </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> partly_processed_csv(source_df)</span></span>
<span class="line"><span style="color: #F8F8F2">    latest_file </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> with_timestamp(</span><span style="color: #AE81FF">FILE_STEM</span><span style="color: #F8F8F2">)</span></span>
<span class="line"><span style="color: #F8F8F2">    processed_df.to_csv(</span><span style="color: #AE81FF">DATA_DIR</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">/</span><span style="color: #F8F8F2"> latest_file, </span><span style="color: #FD971F">index</span><span style="color: #F92672">=</span><span style="color: #AE81FF">False</span><span style="color: #F8F8F2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F92672">if</span><span style="color: #F8F8F2"> __name__ </span><span style="color: #F92672">==</span><span style="color: #F8F8F2"> </span><span style="color: #E6DB74">"__main__"</span><span style="color: #F8F8F2">:</span></span>
<span class="line"><span style="color: #F8F8F2">    main()</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #66D9EF">print</span><span style="color: #F8F8F2">(</span><span style="color: #E6DB74">"DONE"</span><span style="color: #F8F8F2">)</span></span></code></pre>
<p>Run it to test it works</p>
<pre is:raw="" class="astro-code" style="background-color: #272822; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #88846F"># see what we've got before starting</span></span>
<span class="line"><span style="color: #F8F8F2">❯ ls -1 data</span></span>
<span class="line"><span style="color: #F8F8F2">20220828T170021_data.csv</span></span>
<span class="line"><span style="color: #F8F8F2">20220828T172321_data.csv</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">❯ python uploader.py</span></span>
<span class="line"><span style="color: #F8F8F2">DONE</span></span>
<span class="line"></span>
<span class="line"><span style="color: #88846F"># we got a new file</span></span>
<span class="line"><span style="color: #F8F8F2">❯ ls -1 data</span></span>
<span class="line"><span style="color: #F8F8F2">20220828T170021_data.csv</span></span>
<span class="line"><span style="color: #F8F8F2">20220828T172321_data.csv</span></span>
<span class="line"><span style="color: #F8F8F2">20220828T225131_data.csv</span></span>
<span class="line"></span>
<span class="line"><span style="color: #88846F"># it is the same as the old one? YES - there is no output</span></span>
<span class="line"><span style="color: #F8F8F2">❯ diff data/20220828T225131_data.csv data/20220828T172321_data.csv</span></span>
<span class="line"></span></code></pre>
<h2 id="step-5-extract-video-and-playlist-ids-from-csv-rows">Step 5: Extract video and playlist IDs from csv rows</h2>
<p>For the next iteration I try to do as much of the work as I can without actually accessing the YouTube API. Working with it is time consuming because the constant signing in. <code>partly_processed_csv</code> will use pandas to iterate through the rows and process each file. <code>itertuples</code> has a bad rep in pandas, but in my case I need to stop and call an API at each iteration.</p>
<pre is:raw="" class="astro-code" style="background-color: #272822; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>DATA_DIR = Path("./data")</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>FILE_STEM = "data.csv"</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>COL_VIDEO_ID = "Video ID"</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>COL_STATUS = "Status"</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>COL_PLAYLIST_ID = "Playlist ID"</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>LABEL_DONE = "done"</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">...</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">def partly_processed_csv(source_df: pd.DataFrame) -> pd.DataFrame:</span></span>
<span class="line"><span style="color: #F8F8F2">    processed_df = source_df.copy()</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>    """ THIS IS WHERE THE MAGIC WILL HAPPEN """</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>    for row in processed_df.itertuples():</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>        data = processed_df.loc[row.Index, [COL_VIDEO_ID, COL_STATUS, COL_PLAYLIST_ID]]</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>        video_id, status, playlist_id = data.values</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>        if status == LABEL_DONE:</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>            continue</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>        try:</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>            print(f"-> Adding {video_id} to {playlist_id}")</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>            # TODO</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>            processed_df.at[row.Index, COL_STATUS] = LABEL_DONE</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>        except Exception as e:</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>            processed_df.at[row.Index, COL_STATUS] = e</span></span>
<span class="line"><span style="color: #F8F8F2">    return processed_df</span></span></code></pre>
<p>I run the command as before, this time the new csv file has ‘done’ in the column status for each row, as expected.</p>
<h2 id="step-6-connect-to-youtube-api">Step 6: connect to YouTube API</h2>
<p>It’s time to start accessing the YouTube API. First, install the dependencies</p>
<pre is:raw="" class="astro-code" style="background-color: #272822; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #F8F8F2">❯ poetry add google-auth google-auth-oauthlib google-auth-httplib2 google-api-python-client</span></span></code></pre>
<p>Then amend the script to test the connection works. The big change is that main function will be passed a client, which is created with the <code>get_authenticated_service</code> function. I copied that straight from the documentation.</p>
<pre is:raw="" class="astro-code" style="background-color: #272822; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #88846F"># uploader.py</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">import pandas as pd</span></span>
<span class="line"><span style="color: #F8F8F2">from datetime import datetime</span></span>
<span class="line"><span style="color: #F8F8F2">from pathlib import Path</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>import os</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>from googleapiclient.discovery import build</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>from google_auth_oauthlib.flow import InstalledAppFlow</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">..</span></span>
<span class="line"><span style="color: #F8F8F2">LABEL_DONE = "done"</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>CLIENT_SECRETS_FILE = "client_secret.json"</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span># This scope allows for full read/write</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span># access to the authenticated user's account</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span># and requires requests to use an SSL connection.</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>SCOPES = ["https://www.googleapis.com/auth/youtube.force-ssl"]</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>API_SERVICE_NAME = "youtube"</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>API_VERSION = "v3"</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>def get_authenticated_service():</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>    """straight from the YouTube API documentation"""</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>    flow = InstalledAppFlow.from_client_secrets_file(CLIENT_SECRETS_FILE, SCOPES)</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>    credentials = flow.run_console()</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>    return build(API_SERVICE_NAME, API_VERSION, credentials=credentials)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">def pick_latest_file(dir: Path) -> Path:</span></span>
<span class="line"><span style="color: #F8F8F2">...</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>def partly_processed_csv(source_df: pd.DataFrame) -> pd.DataFrame:</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>def partly_processed_csv(client, source_df: pd.DataFrame) -> pd.DataFrame:</span></span>
<span class="line"><span style="color: #F8F8F2">...</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>def main():</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>def main(client):</span></span>
<span class="line"><span style="color: #F8F8F2">    ...</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">if __name__ == "__main__":</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>    main()</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>    # When running locally, disable OAuthlib's</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>    # HTTPs verification. When running in production</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>    # * do not * leave this option enabled.</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>    os.environ["OAUTHLIB_INSECURE_TRANSPORT"] = "1"</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>    client = get_authenticated_service()</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>    main(client)</span></span>
<span class="line"><span style="color: #F8F8F2">    print("DONE")</span></span></code></pre>
<p>When it runs it stops and asks me for an authorisation code:</p>
<pre is:raw="" class="astro-code" style="background-color: #272822; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #F8F8F2">❯ python uploader.py</span></span>
<span class="line"><span style="color: #F8F8F2">Please visit this URL to authorize this application: \</span></span>
<span class="line"><span style="color: #F8F8F2">https://accounts.google.com/o/oauth2/auth</span><span style="color: #F92672">?</span><span style="color: #F8F8F2">response_type=code</span><span style="color: #F92672">&#x26;</span><span style="color: #F8F8F2">....etc...</span></span>
<span class="line"><span style="color: #F8F8F2">Enter the authorization code:</span></span></code></pre>
<p>I paste the URL in a browser, authenticate, copy the code, and paste it on the CLI. I have to do this every time I run the script, but it works</p>
<h2 id="step-7-add-videos-to-playlist-using-the-youtube-api">Step 7: add videos to playlist using the YouTube API</h2>
<p>The last step is to finally send the calls to the YouTube API and decode the response. The call itself is to <code>client.playlistItems().insert</code>. It takes a while to get the correct shape for the payload, but got there in the end. The try / except block listens for errors. A <code>quotaExceeded</code> error means I am done for the day, Google won’t accept any more calls from me. A <code>videoNotFound</code> error means the video has been deleted; no need to stop, but no point in trying again. Any other errors we’ll have to wait and see until they occur</p>
<pre is:raw="" class="astro-code" style="background-color: #272822; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span> LABEL_404 = "videoNotFound"</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span> LABEL_QUOTA_EXCEEDED = "quotaExceeded"</span></span>
<span class="line"><span style="color: #F8F8F2">...</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">def partly_processed_csv(client, source_df: pd.DataFrame) -> pd.DataFrame:</span></span>
<span class="line"><span style="color: #F8F8F2">    processed_df = source_df.copy()</span></span>
<span class="line"><span style="color: #F8F8F2">    for row in processed_df.itertuples():</span></span>
<span class="line"><span style="color: #F8F8F2">        data = processed_df.loc[row.Index, [COL_VIDEO_ID, COL_STATUS, COL_PLAYLIST_ID]]</span></span>
<span class="line"><span style="color: #F8F8F2">        video_id, status, playlist_id = data.values</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>        if status in [LABEL_DONE, LABEL_404]:</span></span>
<span class="line"><span style="color: #F8F8F2">            continue</span></span>
<span class="line"><span style="color: #F8F8F2">        try:</span></span>
<span class="line"><span style="color: #F8F8F2">            print(f"-> Adding {video_id} to {playlist_id}")</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>            response = (</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>                client.playlistItems()</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>                .insert(</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>                    part="snippet, contentDetails",</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>                    body={</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>                        "contentDetails": {"videoId": video_id},</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>                        "snippet": {</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>                            "playlistId": playlist_id,</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>                            "resourceId": {</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>                                "kind": "youtube#video",</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>                                "videoId": video_id,</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>                            },</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>                        },</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>                    },</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>                )</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>                .execute()</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>            )</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>            print(</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>                f" + {response['snippet']['title']} / "</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>                f"{response['snippet']['position']} in playlist"</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>            )</span></span>
<span class="line"><span style="color: #F8F8F2">            processed_df.at[row.Index, COL_STATUS] = LABEL_DONE</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>       except Exception as e:</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>       except HttpError as e:</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>            if e.error_details[0]["reason"] == LABEL_QUOTA_EXCEEDED:</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>                print(f">>>> Quota exceeded when trying to add {video_id}")</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>                return processed_df</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>            processed_df.at[row.Index, COL_STATUS] = e</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>            processed_df.at[row.Index, COL_STATUS] = e.error_details[0]["reason"]</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>            print(f">>>> ERROR {e.error_details[0]['message']}")</span></span>
<span class="line"><span style="color: #F8F8F2">    return processed_df</span></span></code></pre>
<p>Finally, let’s run it</p>
<pre is:raw="" class="astro-code" style="background-color: #272822; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #F8F8F2">❯ python uploader.py</span></span>
<span class="line"><span style="color: #F8F8F2">Please visit this URL to authorize this application:</span></span>
<span class="line"><span style="color: #F8F8F2"> https://accounts.google.com/o/oauth2/auth</span><span style="color: #F92672">?</span><span style="color: #F8F8F2">response_type=code</span><span style="color: #F92672">&#x26;</span><span style="color: #F8F8F2">client_id=xxxxx....</span></span>
<span class="line"><span style="color: #F8F8F2">Enter the authorization code: xxxx....</span></span>
<span class="line"><span style="color: #F8F8F2">-</span><span style="color: #F92672">></span><span style="color: #F8F8F2"> Adding RbjONfRaMDs to PLZ6Ih9wLHQ2HDOnRZaKQSWz8R4II0163v</span></span>
<span class="line"><span style="color: #F8F8F2">+ Hey, Uh, What You Say Come On / 178 </span><span style="color: #F92672">in</span><span style="color: #F8F8F2"> playlist</span></span>
<span class="line"><span style="color: #F8F8F2">-</span><span style="color: #F92672">></span><span style="color: #F8F8F2"> Adding bxN1xrLRvGU to PLZ6Ih9wLHQ2HDOnRZaKQSWz8R4II0163v</span></span>
<span class="line"><span style="color: #F8F8F2">>>>> ERROR </span><span style="color: #E6DB74">'Video not found.'</span></span>
<span class="line"><span style="color: #F8F8F2">-</span><span style="color: #F92672">></span><span style="color: #F8F8F2"> Adding B2qI6UDD2uQ to PLZ6Ih9wLHQ2HDOnRZaKQSWz8R4II0163v</span></span>
<span class="line"><span style="color: #F8F8F2">+ Donna Summer  I Feel Love Original  8 minute 12</span><span style="color: #E6DB74">" version 1977 / 179 in playlist</span></span>
<span class="line"><span style="color: #E6DB74">...</span></span>
<span class="line"><span style="color: #E6DB74">...</span></span>
<span class="line"><span style="color: #E6DB74">-> Adding F2QF_7N85lQ to PLZ6Ih9wLHQ2HDOnRZaKQSWz8R4II0163v</span></span>
<span class="line"><span style="color: #E6DB74">>>>> Quota exceeded when trying to add F2QF_7N85lQ</span></span>
<span class="line"><span style="color: #E6DB74">DONE</span></span></code></pre>
<p>Checking the generated CSV file, it has some rows marked as ‘done’, some with ‘videoNotFound’, and all the rows from ‘F2QF_7N85lQ’ on are untouched. Just as I expected. I shall do the rest tomorrow.</p>
<h2 id="step-8-avoiding-duplicates">Step 8: avoiding duplicates</h2>
<p>There was a bug in one of my early iterations. I hadn’t realised that the result of python’s <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path.glob">Pathlib.glob</a> are not ordered by default. So the script kept using the same CSV file and adding the same 100 video to my playlist. 600 videos later… I made <a href="/blog/deleting-duplicates-from-youtube-playlists-with-python-script">a post about the script I used to remove youtube duplicates</a>. But I also wanted to make sure duplicates wouldn’t get in in the first place, so I put a check for that. That also called for some refactoring.</p>
<p>First of all, the loop was getting too busy. So I moved all the video adding stuff to a new function, <code>add_another_video_to_playlist</code>, and created a new one for checking whether it should add the video at all</p>
<pre is:raw="" class="astro-code" style="background-color: #272822; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #F8F8F2">def partly_processed_csv(client, source_df: pd.DataFrame) -> pd.DataFrame:</span></span>
<span class="line"><span style="color: #F8F8F2">    processed_df = source_df.copy()</span></span>
<span class="line"><span style="color: #F8F8F2">    for row in processed_df.itertuples():</span></span>
<span class="line"><span style="color: #F8F8F2">        data = processed_df.loc[row.Index, [COL_VIDEO_ID, COL_STATUS, COL_PLAYLIST_ID]]</span></span>
<span class="line"><span style="color: #F8F8F2">        video_id, status, playlist_id = data.values</span></span>
<span class="line"><span style="color: #F8F8F2">        if status in [LABEL_DONE, LABEL_404]:</span></span>
<span class="line"><span style="color: #F8F8F2">            continue</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>       try:</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>            print(f"-> Adding {video_id} to {playlist_id}")</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>            response = (</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>                client.playlistItems()</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>                .insert(</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>                    part="snippet, contentDetails",</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>                    body={</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>                        "contentDetails": {"videoId": video_id},</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>                        "snippet": {</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>                            "playlistId": playlist_id,</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>                            "resourceId": {</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>                                "kind": "youtube#video",</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>                                "videoId": video_id,</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>                            },</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>                        },</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>                    },</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>                )</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>                .execute()</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>            )</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>            print(</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>                f" + {response['snippet']['title']} / "</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>                f"{response['snippet']['position']} in playlist"</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>            )</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>           processed_df.at[row.Index, COL_STATUS] = LABEL_DONE</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>       except HttpError as e:</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>            if e.error_details[0]["reason"] == LABEL_QUOTA_EXCEEDED:</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>                print(f">>>> Quota exceeded when trying to add {video_id}")</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>                return processed_df</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>            processed_df.at[row.Index, COL_STATUS] = e.error_details[0]["reason"]</span></span>
<span class="line"><span style="color: #F92672"><span style="user-select: none;">-</span>            print(f">>>> ERROR {e.error_details[0]['message']}")</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>       should_skip, reason = video_is_already_in_playlist(</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>           client, video_id=video_id, playlist_id=playlist_id</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>       )</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>       if should_skip:</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>           processed_df.at[row.Index, COL_STATUS] = reason</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>           continue</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>       should_stop, status = add_another_video_to_playlist(</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>           client, video_id=video_id, playlist_id=playlist_id</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>       )</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>       processed_df.at[row.Index, COL_STATUS] = status</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>       if should_stop:</span></span>
<span class="line"><span style="color: #A6E22E"><span style="user-select: none;">+</span>           return processed_df</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">    return processed_df</span></span></code></pre>
<p><code>video_is_already_in_playlist</code> returns a tuple, a boolean that tells you whether to skip to the next item in the list, and a string with the reason why (either yes, the video is already in the list, or an error)</p>
<pre is:raw="" class="astro-code" style="background-color: #272822; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #66D9EF">def</span><span style="color: #F8F8F2"> </span><span style="color: #A6E22E">video_is_already_in_playlist</span><span style="color: #F8F8F2">(</span><span style="color: #FD971F">client</span><span style="color: #F8F8F2">, </span><span style="color: #FD971F">video_id</span><span style="color: #F8F8F2">: </span><span style="color: #66D9EF">str</span><span style="color: #F8F8F2">, </span><span style="color: #FD971F">playlist_id</span><span style="color: #F8F8F2">: </span><span style="color: #66D9EF">str</span><span style="color: #F8F8F2">):</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #F92672">try</span><span style="color: #F8F8F2">:</span></span>
<span class="line"><span style="color: #F8F8F2">        </span><span style="color: #66D9EF">print</span><span style="color: #F8F8F2">(</span><span style="color: #66D9EF">f</span><span style="color: #E6DB74">"-> Searching whether </span><span style="color: #AE81FF">{</span><span style="color: #F8F8F2">video_id</span><span style="color: #AE81FF">}</span><span style="color: #E6DB74"> is already in </span><span style="color: #AE81FF">{</span><span style="color: #F8F8F2">playlist_id</span><span style="color: #AE81FF">}</span><span style="color: #E6DB74">"</span><span style="color: #F8F8F2">)</span></span>
<span class="line"><span style="color: #F8F8F2">        response </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> (</span></span>
<span class="line"><span style="color: #F8F8F2">            client.playlistItems()</span></span>
<span class="line"><span style="color: #F8F8F2">            .list(</span></span>
<span class="line"><span style="color: #F8F8F2">                </span><span style="color: #FD971F">part</span><span style="color: #F92672">=</span><span style="color: #E6DB74">"snippet, contentDetails"</span><span style="color: #F8F8F2">,</span></span>
<span class="line"><span style="color: #F8F8F2">                </span><span style="color: #FD971F">playlistId</span><span style="color: #F92672">=</span><span style="color: #F8F8F2">playlist_id,</span></span>
<span class="line"><span style="color: #F8F8F2">                </span><span style="color: #FD971F">videoId</span><span style="color: #F92672">=</span><span style="color: #F8F8F2">video_id,</span></span>
<span class="line"><span style="color: #F8F8F2">            )</span></span>
<span class="line"><span style="color: #F8F8F2">            .execute()</span></span>
<span class="line"><span style="color: #F8F8F2">        )</span></span>
<span class="line"><span style="color: #F8F8F2">        </span><span style="color: #F92672">if</span><span style="color: #F8F8F2"> </span><span style="color: #66D9EF">len</span><span style="color: #F8F8F2">(response[</span><span style="color: #E6DB74">"items"</span><span style="color: #F8F8F2">]) </span><span style="color: #F92672">></span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">0</span><span style="color: #F8F8F2">:</span></span>
<span class="line"><span style="color: #F8F8F2">            </span><span style="color: #66D9EF">print</span><span style="color: #F8F8F2">(</span><span style="color: #E6DB74">"... yes it is, doing next"</span><span style="color: #F8F8F2">)</span></span>
<span class="line"><span style="color: #F8F8F2">            </span><span style="color: #F92672">return</span><span style="color: #F8F8F2"> (</span><span style="color: #AE81FF">True</span><span style="color: #F8F8F2">, </span><span style="color: #AE81FF">LABEL_DONE</span><span style="color: #F8F8F2">)</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #F92672">except</span><span style="color: #F8F8F2"> HttpError </span><span style="color: #F92672">as</span><span style="color: #F8F8F2"> e:</span></span>
<span class="line"><span style="color: #F8F8F2">        </span><span style="color: #F92672">if</span><span style="color: #F8F8F2"> e.error_details[</span><span style="color: #AE81FF">0</span><span style="color: #F8F8F2">][</span><span style="color: #E6DB74">"reason"</span><span style="color: #F8F8F2">] </span><span style="color: #F92672">==</span><span style="color: #F8F8F2"> </span><span style="color: #E6DB74">"videoNotFound"</span><span style="color: #F8F8F2">:  </span><span style="color: #88846F"># type: ignore</span></span>
<span class="line"><span style="color: #F8F8F2">            </span><span style="color: #66D9EF">print</span><span style="color: #F8F8F2">(</span><span style="color: #66D9EF">f</span><span style="color: #E6DB74">">>>> Are you sure about this video? ID not found </span><span style="color: #AE81FF">{</span><span style="color: #F8F8F2">video_id</span><span style="color: #AE81FF">}</span><span style="color: #E6DB74">"</span><span style="color: #F8F8F2">)</span></span>
<span class="line"><span style="color: #F8F8F2">        </span><span style="color: #F92672">else</span><span style="color: #F8F8F2">:</span></span>
<span class="line"><span style="color: #F8F8F2">            </span><span style="color: #66D9EF">print</span><span style="color: #F8F8F2">(</span></span>
<span class="line"><span style="color: #F8F8F2">                </span><span style="color: #E6DB74">">>>> ERROR LOOKING FOR VIDEO IN PLAYLIST"</span></span>
<span class="line"><span style="color: #F8F8F2">                </span><span style="color: #66D9EF">f</span><span style="color: #E6DB74">"</span><span style="color: #AE81FF">{</span><span style="color: #F8F8F2">e.error_details[</span><span style="color: #AE81FF">0</span><span style="color: #F8F8F2">][</span><span style="color: #E6DB74">'message'</span><span style="color: #F8F8F2">]</span><span style="color: #AE81FF">}</span><span style="color: #E6DB74">"</span></span>
<span class="line"><span style="color: #F8F8F2">            )  </span><span style="color: #88846F"># type: ignore</span></span>
<span class="line"><span style="color: #F8F8F2">        </span><span style="color: #F92672">return</span><span style="color: #F8F8F2"> (</span><span style="color: #AE81FF">True</span><span style="color: #F8F8F2">, e.error_details[</span><span style="color: #AE81FF">0</span><span style="color: #F8F8F2">][</span><span style="color: #E6DB74">"reason"</span><span style="color: #F8F8F2">])</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #F92672">return</span><span style="color: #F8F8F2"> (</span><span style="color: #AE81FF">False</span><span style="color: #F8F8F2">, </span><span style="color: #AE81FF">None</span><span style="color: #F8F8F2">)</span></span></code></pre>
<p><code>add_another_video_to_playlist</code> also returns a tuple, a boolean that tells you whether the job should be stopped, and the status of the last video processed</p>
<pre is:raw="" class="astro-code" style="background-color: #272822; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #66D9EF">def</span><span style="color: #F8F8F2"> </span><span style="color: #A6E22E">add_another_video_to_playlist</span><span style="color: #F8F8F2">(</span><span style="color: #FD971F">client</span><span style="color: #F8F8F2">, </span><span style="color: #FD971F">video_id</span><span style="color: #F8F8F2">: </span><span style="color: #66D9EF">str</span><span style="color: #F8F8F2">, </span><span style="color: #FD971F">playlist_id</span><span style="color: #F8F8F2">: </span><span style="color: #66D9EF">str</span><span style="color: #F8F8F2">):</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #F92672">try</span><span style="color: #F8F8F2">:</span></span>
<span class="line"><span style="color: #F8F8F2">        </span><span style="color: #66D9EF">print</span><span style="color: #F8F8F2">(</span><span style="color: #66D9EF">f</span><span style="color: #E6DB74">"-> Adding </span><span style="color: #AE81FF">{</span><span style="color: #F8F8F2">video_id</span><span style="color: #AE81FF">}</span><span style="color: #E6DB74"> to </span><span style="color: #AE81FF">{</span><span style="color: #F8F8F2">playlist_id</span><span style="color: #AE81FF">}</span><span style="color: #E6DB74">"</span><span style="color: #F8F8F2">)</span></span>
<span class="line"><span style="color: #F8F8F2">        response </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> (</span></span>
<span class="line"><span style="color: #F8F8F2">            client.playlistItems()</span></span>
<span class="line"><span style="color: #F8F8F2">            .insert(</span></span>
<span class="line"><span style="color: #F8F8F2">                </span><span style="color: #FD971F">part</span><span style="color: #F92672">=</span><span style="color: #E6DB74">"snippet, contentDetails"</span><span style="color: #F8F8F2">,</span></span>
<span class="line"><span style="color: #F8F8F2">                </span><span style="color: #FD971F">body</span><span style="color: #F92672">=</span><span style="color: #F8F8F2">{</span></span>
<span class="line"><span style="color: #F8F8F2">                    </span><span style="color: #E6DB74">"contentDetails"</span><span style="color: #F8F8F2">: {</span><span style="color: #E6DB74">"videoId"</span><span style="color: #F8F8F2">: video_id},</span></span>
<span class="line"><span style="color: #F8F8F2">                    </span><span style="color: #E6DB74">"snippet"</span><span style="color: #F8F8F2">: {</span></span>
<span class="line"><span style="color: #F8F8F2">                        </span><span style="color: #E6DB74">"playlistId"</span><span style="color: #F8F8F2">: playlist_id,</span></span>
<span class="line"><span style="color: #F8F8F2">                        </span><span style="color: #E6DB74">"resourceId"</span><span style="color: #F8F8F2">: {</span></span>
<span class="line"><span style="color: #F8F8F2">                            </span><span style="color: #E6DB74">"kind"</span><span style="color: #F8F8F2">: </span><span style="color: #E6DB74">"youtube#video"</span><span style="color: #F8F8F2">,</span></span>
<span class="line"><span style="color: #F8F8F2">                            </span><span style="color: #E6DB74">"videoId"</span><span style="color: #F8F8F2">: video_id,</span></span>
<span class="line"><span style="color: #F8F8F2">                        },</span></span>
<span class="line"><span style="color: #F8F8F2">                    },</span></span>
<span class="line"><span style="color: #F8F8F2">                },</span></span>
<span class="line"><span style="color: #F8F8F2">            )</span></span>
<span class="line"><span style="color: #F8F8F2">            .execute()</span></span>
<span class="line"><span style="color: #F8F8F2">        )</span></span>
<span class="line"><span style="color: #F8F8F2">        </span><span style="color: #66D9EF">print</span><span style="color: #F8F8F2">(</span></span>
<span class="line"><span style="color: #F8F8F2">            </span><span style="color: #66D9EF">f</span><span style="color: #E6DB74">" + </span><span style="color: #AE81FF">{</span><span style="color: #F8F8F2">response[</span><span style="color: #E6DB74">'snippet'</span><span style="color: #F8F8F2">][</span><span style="color: #E6DB74">'title'</span><span style="color: #F8F8F2">]</span><span style="color: #AE81FF">}</span><span style="color: #E6DB74"> / "</span></span>
<span class="line"><span style="color: #F8F8F2">            </span><span style="color: #66D9EF">f</span><span style="color: #E6DB74">"</span><span style="color: #AE81FF">{</span><span style="color: #F8F8F2">response[</span><span style="color: #E6DB74">'snippet'</span><span style="color: #F8F8F2">][</span><span style="color: #E6DB74">'position'</span><span style="color: #F8F8F2">]</span><span style="color: #AE81FF">}</span><span style="color: #E6DB74"> in playlist"</span></span>
<span class="line"><span style="color: #F8F8F2">        )</span></span>
<span class="line"><span style="color: #F8F8F2">        </span><span style="color: #F92672">return</span><span style="color: #F8F8F2"> (</span><span style="color: #AE81FF">False</span><span style="color: #F8F8F2">, </span><span style="color: #AE81FF">LABEL_DONE</span><span style="color: #F8F8F2">)</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #F92672">except</span><span style="color: #F8F8F2"> HttpError </span><span style="color: #F92672">as</span><span style="color: #F8F8F2"> e:</span></span>
<span class="line"><span style="color: #F8F8F2">        </span><span style="color: #F92672">if</span><span style="color: #F8F8F2"> e.error_details[</span><span style="color: #AE81FF">0</span><span style="color: #F8F8F2">][</span><span style="color: #E6DB74">"reason"</span><span style="color: #F8F8F2">] </span><span style="color: #F92672">==</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">LABEL_QUOTA_EXCEEDED</span><span style="color: #F8F8F2">:  </span><span style="color: #88846F"># type: ignore</span></span>
<span class="line"><span style="color: #F8F8F2">            </span><span style="color: #66D9EF">print</span><span style="color: #F8F8F2">(</span><span style="color: #66D9EF">f</span><span style="color: #E6DB74">">>>> Quota exceeded when trying to add </span><span style="color: #AE81FF">{</span><span style="color: #F8F8F2">video_id</span><span style="color: #AE81FF">}</span><span style="color: #E6DB74">"</span><span style="color: #F8F8F2">)</span></span>
<span class="line"><span style="color: #F8F8F2">            </span><span style="color: #F92672">return</span><span style="color: #F8F8F2"> (</span><span style="color: #AE81FF">True</span><span style="color: #F8F8F2">, </span><span style="color: #AE81FF">LABEL_BLANK</span><span style="color: #F8F8F2">)</span></span>
<span class="line"><span style="color: #F8F8F2">        processed_df.at[row.Index, </span><span style="color: #AE81FF">COL_STATUS</span><span style="color: #F8F8F2">] </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> e.error_details[</span><span style="color: #AE81FF">0</span><span style="color: #F8F8F2">][</span><span style="color: #E6DB74">"reason"</span><span style="color: #F8F8F2">]  </span><span style="color: #88846F"># type: ignore</span></span>
<span class="line"><span style="color: #F8F8F2">        </span><span style="color: #66D9EF">print</span><span style="color: #F8F8F2">(</span><span style="color: #66D9EF">f</span><span style="color: #E6DB74">">>>> ERROR </span><span style="color: #AE81FF">{</span><span style="color: #F8F8F2">e.error_details[</span><span style="color: #AE81FF">0</span><span style="color: #F8F8F2">][</span><span style="color: #E6DB74">'message'</span><span style="color: #F8F8F2">]</span><span style="color: #AE81FF">}</span><span style="color: #E6DB74">"</span><span style="color: #F8F8F2">)  </span><span style="color: #88846F"># type: ignore</span></span>
<span class="line"><span style="color: #F8F8F2">        </span><span style="color: #F92672">return</span><span style="color: #F8F8F2"> (</span><span style="color: #AE81FF">False</span><span style="color: #F8F8F2">, e.error_details[</span><span style="color: #AE81FF">0</span><span style="color: #F8F8F2">][</span><span style="color: #E6DB74">"reason"</span><span style="color: #F8F8F2">])</span></span></code></pre>
<p>I then create an empty playlist, add a video manually, and then create a new csv file. That contains three rows: one for the video that I just added manually, one for a video that doesn’t exist, and one for a video that exist and should be added to the playlist.</p>
<pre is:raw="" class="astro-code" style="background-color: #272822; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #F8F8F2">Video ID,Time Added,Status,Playlist ID</span></span>
<span class="line"><span style="color: #F8F8F2">SoJVZh50bDo,2022-04-30 23:17:35 UTC,,PLZ6Ih9wLHQ2FEVn2-NsdlTZnS86-GCFOP</span></span>
<span class="line"><span style="color: #F8F8F2">apHrRnRN_8Q,2022-06-05 21:43:28 UTC,,PLZ6Ih9wLHQ2FEVn2-NsdlTZnS86-GCFOP</span></span>
<span class="line"><span style="color: #F8F8F2">y_DDqg1A8lw,2022-06-05 21:43:28 UTC,,PLZ6Ih9wLHQ2FEVn2-NsdlTZnS86-GCFOP</span></span></code></pre>
<p>I expect the first video not to be added again, the second to be logged as an error but not stop the script, and the third to be added to the playlist. Which should end up with two videos in it</p>
<pre is:raw="" class="astro-code" style="background-color: #272822; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #F8F8F2">❯ python uploader.py</span></span>
<span class="line"><span style="color: #F8F8F2">Please visit this URL to authorize this application:</span></span>
<span class="line"><span style="color: #F8F8F2">https://accounts.google.com/o/oauth2/auth</span><span style="color: #F92672">?</span><span style="color: #F8F8F2">response_type=code</span><span style="color: #F92672">&#x26;</span><span style="color: #F8F8F2">client_id=...xx...</span></span>
<span class="line"><span style="color: #F8F8F2">Enter the authorization code: ....</span></span>
<span class="line"><span style="color: #F8F8F2">opening data/20220831T225517_data.csv</span></span>
<span class="line"><span style="color: #F8F8F2">-</span><span style="color: #F92672">></span><span style="color: #F8F8F2"> Searching whether SoJVZh50bDo is already </span><span style="color: #F92672">in</span><span style="color: #F8F8F2"> PLZ6Ih9wLHQ2FEVn2-NsdlTZnS86-GCFOP</span></span>
<span class="line"><span style="color: #F8F8F2">... yes it is, doing next</span></span>
<span class="line"><span style="color: #F8F8F2">-</span><span style="color: #F92672">></span><span style="color: #F8F8F2"> Searching whether apHrRnRN_8Q is already </span><span style="color: #F92672">in</span><span style="color: #F8F8F2"> PLZ6Ih9wLHQ2FEVn2-NsdlTZnS86-GCFOP</span></span>
<span class="line"><span style="color: #F8F8F2">>>>> Are you sure about this video</span><span style="color: #F92672">?</span><span style="color: #F8F8F2"> ID not found apHrRnRN_8Q</span></span>
<span class="line"><span style="color: #F8F8F2">-</span><span style="color: #F92672">></span><span style="color: #F8F8F2"> Searching whether y_DDqg1A8lw is already </span><span style="color: #F92672">in</span><span style="color: #F8F8F2"> PLZ6Ih9wLHQ2FEVn2-NsdlTZnS86-GCFOP</span></span>
<span class="line"><span style="color: #F8F8F2">-</span><span style="color: #F92672">></span><span style="color: #F8F8F2"> Adding y_DDqg1A8lw to PLZ6Ih9wLHQ2FEVn2-NsdlTZnS86-GCFOP</span></span>
<span class="line"><span style="color: #F8F8F2"> + Greentea Peng - Mr. Sun (miss da sun) / 3 </span><span style="color: #F92672">in</span><span style="color: #F8F8F2"> playlist</span></span>
<span class="line"><span style="color: #F8F8F2">DONE</span></span></code></pre>
<p>Great. It does the job!</p>
<h3 id="conclusion">Conclusion</h3>
<p>This was a couple of simple scripts to get the job done. There are a couple of possible improvements (I marked them as TODO in the post above). If I were to extend this I would start using Typer and of course add tests. But for now, it has served its purpose, which was to help me migrate away from the paid Google account. Hope there was something useful for you in there. The code is <a href="https://github.com/gotofritz/quick_and_dirty/tree/master/youtube_migration">available on GitHub</a> if you need it - at your own risk, of course.</p>
<h3 id="references">References</h3>
<ul>
<li>YouTube API <a href="https://developers.google.com/youtube/v3/docs/playlistItems/insert">playlistItem.insert</a> reference</li>
<li>YouTube API <a href="https://developers.google.com/youtube/v3/docs/playlistItems/delete">playlistItem.delete</a> reference</li>
</ul>
      </div>
    </article>
    <aside class="col-span-1 hidden text-right sm:sticky sm:top-20 sm:block">
      <nav class="mb-4 flex w-full flex-nowrap justify-end gap-4 text-xs text-gray-600 dark:text-gray-300">
        
        <a class="before:content-['<<']" href="/blog/migrating-thunderbird-message-filters-from-another-machine">
              older
            </a>
        <a class="after:content-['>>']" href="/blog/deleting-duplicates-from-youtube-playlists-with-python-script">
              newer
            </a>
        
      </nav>
      <h2 class="font-semibold">Table of Contents</h2><ul class="mt-4 space-y-2 text-xs">
              <li class="line-clamp-2 hover:text-accent">
                  <a href="#copying-another-users-playlist-why" aria-label="Scroll to section: Copying another user’s playlist? Why?">
                    <span>&#35;</span> Copying another user’s playlist? Why?
                  </a>
                </li><li class="line-clamp-2 hover:text-accent">
                  <a href="#step-0-set-up-the-python-project" aria-label="Scroll to section: Step 0: set up the python project">
                    <span>&#35;</span> Step 0: set up the python project
                  </a>
                </li><li class="line-clamp-2 hover:text-accent">
                  <a href="#step-1-download-the-playlist-information-as-csv-files" aria-label="Scroll to section: Step 1: download the playlist information as CSV files">
                    <span>&#35;</span> Step 1: download the playlist information as CSV files
                  </a>
                </li><li class="line-clamp-2 hover:text-accent">
                  <a href="#step-2-preprocess-the-youtube-takeout-data-and-concat-into-a-single-file" aria-label="Scroll to section: Step 2: preprocess the youtube takeout data and concat into a single file">
                    <span>&#35;</span> Step 2: preprocess the youtube takeout data and concat into a single file
                  </a>
                </li><li class="line-clamp-2 hover:text-accent">
                  <a href="#step-3-setting-up-a-gcp-project-and-getting-youtube-api-access" aria-label="Scroll to section: Step 3: setting up a GCP project and getting YouTube API access">
                    <span>&#35;</span> Step 3: setting up a GCP project and getting YouTube API access
                  </a>
                </li><li class="line-clamp-2 hover:text-accent">
                  <a href="#step-4-read-and-manage-csv-files-with-list-of-video-ids-to-add-to-playlist" aria-label="Scroll to section: Step 4: Read and manage csv files with list of video ids to add to playlist">
                    <span>&#35;</span> Step 4: Read and manage csv files with list of video ids to add to playlist
                  </a>
                </li><li class="line-clamp-2 hover:text-accent">
                  <a href="#step-5-extract-video-and-playlist-ids-from-csv-rows" aria-label="Scroll to section: Step 5: Extract video and playlist IDs from csv rows">
                    <span>&#35;</span> Step 5: Extract video and playlist IDs from csv rows
                  </a>
                </li><li class="line-clamp-2 hover:text-accent">
                  <a href="#step-6-connect-to-youtube-api" aria-label="Scroll to section: Step 6: connect to YouTube API">
                    <span>&#35;</span> Step 6: connect to YouTube API
                  </a>
                </li><li class="line-clamp-2 hover:text-accent">
                  <a href="#step-7-add-videos-to-playlist-using-the-youtube-api" aria-label="Scroll to section: Step 7: add videos to playlist using the YouTube API">
                    <span>&#35;</span> Step 7: add videos to playlist using the YouTube API
                  </a>
                </li><li class="line-clamp-2 hover:text-accent">
                  <a href="#step-8-avoiding-duplicates" aria-label="Scroll to section: Step 8: avoiding duplicates">
                    <span>&#35;</span> Step 8: avoiding duplicates
                  </a>
                </li><li class="line-clamp-2 hover:text-accent">
                  <a href="#conclusion" aria-label="Scroll to section: Conclusion">
                    <span>&#35;</span> Conclusion
                  </a>
                </li><li class="line-clamp-2 hover:text-accent">
                  <a href="#references" aria-label="Scroll to section: References">
                    <span>&#35;</span> References
                  </a>
                </li>
            </ul>
    </aside>
  </div><button id="to-top-btn" class="z-90 fixed bottom-8 right-4 flex h-10 w-10 translate-y-28 items-center justify-center rounded-full border-2 border-transparent bg-zinc-200 text-3xl opacity-0 transition-all duration-300 hover:border-zinc-400 data-[show=true]:translate-y-0 data-[show=true]:opacity-100 dark:bg-zinc-700 sm:right-8 sm:h-12 sm:w-12" aria-label="Back to Top" data-show="false"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="h-6 w-6">
      <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 15.75l7.5-7.5 7.5 7.5"></path>
    </svg>
  </button>
    </main>
    <footer class="mt-auto flex w-full flex-col flex-wrap items-center justify-center gap-y-2 pt-20 pb-4 text-center align-top text-gray-500 sm:flex-row sm:justify-between sm:text-xs">
  <div class="flex flex-wrap items-center gap-x-4 sm:items-center">
  <p>Find me on</p>
  <ul class="flex flex-1 items-center gap-x-4 sm:flex-initial">
    <li>
      <a class="inline-block p-2 sm:hover:text-link" href="https://github.com/gotofritz" target="_blank" rel="noopener noreferrer">
        <svg class="h-6 w-6" aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5">
          </path>
          <title>Github</title>
        </svg>
        <span class="sr-only">Github</span>
      </a>
    </li>
    <!-- <li>
      <a
        class="inline-block p-2 sm:hover:text-link"
        href="https://fosstodon.org/@gotofritz"
        target="_blank"
        rel="noopener noreferrer"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-6 w-6"
          stroke-width="1.5"
          stroke="currentColor"
          fill="none"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <path
            d="M18.648 15.254c-1.816 1.763 -6.648 1.626 -6.648 1.626a18.262 18.262 0 0 1 -3.288 -.256c1.127 1.985 4.12 2.81 8.982 2.475c-1.945 2.013 -13.598 5.257 -13.668 -7.636l-.026 -1.154c0 -3.036 .023 -4.115 1.352 -5.633c1.671 -1.91 6.648 -1.666 6.648 -1.666s4.977 -.243 6.648 1.667c1.329 1.518 1.352 2.597 1.352 5.633s-.456 4.074 -1.352 4.944z"
          ></path>
          <path
            d="M12 11.204v-2.926c0 -1.258 -.895 -2.278 -2 -2.278s-2 1.02 -2 2.278v4.722m4 -4.722c0 -1.258 .895 -2.278 2 -2.278s2 1.02 2 2.278v4.722"
          ></path>

          <title>Mastodon</title>
        </svg>
        <span class="sr-only">Mastodon</span>
      </a>
    </li> -->
    <li>
      <a class="inline-block p-2 sm:hover:text-link" href="https://www.linkedin.com/in/gotofritz/" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" aria-hidden="true" focusable="false" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <rect x="4" y="4" width="16" height="16" rx="2"></rect>
          <line x1="8" y1="11" x2="8" y2="16"></line>
          <line x1="8" y1="8" x2="8" y2="8.01"></line>
          <line x1="12" y1="16" x2="12" y2="11"></line>
          <path d="M16 16v-3a2 2 0 0 0 -4 0"></path>
          <title>LinkedIn</title>
        </svg>
        <span class="sr-only">LinkedIn</span>
      </a>
    </li>
    <li>
      <a class="inline-block p-2 sm:hover:text-link" href="mailto:info@gotofritz.net">
        <svg class="h-6 w-6" aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <rect x="3" y="5" width="18" height="14" rx="2"></rect>
          <polyline points="3 7 12 13 21 7"></polyline>
          <title>Email</title>
        </svg>
        <span class="sr-only">Email</span>
      </a>
    </li>
    <li>
      <a class="inline-block p-2 sm:hover:text-link" href="/feed.xml">
        <svg class="h-6 w-6" aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <circle cx="5" cy="19" r="1"></circle>
          <path d="M4 4a16 16 0 0 1 16 16"></path>
          <path d="M4 11a9 9 0 0 1 9 9"></path>
          <title>RSS</title>
        </svg>
        <span class="sr-only">RSS</span>
      </a>
    </li>
  </ul>
</div>
  <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
    <a href="/" class="sm:px-4 px-2 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline">Home</a>
    <a href="/about" class="sm:px-4 px-2 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline">About</a>
    <a href="/posts" class="sm:px-4 px-2 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline">Blog</a>
    <a href="/fritz-stelluto_resume.pdf" class="sm:px-4 px-2 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline">Resume</a>
  </nav>
  <div class="my-8 mr-0 sm:mr-4">
    <a href="https://creativecommons.org/licenses/by/4.0/">Licensed under a Creative Commons Attribution 4.0 license</a>
  </div>
</footer>
  </body></html>
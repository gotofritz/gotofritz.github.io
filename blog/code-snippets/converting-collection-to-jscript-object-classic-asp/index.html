<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <title>Converting a collection to a JScript object in ASP || Fritz Stelluto</title>
  <meta name="author" content="gotofritz">
  <meta name="description" content="Some Classic ASP code snippets in JScript (from the 90s!) for dealing with form data.">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link href="/assets/favicon.ico" rel="shortcut icon">
  <link rel="icon" href="/assets/favicon.gif" type="image/gif" />
  <link href="/assets/css/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
</head>

<body class="content-post"">
  <div class="gradient-container">
    <main class="panel-container">
      <div class="content">
        <nav class="topnav">
          <div itemscope itemtype="http://schema.org/Person" class="vcard group-of-links">
            <a href="/">home</a>
            <a href="/fritz-stelluto_resume.pdf" title="my CV as a PDF">search</a>
          </div>
        </nav>

<article>
  <section class="intro">
    <!--
      <div class="meta">
        <div class="date">
          <time datetime="2017-08-29T13:44:00+02:00" pubdate>2017-08-29</time>
        </div>
        <div class="tags">
          security,
          frontend
        </div>
      </div>
       -->
    <div class="post-meta">
      <time datetime="2006-05-30T15:04:00+02:00" pubdate>2006-05-30</time>
      //
      <div class="tags">
        classic asp
      </div>
    </div>
    <h1>Converting a collection to a JScript object in ASP</h1>
    <h2>Some Classic ASP code snippets in JScript (from the 90s!) for dealing with form data.</h2>

  </section>
  <section class="post-content">
    <a pppp href="https://msdn.microsoft.com/en-us/library/x32bxwys.aspx">Enumerators</a> are collections of data that can be iterated through with methods like <code>.moveNext</code> etc. They are too VB-like for my taste, so I’ve always avoided them. But some objects in the ASP environment however, such as Request.Form, are provided as Enumerators, and need to be converted them to standard JScript objects. Here’s a couple of routines to do so.</p>
<h3 id="converting-a-collection-to-a-plain-jscript-object">Converting A Collection To A Plain JScript Object</h3>
<p>I keep all the functions below in a generic include, coll2obj.asp, and use it across projects.  This is a generic collection-to-object conversion, which doesn’t seem to work on some built-in collections.</p>
<link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist-embed-04d41fe71632a896c1dd3e883de9f48941fad414d68185aa8df817b950873a05.css"><div id="gist2507749" class="gist">    <div class="gist-file">      <div class="gist-data">        <div class="js-gist-file-update-container js-task-list-container file-box">  <div id="file-coll2obj-asp" class="file">      <div itemprop="text" class="blob-wrapper data type-asp">      <table class="highlight tab-size js-file-line-container" data-tab-size="8">      <tr>        <td id="file-coll2obj-asp-L1" class="blob-num js-line-number" data-line-number="1"></td>        <td id="file-coll2obj-asp-LC1" class="blob-code blob-code-inner js-file-line">/**  coll2obj</td>      </tr>      <tr>        <td id="file-coll2obj-asp-L2" class="blob-num js-line-number" data-line-number="2"></td>        <td id="file-coll2obj-asp-LC2" class="blob-code blob-code-inner js-file-line"> * transforms a VB collection thing in a JS-friendly object</td>      </tr>      <tr>        <td id="file-coll2obj-asp-L3" class="blob-num js-line-number" data-line-number="3"></td>        <td id="file-coll2obj-asp-LC3" class="blob-code blob-code-inner js-file-line"> * @return {Object}</td>      </tr>      <tr>        <td id="file-coll2obj-asp-L4" class="blob-num js-line-number" data-line-number="4"></td>        <td id="file-coll2obj-asp-LC4" class="blob-code blob-code-inner js-file-line"> */</td>      </tr>      <tr>        <td id="file-coll2obj-asp-L5" class="blob-num js-line-number" data-line-number="5"></td>        <td id="file-coll2obj-asp-LC5" class="blob-code blob-code-inner js-file-line">function coll2obj( coll ) {</td>      </tr>      <tr>        <td id="file-coll2obj-asp-L6" class="blob-num js-line-number" data-line-number="6"></td>        <td id="file-coll2obj-asp-LC6" class="blob-code blob-code-inner js-file-line">  var enm = new Enumerator( coll )</td>      </tr>      <tr>        <td id="file-coll2obj-asp-L7" class="blob-num js-line-number" data-line-number="7"></td>        <td id="file-coll2obj-asp-LC7" class="blob-code blob-code-inner js-file-line">    , obj = {}</td>      </tr>      <tr>        <td id="file-coll2obj-asp-L8" class="blob-num js-line-number" data-line-number="8"></td>        <td id="file-coll2obj-asp-LC8" class="blob-code blob-code-inner js-file-line">    ;</td>      </tr>      <tr>        <td id="file-coll2obj-asp-L9" class="blob-num js-line-number" data-line-number="9"></td>        <td id="file-coll2obj-asp-LC9" class="blob-code blob-code-inner js-file-line"></td>      </tr>      <tr>        <td id="file-coll2obj-asp-L10" class="blob-num js-line-number" data-line-number="10"></td>        <td id="file-coll2obj-asp-LC10" class="blob-code blob-code-inner js-file-line">  while( !enm.atEnd() ) {</td>      </tr>      <tr>        <td id="file-coll2obj-asp-L11" class="blob-num js-line-number" data-line-number="11"></td>        <td id="file-coll2obj-asp-LC11" class="blob-code blob-code-inner js-file-line">    obj[enm.item().name]  = enm.item().value;</td>      </tr>      <tr>        <td id="file-coll2obj-asp-L12" class="blob-num js-line-number" data-line-number="12"></td>        <td id="file-coll2obj-asp-LC12" class="blob-code blob-code-inner js-file-line">    enm.moveNext();</td>      </tr>      <tr>        <td id="file-coll2obj-asp-L13" class="blob-num js-line-number" data-line-number="13"></td>        <td id="file-coll2obj-asp-LC13" class="blob-code blob-code-inner js-file-line">  }</td>      </tr>      <tr>        <td id="file-coll2obj-asp-L14" class="blob-num js-line-number" data-line-number="14"></td>        <td id="file-coll2obj-asp-LC14" class="blob-code blob-code-inner js-file-line"></td>      </tr>      <tr>        <td id="file-coll2obj-asp-L15" class="blob-num js-line-number" data-line-number="15"></td>        <td id="file-coll2obj-asp-LC15" class="blob-code blob-code-inner js-file-line">  return obj;</td>      </tr>      <tr>        <td id="file-coll2obj-asp-L16" class="blob-num js-line-number" data-line-number="16"></td>        <td id="file-coll2obj-asp-LC16" class="blob-code blob-code-inner js-file-line">}</td>      </tr></table>  </div>  </div>  </div>      </div>      <div class="gist-meta">        <a href="https://gist.github.com/gotofritz/2507749/raw/3761a626c46d2c77ec9fb87180f936f019de567a/coll2obj.asp" style="float:right">view raw</a>        <a href="https://gist.github.com/gotofritz/2507749#file-coll2obj-asp">coll2obj.asp</a>        hosted with &#10084; by <a href="https://github.com">GitHub</a>      </div>    </div></div>



<h3 id="converting-request-servervariables-to-jscript-object-in-classic-asp">Converting Request.ServerVariables To JScript Object In Classic ASP</h3>
<p>I’m not quite sure why the function above won’t work on Request.ServerVariables, but it doesn’t, so here’s a function for that specific collection.</p>
<link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist-embed-04d41fe71632a896c1dd3e883de9f48941fad414d68185aa8df817b950873a05.css"><div id="gist2507749" class="gist">    <div class="gist-file">      <div class="gist-data">        <div class="js-gist-file-update-container js-task-list-container file-box">  <div id="file-env2obj-asp" class="file">      <div itemprop="text" class="blob-wrapper data type-asp">      <table class="highlight tab-size js-file-line-container" data-tab-size="8">      <tr>        <td id="file-env2obj-asp-L1" class="blob-num js-line-number" data-line-number="1"></td>        <td id="file-env2obj-asp-LC1" class="blob-code blob-code-inner js-file-line">/**  </td>      </tr>      <tr>        <td id="file-env2obj-asp-L2" class="blob-num js-line-number" data-line-number="2"></td>        <td id="file-env2obj-asp-LC2" class="blob-code blob-code-inner js-file-line"> * transforms Request.ServerVariables VB collection </td>      </tr>      <tr>        <td id="file-env2obj-asp-L3" class="blob-num js-line-number" data-line-number="3"></td>        <td id="file-env2obj-asp-LC3" class="blob-code blob-code-inner js-file-line"> * in a JS-friendly object</td>      </tr>      <tr>        <td id="file-env2obj-asp-L4" class="blob-num js-line-number" data-line-number="4"></td>        <td id="file-env2obj-asp-LC4" class="blob-code blob-code-inner js-file-line"> * @return {Object}</td>      </tr>      <tr>        <td id="file-env2obj-asp-L5" class="blob-num js-line-number" data-line-number="5"></td>        <td id="file-env2obj-asp-LC5" class="blob-code blob-code-inner js-file-line"> */</td>      </tr>      <tr>        <td id="file-env2obj-asp-L6" class="blob-num js-line-number" data-line-number="6"></td>        <td id="file-env2obj-asp-LC6" class="blob-code blob-code-inner js-file-line">function env2obj() {</td>      </tr>      <tr>        <td id="file-env2obj-asp-L7" class="blob-num js-line-number" data-line-number="7"></td>        <td id="file-env2obj-asp-LC7" class="blob-code blob-code-inner js-file-line">  var enm = new Enumerator(Request.ServerVariables)</td>      </tr>      <tr>        <td id="file-env2obj-asp-L8" class="blob-num js-line-number" data-line-number="8"></td>        <td id="file-env2obj-asp-LC8" class="blob-code blob-code-inner js-file-line">    , obj = new Object()</td>      </tr>      <tr>        <td id="file-env2obj-asp-L9" class="blob-num js-line-number" data-line-number="9"></td>        <td id="file-env2obj-asp-LC9" class="blob-code blob-code-inner js-file-line">    , ei, en</td>      </tr>      <tr>        <td id="file-env2obj-asp-L10" class="blob-num js-line-number" data-line-number="10"></td>        <td id="file-env2obj-asp-LC10" class="blob-code blob-code-inner js-file-line">    ;</td>      </tr>      <tr>        <td id="file-env2obj-asp-L11" class="blob-num js-line-number" data-line-number="11"></td>        <td id="file-env2obj-asp-LC11" class="blob-code blob-code-inner js-file-line"></td>      </tr>      <tr>        <td id="file-env2obj-asp-L12" class="blob-num js-line-number" data-line-number="12"></td>        <td id="file-env2obj-asp-LC12" class="blob-code blob-code-inner js-file-line">  while(!enm.atEnd()) {</td>      </tr>      <tr>        <td id="file-env2obj-asp-L13" class="blob-num js-line-number" data-line-number="13"></td>        <td id="file-env2obj-asp-LC13" class="blob-code blob-code-inner js-file-line">    ei  = enm.item();</td>      </tr>      <tr>        <td id="file-env2obj-asp-L14" class="blob-num js-line-number" data-line-number="14"></td>        <td id="file-env2obj-asp-LC14" class="blob-code blob-code-inner js-file-line"></td>      </tr>      <tr>        <td id="file-env2obj-asp-L15" class="blob-num js-line-number" data-line-number="15"></td>        <td id="file-env2obj-asp-LC15" class="blob-code blob-code-inner js-file-line">    if( Request.ServerVariables.Item( ei ).Count &gt; 1 ){      </td>      </tr>      <tr>        <td id="file-env2obj-asp-L16" class="blob-num js-line-number" data-line-number="16"></td>        <td id="file-env2obj-asp-LC16" class="blob-code blob-code-inner js-file-line">      obj[ei] = new Array();</td>      </tr>      <tr>        <td id="file-env2obj-asp-L17" class="blob-num js-line-number" data-line-number="17"></td>        <td id="file-env2obj-asp-LC17" class="blob-code blob-code-inner js-file-line">      en  = new Enumerator( Request.ServerVariables( ei );</td>      </tr>      <tr>        <td id="file-env2obj-asp-L18" class="blob-num js-line-number" data-line-number="18"></td>        <td id="file-env2obj-asp-LC18" class="blob-code blob-code-inner js-file-line">      while( !en.atEnd() )</td>      </tr>      <tr>        <td id="file-env2obj-asp-L19" class="blob-num js-line-number" data-line-number="19"></td>        <td id="file-env2obj-asp-LC19" class="blob-code blob-code-inner js-file-line">      {</td>      </tr>      <tr>        <td id="file-env2obj-asp-L20" class="blob-num js-line-number" data-line-number="20"></td>        <td id="file-env2obj-asp-LC20" class="blob-code blob-code-inner js-file-line">        obj[ei][ obj[ei].length ] = en.item();</td>      </tr>      <tr>        <td id="file-env2obj-asp-L21" class="blob-num js-line-number" data-line-number="21"></td>        <td id="file-env2obj-asp-LC21" class="blob-code blob-code-inner js-file-line">        en.moveNext();</td>      </tr>      <tr>        <td id="file-env2obj-asp-L22" class="blob-num js-line-number" data-line-number="22"></td>        <td id="file-env2obj-asp-LC22" class="blob-code blob-code-inner js-file-line">      }</td>      </tr>      <tr>        <td id="file-env2obj-asp-L23" class="blob-num js-line-number" data-line-number="23"></td>        <td id="file-env2obj-asp-LC23" class="blob-code blob-code-inner js-file-line">      en  = null;</td>      </tr>      <tr>        <td id="file-env2obj-asp-L24" class="blob-num js-line-number" data-line-number="24"></td>        <td id="file-env2obj-asp-LC24" class="blob-code blob-code-inner js-file-line"></td>      </tr>      <tr>        <td id="file-env2obj-asp-L25" class="blob-num js-line-number" data-line-number="25"></td>        <td id="file-env2obj-asp-LC25" class="blob-code blob-code-inner js-file-line">    } else {      </td>      </tr>      <tr>        <td id="file-env2obj-asp-L26" class="blob-num js-line-number" data-line-number="26"></td>        <td id="file-env2obj-asp-LC26" class="blob-code blob-code-inner js-file-line">      obj[ei] = new String( Request.ServerVariables( ei ) );</td>      </tr>      <tr>        <td id="file-env2obj-asp-L27" class="blob-num js-line-number" data-line-number="27"></td>        <td id="file-env2obj-asp-LC27" class="blob-code blob-code-inner js-file-line"></td>      </tr>      <tr>        <td id="file-env2obj-asp-L28" class="blob-num js-line-number" data-line-number="28"></td>        <td id="file-env2obj-asp-LC28" class="blob-code blob-code-inner js-file-line">    }</td>      </tr>      <tr>        <td id="file-env2obj-asp-L29" class="blob-num js-line-number" data-line-number="29"></td>        <td id="file-env2obj-asp-LC29" class="blob-code blob-code-inner js-file-line">    enm.moveNext();</td>      </tr>      <tr>        <td id="file-env2obj-asp-L30" class="blob-num js-line-number" data-line-number="30"></td>        <td id="file-env2obj-asp-LC30" class="blob-code blob-code-inner js-file-line">  }</td>      </tr>      <tr>        <td id="file-env2obj-asp-L31" class="blob-num js-line-number" data-line-number="31"></td>        <td id="file-env2obj-asp-LC31" class="blob-code blob-code-inner js-file-line">  return obj;</td>      </tr>      <tr>        <td id="file-env2obj-asp-L32" class="blob-num js-line-number" data-line-number="32"></td>        <td id="file-env2obj-asp-LC32" class="blob-code blob-code-inner js-file-line">}</td>      </tr></table>  </div>  </div>  </div>      </div>      <div class="gist-meta">        <a href="https://gist.github.com/gotofritz/2507749/raw/3761a626c46d2c77ec9fb87180f936f019de567a/env2obj.asp" style="float:right">view raw</a>        <a href="https://gist.github.com/gotofritz/2507749#file-env2obj-asp">env2obj.asp</a>        hosted with &#10084; by <a href="https://github.com">GitHub</a>      </div>    </div></div>





<h3 id="converting-post-variables-to-jscript-object-in-classic-asp">Converting Post Variables To JScript Object In Classic ASP</h3>
<p>The same holds for post variables…</p>
<link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist-embed-04d41fe71632a896c1dd3e883de9f48941fad414d68185aa8df817b950873a05.css"><div id="gist2507749" class="gist">    <div class="gist-file">      <div class="gist-data">        <div class="js-gist-file-update-container js-task-list-container file-box">  <div id="file-post2obj-asp" class="file">      <div itemprop="text" class="blob-wrapper data type-asp">      <table class="highlight tab-size js-file-line-container" data-tab-size="8">      <tr>        <td id="file-post2obj-asp-L1" class="blob-num js-line-number" data-line-number="1"></td>        <td id="file-post2obj-asp-LC1" class="blob-code blob-code-inner js-file-line">/*  post2obj</td>      </tr>      <tr>        <td id="file-post2obj-asp-L2" class="blob-num js-line-number" data-line-number="2"></td>        <td id="file-post2obj-asp-LC2" class="blob-code blob-code-inner js-file-line"> *  transforms Request.Form VB collection into a JS-friendly object</td>      </tr>      <tr>        <td id="file-post2obj-asp-L3" class="blob-num js-line-number" data-line-number="3"></td>        <td id="file-post2obj-asp-LC3" class="blob-code blob-code-inner js-file-line"> * @return {Object}</td>      </tr>      <tr>        <td id="file-post2obj-asp-L4" class="blob-num js-line-number" data-line-number="4"></td>        <td id="file-post2obj-asp-LC4" class="blob-code blob-code-inner js-file-line"> *</td>      </tr>      <tr>        <td id="file-post2obj-asp-L5" class="blob-num js-line-number" data-line-number="5"></td>        <td id="file-post2obj-asp-LC5" class="blob-code blob-code-inner js-file-line"> */</td>      </tr>      <tr>        <td id="file-post2obj-asp-L6" class="blob-num js-line-number" data-line-number="6"></td>        <td id="file-post2obj-asp-LC6" class="blob-code blob-code-inner js-file-line">function post2obj() {</td>      </tr>      <tr>        <td id="file-post2obj-asp-L7" class="blob-num js-line-number" data-line-number="7"></td>        <td id="file-post2obj-asp-LC7" class="blob-code blob-code-inner js-file-line">  var enm = new Enumerator( Request.Form )</td>      </tr>      <tr>        <td id="file-post2obj-asp-L8" class="blob-num js-line-number" data-line-number="8"></td>        <td id="file-post2obj-asp-LC8" class="blob-code blob-code-inner js-file-line">    , obj = new Object()</td>      </tr>      <tr>        <td id="file-post2obj-asp-L9" class="blob-num js-line-number" data-line-number="9"></td>        <td id="file-post2obj-asp-LC9" class="blob-code blob-code-inner js-file-line">    , ei, en</td>      </tr>      <tr>        <td id="file-post2obj-asp-L10" class="blob-num js-line-number" data-line-number="10"></td>        <td id="file-post2obj-asp-LC10" class="blob-code blob-code-inner js-file-line">    ;</td>      </tr>      <tr>        <td id="file-post2obj-asp-L11" class="blob-num js-line-number" data-line-number="11"></td>        <td id="file-post2obj-asp-LC11" class="blob-code blob-code-inner js-file-line"></td>      </tr>      <tr>        <td id="file-post2obj-asp-L12" class="blob-num js-line-number" data-line-number="12"></td>        <td id="file-post2obj-asp-LC12" class="blob-code blob-code-inner js-file-line">  while( !enm.atEnd() ) {</td>      </tr>      <tr>        <td id="file-post2obj-asp-L13" class="blob-num js-line-number" data-line-number="13"></td>        <td id="file-post2obj-asp-LC13" class="blob-code blob-code-inner js-file-line">    ei  = enm.item();</td>      </tr>      <tr>        <td id="file-post2obj-asp-L14" class="blob-num js-line-number" data-line-number="14"></td>        <td id="file-post2obj-asp-LC14" class="blob-code blob-code-inner js-file-line"></td>      </tr>      <tr>        <td id="file-post2obj-asp-L15" class="blob-num js-line-number" data-line-number="15"></td>        <td id="file-post2obj-asp-LC15" class="blob-code blob-code-inner js-file-line">    if(  Request.Form.Item( ei ).Count &gt; 1 ) {</td>      </tr>      <tr>        <td id="file-post2obj-asp-L16" class="blob-num js-line-number" data-line-number="16"></td>        <td id="file-post2obj-asp-LC16" class="blob-code blob-code-inner js-file-line">      obj[ei] = new Array();</td>      </tr>      <tr>        <td id="file-post2obj-asp-L17" class="blob-num js-line-number" data-line-number="17"></td>        <td id="file-post2obj-asp-LC17" class="blob-code blob-code-inner js-file-line">      en  = new Enumerator(Request.Form( ei ));</td>      </tr>      <tr>        <td id="file-post2obj-asp-L18" class="blob-num js-line-number" data-line-number="18"></td>        <td id="file-post2obj-asp-LC18" class="blob-code blob-code-inner js-file-line"></td>      </tr>      <tr>        <td id="file-post2obj-asp-L19" class="blob-num js-line-number" data-line-number="19"></td>        <td id="file-post2obj-asp-LC19" class="blob-code blob-code-inner js-file-line">      while( !en.atEnd() ){</td>      </tr>      <tr>        <td id="file-post2obj-asp-L20" class="blob-num js-line-number" data-line-number="20"></td>        <td id="file-post2obj-asp-LC20" class="blob-code blob-code-inner js-file-line">        obj[ei][ obj[ei].length ] = en.item();</td>      </tr>      <tr>        <td id="file-post2obj-asp-L21" class="blob-num js-line-number" data-line-number="21"></td>        <td id="file-post2obj-asp-LC21" class="blob-code blob-code-inner js-file-line">        en.moveNext();</td>      </tr>      <tr>        <td id="file-post2obj-asp-L22" class="blob-num js-line-number" data-line-number="22"></td>        <td id="file-post2obj-asp-LC22" class="blob-code blob-code-inner js-file-line">      }</td>      </tr>      <tr>        <td id="file-post2obj-asp-L23" class="blob-num js-line-number" data-line-number="23"></td>        <td id="file-post2obj-asp-LC23" class="blob-code blob-code-inner js-file-line"></td>      </tr>      <tr>        <td id="file-post2obj-asp-L24" class="blob-num js-line-number" data-line-number="24"></td>        <td id="file-post2obj-asp-LC24" class="blob-code blob-code-inner js-file-line">      en  = null;</td>      </tr>      <tr>        <td id="file-post2obj-asp-L25" class="blob-num js-line-number" data-line-number="25"></td>        <td id="file-post2obj-asp-LC25" class="blob-code blob-code-inner js-file-line"></td>      </tr>      <tr>        <td id="file-post2obj-asp-L26" class="blob-num js-line-number" data-line-number="26"></td>        <td id="file-post2obj-asp-LC26" class="blob-code blob-code-inner js-file-line">    } else {</td>      </tr>      <tr>        <td id="file-post2obj-asp-L27" class="blob-num js-line-number" data-line-number="27"></td>        <td id="file-post2obj-asp-LC27" class="blob-code blob-code-inner js-file-line">      obj[ei] = new String(Request.Form( ei ) );</td>      </tr>      <tr>        <td id="file-post2obj-asp-L28" class="blob-num js-line-number" data-line-number="28"></td>        <td id="file-post2obj-asp-LC28" class="blob-code blob-code-inner js-file-line">      obj[ei] = obj[ei].replace( /^s+|s+$/, &#39;&#39; );</td>      </tr>      <tr>        <td id="file-post2obj-asp-L29" class="blob-num js-line-number" data-line-number="29"></td>        <td id="file-post2obj-asp-LC29" class="blob-code blob-code-inner js-file-line">    }</td>      </tr>      <tr>        <td id="file-post2obj-asp-L30" class="blob-num js-line-number" data-line-number="30"></td>        <td id="file-post2obj-asp-LC30" class="blob-code blob-code-inner js-file-line"></td>      </tr>      <tr>        <td id="file-post2obj-asp-L31" class="blob-num js-line-number" data-line-number="31"></td>        <td id="file-post2obj-asp-LC31" class="blob-code blob-code-inner js-file-line">    enm.moveNext();</td>      </tr>      <tr>        <td id="file-post2obj-asp-L32" class="blob-num js-line-number" data-line-number="32"></td>        <td id="file-post2obj-asp-LC32" class="blob-code blob-code-inner js-file-line">  }</td>      </tr>      <tr>        <td id="file-post2obj-asp-L33" class="blob-num js-line-number" data-line-number="33"></td>        <td id="file-post2obj-asp-LC33" class="blob-code blob-code-inner js-file-line"></td>      </tr>      <tr>        <td id="file-post2obj-asp-L34" class="blob-num js-line-number" data-line-number="34"></td>        <td id="file-post2obj-asp-LC34" class="blob-code blob-code-inner js-file-line">  return obj;</td>      </tr>      <tr>        <td id="file-post2obj-asp-L35" class="blob-num js-line-number" data-line-number="35"></td>        <td id="file-post2obj-asp-LC35" class="blob-code blob-code-inner js-file-line">}</td>      </tr></table>  </div>  </div>  </div>      </div>      <div class="gist-meta">        <a href="https://gist.github.com/gotofritz/2507749/raw/3761a626c46d2c77ec9fb87180f936f019de567a/post2obj.asp" style="float:right">view raw</a>        <a href="https://gist.github.com/gotofritz/2507749#file-post2obj-asp">post2obj.asp</a>        hosted with &#10084; by <a href="https://github.com">GitHub</a>      </div>    </div></div>




<h3 id="converting-post-variables-to-jscript-object-in-classic-asp">Converting Post Variables To JScript Object In Classic ASP</h3>
<p>…and query string variables.<br> <link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist-embed-04d41fe71632a896c1dd3e883de9f48941fad414d68185aa8df817b950873a05.css"><div id="gist2507749" class="gist">    <div class="gist-file">      <div class="gist-data">        <div class="js-gist-file-update-container js-task-list-container file-box">  <div id="file-query2obj-asp" class="file">      <div itemprop="text" class="blob-wrapper data type-asp">      <table class="highlight tab-size js-file-line-container" data-tab-size="8">      <tr>        <td id="file-query2obj-asp-L1" class="blob-num js-line-number" data-line-number="1"></td>        <td id="file-query2obj-asp-LC1" class="blob-code blob-code-inner js-file-line">/*  </td>      </tr>      <tr>        <td id="file-query2obj-asp-L2" class="blob-num js-line-number" data-line-number="2"></td>        <td id="file-query2obj-asp-LC2" class="blob-code blob-code-inner js-file-line"> * transforms Request.QueryString VB collection thing in a JS-friendly object</td>      </tr>      <tr>        <td id="file-query2obj-asp-L3" class="blob-num js-line-number" data-line-number="3"></td>        <td id="file-query2obj-asp-LC3" class="blob-code blob-code-inner js-file-line"> * @return {Object}</td>      </tr>      <tr>        <td id="file-query2obj-asp-L4" class="blob-num js-line-number" data-line-number="4"></td>        <td id="file-query2obj-asp-LC4" class="blob-code blob-code-inner js-file-line"> */</td>      </tr>      <tr>        <td id="file-query2obj-asp-L5" class="blob-num js-line-number" data-line-number="5"></td>        <td id="file-query2obj-asp-LC5" class="blob-code blob-code-inner js-file-line">function query2obj() {</td>      </tr>      <tr>        <td id="file-query2obj-asp-L6" class="blob-num js-line-number" data-line-number="6"></td>        <td id="file-query2obj-asp-LC6" class="blob-code blob-code-inner js-file-line">  var enm = new Enumerator( Request.QueryString )</td>      </tr>      <tr>        <td id="file-query2obj-asp-L7" class="blob-num js-line-number" data-line-number="7"></td>        <td id="file-query2obj-asp-LC7" class="blob-code blob-code-inner js-file-line">    , obj = new Object(</td>      </tr>      <tr>        <td id="file-query2obj-asp-L8" class="blob-num js-line-number" data-line-number="8"></td>        <td id="file-query2obj-asp-LC8" class="blob-code blob-code-inner js-file-line">    , ei, en</td>      </tr>      <tr>        <td id="file-query2obj-asp-L9" class="blob-num js-line-number" data-line-number="9"></td>        <td id="file-query2obj-asp-LC9" class="blob-code blob-code-inner js-file-line">    ;</td>      </tr>      <tr>        <td id="file-query2obj-asp-L10" class="blob-num js-line-number" data-line-number="10"></td>        <td id="file-query2obj-asp-LC10" class="blob-code blob-code-inner js-file-line"></td>      </tr>      <tr>        <td id="file-query2obj-asp-L11" class="blob-num js-line-number" data-line-number="11"></td>        <td id="file-query2obj-asp-LC11" class="blob-code blob-code-inner js-file-line">  while( !enm.atEnd() ) {</td>      </tr>      <tr>        <td id="file-query2obj-asp-L12" class="blob-num js-line-number" data-line-number="12"></td>        <td id="file-query2obj-asp-LC12" class="blob-code blob-code-inner js-file-line">    ei  = enm.item();</td>      </tr>      <tr>        <td id="file-query2obj-asp-L13" class="blob-num js-line-number" data-line-number="13"></td>        <td id="file-query2obj-asp-LC13" class="blob-code blob-code-inner js-file-line"></td>      </tr>      <tr>        <td id="file-query2obj-asp-L14" class="blob-num js-line-number" data-line-number="14"></td>        <td id="file-query2obj-asp-LC14" class="blob-code blob-code-inner js-file-line">    if(  Request.QueryString.Item( ei ).Count &gt; 1 ) {</td>      </tr>      <tr>        <td id="file-query2obj-asp-L15" class="blob-num js-line-number" data-line-number="15"></td>        <td id="file-query2obj-asp-LC15" class="blob-code blob-code-inner js-file-line">      obj[ei] = new Array();</td>      </tr>      <tr>        <td id="file-query2obj-asp-L16" class="blob-num js-line-number" data-line-number="16"></td>        <td id="file-query2obj-asp-LC16" class="blob-code blob-code-inner js-file-line">      en  = new Enumerator(Request.QueryString( ei ));</td>      </tr>      <tr>        <td id="file-query2obj-asp-L17" class="blob-num js-line-number" data-line-number="17"></td>        <td id="file-query2obj-asp-LC17" class="blob-code blob-code-inner js-file-line"></td>      </tr>      <tr>        <td id="file-query2obj-asp-L18" class="blob-num js-line-number" data-line-number="18"></td>        <td id="file-query2obj-asp-LC18" class="blob-code blob-code-inner js-file-line">      while( !en.atEnd() ) {</td>      </tr>      <tr>        <td id="file-query2obj-asp-L19" class="blob-num js-line-number" data-line-number="19"></td>        <td id="file-query2obj-asp-LC19" class="blob-code blob-code-inner js-file-line">        obj[ei][ obj[ei].length ] = en.item();</td>      </tr>      <tr>        <td id="file-query2obj-asp-L20" class="blob-num js-line-number" data-line-number="20"></td>        <td id="file-query2obj-asp-LC20" class="blob-code blob-code-inner js-file-line">        en.moveNext();</td>      </tr>      <tr>        <td id="file-query2obj-asp-L21" class="blob-num js-line-number" data-line-number="21"></td>        <td id="file-query2obj-asp-LC21" class="blob-code blob-code-inner js-file-line">      }</td>      </tr>      <tr>        <td id="file-query2obj-asp-L22" class="blob-num js-line-number" data-line-number="22"></td>        <td id="file-query2obj-asp-LC22" class="blob-code blob-code-inner js-file-line"></td>      </tr>      <tr>        <td id="file-query2obj-asp-L23" class="blob-num js-line-number" data-line-number="23"></td>        <td id="file-query2obj-asp-LC23" class="blob-code blob-code-inner js-file-line">      en  = null;</td>      </tr>      <tr>        <td id="file-query2obj-asp-L24" class="blob-num js-line-number" data-line-number="24"></td>        <td id="file-query2obj-asp-LC24" class="blob-code blob-code-inner js-file-line"></td>      </tr>      <tr>        <td id="file-query2obj-asp-L25" class="blob-num js-line-number" data-line-number="25"></td>        <td id="file-query2obj-asp-LC25" class="blob-code blob-code-inner js-file-line">    } else {</td>      </tr>      <tr>        <td id="file-query2obj-asp-L26" class="blob-num js-line-number" data-line-number="26"></td>        <td id="file-query2obj-asp-LC26" class="blob-code blob-code-inner js-file-line">      obj[ei] = new String(Request.QueryString( ei ) );</td>      </tr>      <tr>        <td id="file-query2obj-asp-L27" class="blob-num js-line-number" data-line-number="27"></td>        <td id="file-query2obj-asp-LC27" class="blob-code blob-code-inner js-file-line">      obj[ei] = obj[ei].replace( /^s+|s+$/, &#39;&#39; );</td>      </tr>      <tr>        <td id="file-query2obj-asp-L28" class="blob-num js-line-number" data-line-number="28"></td>        <td id="file-query2obj-asp-LC28" class="blob-code blob-code-inner js-file-line">    }</td>      </tr>      <tr>        <td id="file-query2obj-asp-L29" class="blob-num js-line-number" data-line-number="29"></td>        <td id="file-query2obj-asp-LC29" class="blob-code blob-code-inner js-file-line"></td>      </tr>      <tr>        <td id="file-query2obj-asp-L30" class="blob-num js-line-number" data-line-number="30"></td>        <td id="file-query2obj-asp-LC30" class="blob-code blob-code-inner js-file-line">    enm.moveNext();</td>      </tr>      <tr>        <td id="file-query2obj-asp-L31" class="blob-num js-line-number" data-line-number="31"></td>        <td id="file-query2obj-asp-LC31" class="blob-code blob-code-inner js-file-line">  }</td>      </tr>      <tr>        <td id="file-query2obj-asp-L32" class="blob-num js-line-number" data-line-number="32"></td>        <td id="file-query2obj-asp-LC32" class="blob-code blob-code-inner js-file-line"></td>      </tr>      <tr>        <td id="file-query2obj-asp-L33" class="blob-num js-line-number" data-line-number="33"></td>        <td id="file-query2obj-asp-LC33" class="blob-code blob-code-inner js-file-line">  return obj;</td>      </tr>      <tr>        <td id="file-query2obj-asp-L34" class="blob-num js-line-number" data-line-number="34"></td>        <td id="file-query2obj-asp-LC34" class="blob-code blob-code-inner js-file-line">}</td>      </tr></table>  </div>  </div>  </div>      </div>      <div class="gist-meta">        <a href="https://gist.github.com/gotofritz/2507749/raw/3761a626c46d2c77ec9fb87180f936f019de567a/query2obj.asp" style="float:right">view raw</a>        <a href="https://gist.github.com/gotofritz/2507749#file-query2obj-asp">query2obj.asp</a>        hosted with &#10084; by <a href="https://github.com">GitHub</a>      </div>    </div></div></p>
  </section>


    </div>
  </div>
</div>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-11254155-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</body>
</html>
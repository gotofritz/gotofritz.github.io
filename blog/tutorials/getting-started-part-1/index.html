
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Getting started with Google Apps Script - Fabrizio (Fritz) Stelluto</title>
	<meta name="author" content="">

	
	<meta name="description" content="Google Apps Script (GAS) is an implementation of Javascript that runs on Google cloud servers and allows access to Google services. Support is still &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Fabrizio (Fritz) Stelluto" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.ico" rel="shortcut icon">
	<link rel="icon" href="/favicon.gif" type="image/gif" />
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	
</head>


<body ontouchstart="">

  <header id="header" class="inner">
<nav id="main-nav"><div>
  <a class="rss" href="/atom.xml" title="RSS">RSS</a>
  <a href="/">home</a>
  <a href="/blog/">blog</a>
</div></nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><div>
  <a class="rss" href="/atom.xml" title="RSS">RSS</a>
  <a href="/">home</a>
  <a href="/blog/">blog</a>
</div></div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:gotofritz.net">
			</form>
		</div>
	</div>
</nav>

<nav id="sub-nav" class="alignright">
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:gotofritz.net">
	</form>
</nav>

</header>
	
		
	
	<div id="content" class="inner">
    
    <article class="post">
	<h1 class="title">Getting Started With Google Apps Script</h1>
	<div>
		<div class="meta">
			<div class="date">








  


<time datetime="2010-09-30T17:36:57+02:00" pubdate data-updated="true">2010-09-30, Thu</time></div>
			<div class="tags">


	<a class='category' href='/blog/cat/tutorials/'>Tutorials</a>


</div>
			
				<span class="comments"><a href="/blog/tutorials/getting-started-part-1#disqus_thread">Comments</a></span>
			
		</div>
		<div class="entry-content"><p>Google Apps Script (GAS) is an implementation of Javascript that runs on Google cloud servers and allows access to Google services. Support is still somewhat flaky, but if you are already familiar with Javascript it is an exciting technology to get into. In this simple Google Apps Script primer, we will use a Google Docs spreadsheet to learn the basics</p>

<!--more-->


<h2>A generic spreadsheet utils</h2>

<p>The easiest way to get started with GAS is by playing with spreadsheets, so let&#8217;s create one in Google Docs. The aim is to create a generic collection of utilities to perform simple text manipulation tasks. Let&#8217;s start from the very beginning.</p>

<h3>Signing up to Google Docs</h3>

<p>If you have never used Google Docs before, you&#8217;ll need a Google Apps account - confusingly, this is not the same as a GMail account, although many people end up using the same login name. In fact you can register at <a href="http://docs.google.com/">docs.google.com</a> using any email address you want.</p>

<p>Either way, create a new spreadsheet, give it a name (for example GAS utils), and then you are ready to go.</p>

<h2>Hello world</h2>

<p>Let&#8217;s start with the traditional &#8216;Hello World&#8217; script. From the app menu underneath the Google Docs log, select Tools, then Scripts, and Script editor.</p>

<br><img src="/a/2010-09-30-getting-started-part-1/google-apps-script-menu.png"><br>


<p>A popup window will appear - that&#8217;s where you are going to write your scripts. It has some useful features (code completion, parenthesis balancing) and some annoying ones (code formatting), but you have no choice in the matter.</p>

<p>In that editor you will create a list of Javascript functions - think of each function as an entry in a menu like &#8220;Convert to upper case&#8221;, &#8220;Generate emails&#8221; or, indeed, &#8220;Hello World&#8221;. Later on, all these function WILL, in fact, become entries in a menu. You can create all sort of complicated classes and inheritance chains, and so forth, but ultimately you will only be able to run one of these functions - if you are planning anything fancier you will have to wrap your code into a function in the global scope.</p>

<p>The script editor opens with an unsaved script, pre-populated with an empty function</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">function</span> <span class="nx">myFunction</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span><span class="o">?</span>
</span></code></pre></td></tr></table></div></figure>


<p> change the function name to helloWorld, and enter this code:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">function</span> <span class="nx">helloWorld</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">Browser</span><span class="p">.</span><span class="nx">msgBox</span><span class="p">(</span><span class="s2">&quot;Hello World&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/a/2010-09-30-getting-started-part-1/google-apps-script-menu.png"></p>

<p>Then click on the save icon - the first time you do so, the editor will ask you to give a name to the script (I used TEST). Once saved, the editor will populate the pulldown menu above the script with the name of all functions it can run - in this case there is only one, helloWorld. Incidentally, you can stop a function appearing in the menu by ending its name with an underscore, e.g. function test_ () { &#8230;</p>

<p><img src="/a/2010-09-30-getting-started-part-1/google-apps-script-helloworld.png"><br></p>

<p>Click on the triangle next to the function name and there you have it - a simple alert window with a message in it.</p>

<h2>Google Apps Script reference</h2>

<p>That was a simple script with a single instruction in it. It told the global <a href="http://code.google.com/googleapps/appsscript/class_browser.html">Browser object</a> (a GAS object, not a  standard Javascript one) to run the msgBox method. The Browser object is one of a few global GAS objects and classes available to you. The other global object (or Service, in GAS talk) you will be using is <a href="http://code.google.com/googleapps/appsscript/service_spreadsheet.html">SpreadsheetApp</a>. Its methods return objects of class <a href="http://code.google.com/googleapps/appsscript/class_spreadsheet.html">Spreadsheet</a>, <a href="http://code.google.com/googleapps/appsscript/class_sheet.html">Sheet</a>, and <a href="http://code.google.com/googleapps/appsscript/class_range.html">Range</a>, so you may want to have a look around the GAS reference to see what their available methods are. You&#8217;ll see a lot more objects in the reference - they deal with other apps like GMail or Google Finance, but that&#8217;s a topic for other tutorials.</p>

<h2>How to run functions in GAS</h2>

<p>That&#8217;s all well and good, but will you have to open the script editor and select a function name from the menu every time you want to run a function? Function names are often geeky, and having to open a popup window is not ideal. An alternative is &#8220;Manage&#8230;&#8221;, under the Script menu - it shows a pop up list of all functions. But that comes right in the middle of the spreadsheet, covering most of it. That means that you can&#8217;t select a cell for example. Another non-starter then. Luckily, there is another way - you can actually create menus and have them go in the menu bar, to the right of Help</p>

<p>The spreadsheet class has an <a href="http://code.google.com/googleapps/appsscript/class_spreadsheet.html#addMenu">addMenu</a> method - it takes a string as name, and an array for the entries. You can create a list of functions, put their name into an array, and feed that to  addMenu, and then use that to create the menu (note the &#8216;null&#8217; to create a separator):</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">function</span> <span class="nx">helloWorld</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">Browser</span><span class="p">.</span><span class="nx">msgBox</span><span class="p">(</span><span class="s2">&quot;Hello World&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">ciaoWorld</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">Browser</span><span class="p">.</span><span class="nx">msgBox</span><span class="p">(</span><span class="s2">&quot;Ciao World&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">salutWorld</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">Browser</span><span class="p">.</span><span class="nx">msgBox</span><span class="p">(</span><span class="s2">&quot;Salut World&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">createMenu</span><span class="p">(){</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">menuEntries</span> <span class="o">=</span> <span class="p">[</span>
</span><span class='line'>    <span class="p">{</span> <span class="nx">name</span> <span class="o">:</span> <span class="s2">&quot;Say it in English&quot;</span><span class="p">,</span> <span class="nx">functionName</span> <span class="o">:</span> <span class="s2">&quot;hellowWorld&quot;</span> <span class="p">},</span>
</span><span class='line'>    <span class="kc">null</span><span class="p">,</span>
</span><span class='line'>    <span class="p">{</span> <span class="nx">name</span> <span class="o">:</span> <span class="s2">&quot;Dillo in Italiano&quot;</span><span class="p">,</span> <span class="nx">functionName</span> <span class="o">:</span> <span class="s2">&quot;ciaoWorld&quot;</span> <span class="p">},</span>
</span><span class='line'>    <span class="p">{</span> <span class="nx">name</span> <span class="o">:</span> <span class="s2">&quot;En Fran??ois aussi&quot;</span><span class="p">,</span> <span class="nx">functionName</span> <span class="o">:</span> <span class="s2">&quot;salutWorld&quot;</span> <span class="p">}</span>
</span><span class='line'>   <span class="p">];</span>
</span><span class='line'>   <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nx">getActiveSpreadsheet</span><span class="p">().</span><span class="nx">addMenu</span><span class="p">(</span> <span class="s2">&quot;TEST MENU&quot;</span><span class="p">,</span> <span class="nx">menuEntries</span> <span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p> Save it, find createMenu in the Script editor, run it and there you have it - your very own custom menu.<br>
<img src="/a/2010-09-30-getting-started-part-1/google-apps-script-submenu.png"></p>

<h2>Using trigger to create menus in Google Docs spreadsheet</h2>

<p>So that&#8217;s all well and good, but you still have to run createMenu manually from the Script editor or the Manage pop up. Spreadsheet have some built in event handler (or triggers) - at the time of writing they are document open, cell edit, and form submit.</p>

<h3>The onOpen trigger</h3>

<p>When a spreadsheet is opened, the GAS engine generates an open event, and will run functions you have associated with that event. You can do that in two ways.</p>

<p>The Script editor has a Triggers menu, which lets you associate functions to events (or call them at regularl intervals). In the case of the open event though, it is much simpler to rename createMenu to onOpen - the GAS engine will automatically run it when the document is opened. Try that, save the script, and close and re-open the spreadsheet - the menu should now appear automatically (it may take a few seconds for it to happen)</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">function</span> <span class="nx">helloWorld</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">Browser</span><span class="p">.</span><span class="nx">msgBox</span><span class="p">(</span><span class="s2">&quot;Hello World&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">ciaoWorld</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">Browser</span><span class="p">.</span><span class="nx">msgBox</span><span class="p">(</span><span class="s2">&quot;Ciao World&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">salutWorld</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">Browser</span><span class="p">.</span><span class="nx">msgBox</span><span class="p">(</span><span class="s2">&quot;Salut World&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">onOpen</span><span class="p">(){</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">menuEntries</span> <span class="o">=</span> <span class="p">[</span>
</span><span class='line'>    <span class="p">{</span> <span class="nx">name</span> <span class="o">:</span> <span class="s2">&quot;Say it in English&quot;</span><span class="p">,</span> <span class="nx">functionName</span> <span class="o">:</span> <span class="s2">&quot;hellowWorld&quot;</span> <span class="p">},</span>
</span><span class='line'>    <span class="kc">null</span><span class="p">,</span>
</span><span class='line'>    <span class="p">{</span> <span class="nx">name</span> <span class="o">:</span> <span class="s2">&quot;Dillo in Italiano&quot;</span><span class="p">,</span> <span class="nx">functionName</span> <span class="o">:</span> <span class="s2">&quot;ciaoWorld&quot;</span> <span class="p">},</span>
</span><span class='line'>    <span class="p">{</span> <span class="nx">name</span> <span class="o">:</span> <span class="s2">&quot;En Fran??ois aussi&quot;</span><span class="p">,</span> <span class="nx">functionName</span> <span class="o">:</span> <span class="s2">&quot;salutWorld&quot;</span> <span class="p">}</span>
</span><span class='line'>   <span class="p">];</span>
</span><span class='line'>   <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nx">getActiveSpreadsheet</span><span class="p">().</span><span class="nx">addMenu</span><span class="p">(</span> <span class="s2">&quot;TEST MENU&quot;</span><span class="p">,</span> <span class="nx">menuEntries</span> <span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Part 2</h2>

<p>I have abandoned the idea of a complete serious of tutorials, but I have created a <a href="/blog/weekly-challenge/google-apps-script-boilerplate/">a couple of GAS boilerplates</a> as one of my <a href="/blog/cat/weekly-challenge/">weekly challenges</a></p>

<h2>Further reading</h2>

<p>Google has some <a href="http://code.google.com/googleapps/appsscript/articles.html">GAS tutorials</a> which are well worth going through.</p>
</div>
	</div>
</article>


<section id="comment">
    <h1 class="title">Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>

  </div>
	<footer id="footer" class="inner">Copyright &copy; 2015

    Fabrizio (Fritz) Stelluto

</footer>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script src="/javascripts/slash.js"></script>


<script type="text/javascript">
      var disqus_shortname = 'goto-fritz';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://gotofritz.net/blog/tutorials/getting-started-part-1';
        var disqus_url = 'http://gotofritz.net/blog/tutorials/getting-started-part-1';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-11254155-2']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



</body>
</html>
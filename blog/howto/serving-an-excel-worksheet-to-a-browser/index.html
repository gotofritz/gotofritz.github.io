
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Serving an Excel Worksheet to a browser - Fabrizio (Fritz) Stelluto</title>
	<meta name="author" content="">

	
	<meta name="description" content="Most backends have libraries to create spreadsheets. Here&#8217;s a quick and dirty method using HTML tables that works with any language. The &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Fabrizio (Fritz) Stelluto" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.ico" rel="shortcut icon">
	<link rel="icon" href="/favicon.gif" type="image/gif" />
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	
</head>


<body ontouchstart="">

  <header id="header" class="inner">
<nav id="main-nav"><div>
  <a class="rss" href="/atom.xml" title="RSS">RSS</a>
  <a href="/">home</a>
  <a href="/blog/">blog</a>
</div></nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><div>
  <a class="rss" href="/atom.xml" title="RSS">RSS</a>
  <a href="/">home</a>
  <a href="/blog/">blog</a>
</div></div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:gotofritz.net">
			</form>
		</div>
	</div>
</nav>

<nav id="sub-nav" class="alignright">
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:gotofritz.net">
	</form>
</nav>

</header>
	
		
	
	<div id="content" class="inner">
    
    <article class="post">
	<h1 class="title">Serving an Excel Worksheet to a Browser</h1>
	<div>
		<div class="meta">
			<div class="date">








  


<time datetime="2013-03-21T16:13:41+01:00" pubdate data-updated="true">2013-03-21, Thu</time></div>
			<div class="tags">


	<a class='category' href='/blog/cat/howto/'>HowTo</a>


</div>
			
				<span class="comments"><a href="/blog/howto/serving-an-excel-worksheet-to-a-browser#disqus_thread">Comments</a></span>
			
		</div>
		<div class="entry-content"><p>Most backends have libraries to create spreadsheets. Here&#8217;s a quick and dirty method using HTML tables that works with any language.</p>

<!--more-->


<p>The response type for generating Microsoft Excel worksheets on a server is &#8220;application/vnd.ms-excel&#8221;. After that, write a simple table (without HTML head), and Excel will convert it to a worksheet. MS Office is quite good at converting CSS and HTML 4 table attributes to Excel, but OpenOffice / LibreOffice is more limited â€“ css won&#8217;t work.</p>

<h2>Formatting XSL data as HTML tables</h2>

<p>From what I can see, this is what you can achieve on both using pure HTML</p>

<dl class="normal">
  <dt>turn borders on</dt>
  <dd>add the <tt>border</tt> attribute to the table tag. No need for a value, it&#8217;s an on/off switch. Or use <tt>border=&#8221;0&#8221;</tt> for no border and <tt>border=&#8221;1&#8221;</tt> for borders.</tt></dd>

  <dt>include a formula</dt>
  <dd>just write a formula normally, starting with the = sign</dd>

  <dt>center rows or column heads, and make them bold</dt>
  <dd>use TH tags instead of TD tags</dd>

  <dt>merge cells</dt>
  <dd>use the <tt>colspan</tt> and <tt>rowspan</tt> attributes of the <tt>td</tt> tag</dd>

  <dt>change background color</dt>
  <dd>use the <tt>bgcolor</tt> attribute on either <tt>tr</tt>, <tt>td</tt>, or <tt>table</tt> tags.</dd>

  <dt>change fonts</dt>
  <dd>use the <tt>font</tt> tag with the <tt>face</tt>, <tt>size</tt>, <tt>color</tt> attributes. Use the <tt>i</tt> and <tt>b</tt> tags for italic and bold.</dd>

</dl>


<h2>Sending an HTML table as a spreadsheet from the server</h2>

<p>Below is an example in PHP which shows all of the above.</p>

<div><script src='https://gist.github.com/5213235.js?file=spreadsheet.php'></script>
<noscript><pre><code>&lt;?php
header( &quot;Content-Type: application/vnd.ms-excel&quot; );
?&gt;
&lt;table border&gt;
&lt;tr height=&quot;80&quot; valign=&quot;top&quot;&gt;
&lt;th width=&quot;222&quot; &gt;Name&lt;/th&gt;
&lt;th&gt;Cost&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td BGCOLOR=&quot;#ffff00&quot;&gt;&lt;font color=&quot;red&quot; face=&quot;Courier&quot; size=&quot;6&quot;&gt;John&lt;/font&gt;&lt;/td&gt;
&lt;td&gt;&lt;i&gt;34&lt;/i&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr BGCOLOR=&quot;#00ff00&quot;&gt;
&lt;td ALIGN=&quot;right&quot;&gt;Marl&lt;/td&gt;
&lt;td&gt;122&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;TOTAL&lt;/th&gt;
&lt;td&gt;=SUM(B2:B3)&lt;/td&gt;
&lt;tr&gt;
&lt;td colspan=&quot;2&quot;&gt;use colspan to merge cells&lt;/td&gt;
&lt;/tr&gt;
&lt;/tr&gt;
&lt;/table&gt;</code></pre></noscript></div>


<p>You must be careful that if your filename ends with .php most browsers will refuse to open it as an Excel file. An easy workaround would be to save the file in a folder, say /test/index.php, and access it as /test/.</p>
</div>
	</div>
</article>

<article class="archives">
  <div class="related-posts">
    <h2>Related Posts</h2>
    
      <article>
        <h3 class="title"><a href="/blog/geekery/cannot-install-xcode-3-2-6-snow-leopard">Cannot install Xcode 3.2.6 on Snow Leopard</a></h3>
        <div class="meta">
          <span class="tags">


	<a class='category' href='/blog/cat/geekery/'>Geekery</a>


</span>
            
          <time datetime="2013-03-21T16:13:41+01:00" pubdate>2013-03-21</time>
            
        </div>
      </article>
    
      <article>
        <h3 class="title"><a href="/blog/geekery/link-specific-moment-youtube">Link directly to a specific moment in a YouTube video</a></h3>
        <div class="meta">
          <span class="tags">


	<a class='category' href='/blog/cat/geekery/'>Geekery</a>


</span>
            
          <time datetime="2013-03-21T16:13:41+01:00" pubdate>2013-03-21</time>
            
        </div>
      </article>
    
      <article>
        <h3 class="title"><a href="/blog/howto/automatically-create-chapters-idvd">Automatically creating chapters in iDVD</a></h3>
        <div class="meta">
          <span class="tags">


	<a class='category' href='/blog/cat/howto/'>HowTo</a>


</span>
            
          <time datetime="2013-03-21T16:13:41+01:00" pubdate>2013-03-21</time>
            
        </div>
      </article>
    
  </div>
</article>


<section id="comment">
    <h1 class="title">Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>

  </div>
	<footer id="footer" class="inner">Copyright &copy; 2015

    Fabrizio (Fritz) Stelluto

</footer>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script src="/javascripts/slash.js"></script>


<script type="text/javascript">
      var disqus_shortname = 'goto-fritz';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://gotofritz.net/blog/howto/serving-an-excel-worksheet-to-a-browser';
        var disqus_url = 'http://gotofritz.net/blog/howto/serving-an-excel-worksheet-to-a-browser';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-11254155-2']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



</body>
</html>
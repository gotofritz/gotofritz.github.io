<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <title>Serving an Excel Worksheet to a browser || Fritz Stelluto</title>
  <meta name="author" content="gotofritz">
  <meta name="description" content="Most backends have libraries to create spreadsheets. Here&amp;#39;s a quick and dirty method using HTML tables that works with any language.">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link href="/assets/favicon.ico" rel="shortcut icon">
  <link rel="icon" href="/assets/favicon.gif" type="image/gif" />
  <link href="/assets/css/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
</head>

<body ontouchstart="">
  <header id="header" class="inner">
    <nav id="main-nav">
      <div>
        <a href="/">home</a>
        <a href="/blog/">blog</a>
      </div>
    </nav>

    <nav id="sub-nav" class="alignright">
      <form class="search" action="http://google.com/search" method="get">
        <input class="alignright" type="text" name="q" results="0">
        <input type="hidden" name="q" value="site:gotofritz.net">
      </form>
    </nav>
  </header>


<div id="content" class="inner">
  <article class="post">
    <h1 class="title">Serving an Excel Worksheet to a browser</h1>
    <div>
      <div class="meta">
        <div class="date">
          <time datetime="2013-03-21T17:13:00+01:00" pubdate>2013-03-21</time>
        </div>
        <div class="tags">
          excel
        </div>
      </div>
      <div class="entry-content">
    
<p>Most backends have libraries to create spreadsheets. Here&#39;s a quick and dirty method using HTML tables that works with any language.
<!--more--></p>
<p>The response type for generating Microsoft Excel worksheets on a server is &quot;application/vnd.ms-excel&quot;. After that, write a simple table (without HTML head), and Excel will convert it to a worksheet. MS Office is quite good at converting CSS and HTML 4 table attributes to Excel, but OpenOffice / LibreOffice is more limited â€“ css won&#39;t work.</p>
<h2 id="formatting-xsl-data-as-html-tables">Formatting XSL data as HTML tables</h2>
<p>From what I can see, this is what you can achieve on both using pure HTML</p>
<dl class="normal">
  <dt>turn borders on</dt>
  <dd>add the <tt>border</tt> attribute to the table tag. No need for a value, it&#39;s an on/off switch. Or use <tt>border=&quot;0&quot;</tt> for no border and <tt>border=&quot;1&quot;</tt> for borders.</tt></dd>

  <dt>include a formula</dt>
  <dd>just write a formula normally, starting with the = sign</dd>

  <dt>center rows or column heads, and make them bold</dt>
  <dd>use TH tags instead of TD tags</dd>

  <dt>merge cells</dt>
  <dd>use the <tt>colspan</tt> and <tt>rowspan</tt> attributes of the <tt>td</tt> tag</dd>

  <dt>change background color</dt>
  <dd>use the <tt>bgcolor</tt> attribute on either <tt>tr</tt>, <tt>td</tt>, or <tt>table</tt> tags.</dd>

  <dt>change fonts</dt>
  <dd>use the <tt>font</tt> tag with the <tt>face</tt>, <tt>size</tt>, <tt>color</tt> attributes. Use the <tt>i</tt> and <tt>b</tt> tags for italic and bold.</dd>

</dl>


<h2 id="sending-an-html-table-as-a-spreadsheet-from-the-server">Sending an HTML table as a spreadsheet from the server</h2>
<p>Below is an example in PHP which shows all of the above.
{% gist 5213235 spreadsheet.php %}</p>
<p>You must be careful that if your filename ends with .php most browsers will refuse to open it as an Excel file. An easy workaround would be to save the file in a folder, say /test/index.php, and access it as /test/.</p>

      </div>
    </div>
  </article>


<!-- <section id="comment">
    <h1 class="title">Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>

  </div>
  -->
  <footer id="footer" class="inner">Copyright &copy; 2016

    Fritz Stelluto

</footer>
<!--
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>


<script type="text/javascript">
      var disqus_shortname = 'goto-fritz';


        // var disqus_developer = 1;
        var disqus_identifier = 'http://gotofritz.net/blog/geekery/backing-up-hard-disk-os-x/';
        var disqus_url = 'http://gotofritz.net/blog/geekery/backing-up-hard-disk-os-x/';
        var disqus_script = 'embed.js';

    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-11254155-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>

-->

</body>
</html>
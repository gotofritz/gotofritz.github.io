<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <title>Serving an Excel Worksheet to a browser || Fritz Stelluto</title>
  <meta name="author" content="gotofritz">
  <meta name="description" content="Most backends have libraries to create spreadsheets. Here’s a quick and dirty method using HTML tables that works with any language.">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link href="/assets/favicon.ico" rel="shortcut icon">
  <link rel="icon" href="/assets/favicon.gif" type="image/gif" />
  <link href="/assets/css/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
</head>

<body class="content-post"">
  <div class="gradient-container">
    <main class="panel-container">
      <div class="content">
        <nav class="topnav">
          <div itemscope itemtype="http://schema.org/Person" class="vcard group-of-links">
            <a href="/">home</a>
            <a href="/fritz-stelluto_resume.pdf" title="my CV as a PDF">search</a>
          </div>
        </nav>

<article>
  <section class="intro">
    <!--
      <div class="meta">
        <div class="date">
          <time datetime="2017-08-29T13:44:00+02:00" pubdate>2017-08-29</time>
        </div>
        <div class="tags">
          security,
          frontend
        </div>
      </div>
       -->
    <div class="post-meta">
      <time datetime="2013-03-21T17:13:00+01:00" pubdate>2013-03-21</time>
      //
      <div class="tags">
        excel
      </div>
    </div>
    <h1>Serving an Excel Worksheet to a browser</h1>
    <h2>Most backends have libraries to create spreadsheets. Here’s a quick and dirty method using HTML tables that works with any language.</h2>

  </section>
  <section class="post-content">
    The response type for generating Microsoft Excel worksheets on a server is “application/vnd.ms-excel”. After that, write a simple table (without HTML head), and Excel will convert it to a worksheet. MS Office is quite good at converting CSS and HTML 4 table attributes to Excel, but OpenOffice / LibreOffice is more limited – css won’t work.</p>
<h2 id="formatting-xsl-data-as-html-tables">Formatting XSL data as HTML tables</h2>
<p>From what I can see, this is what you can achieve on both using pure HTML</p>
<dl class="normal">
  <dt>turn borders on</dt>
  <dd>add the <tt>border</tt> attribute to the table tag. No need for a value, it's an on/off switch. Or use <tt>border="0"</tt> for no border and <tt>border="1"</tt> for borders.</tt></dd>

  <dt>include a formula</dt>
  <dd>just write a formula normally, starting with the = sign</dd>

  <dt>center rows or column heads, and make them bold</dt>
  <dd>use TH tags instead of TD tags</dd>

  <dt>merge cells</dt>
  <dd>use the <tt>colspan</tt> and <tt>rowspan</tt> attributes of the <tt>td</tt> tag</dd>

  <dt>change background color</dt>
  <dd>use the <tt>bgcolor</tt> attribute on either <tt>tr</tt>, <tt>td</tt>, or <tt>table</tt> tags.</dd>

  <dt>change fonts</dt>
  <dd>use the <tt>font</tt> tag with the <tt>face</tt>, <tt>size</tt>, <tt>color</tt> attributes. Use the <tt>i</tt> and <tt>b</tt> tags for italic and bold.</dd>

</dl>


<h2 id="sending-an-html-table-as-a-spreadsheet-from-the-server">Sending an HTML table as a spreadsheet from the server</h2>
<p>Below is an example in PHP which shows all of the above.<br>{% gist 5213235 spreadsheet.php %}</p>
<p>You must be careful that if your filename ends with .php most browsers will refuse to open it as an Excel file. An easy workaround would be to save the file in a folder, say /test/index.php, and access it as /test/.</p>
  </section>


    </div>
  </div>
</div>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-11254155-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</body>
</html>